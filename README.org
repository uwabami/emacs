#+title: Emacs ã®è¨­å®š
# -*- mode: org; coding: utf-8-unix; indent-tabs-mode: nil; lexical-binding: t -*-
#+startup: overview
#+date: 2019-01-30 18:22:35
* ã¯ã˜ã‚ã«
  ã“ã“ã§ã¯ï¼Œç§ã® Emacs ã®è¨­å®šã«ã¤ã„ã¦ã¾ã¨ã‚ã¦ã„ã¾ã™ï¼

  #+html: <amp-img src="https://travis-ci.org/uwabami/emacs.svg?branch=master" width="72px" height="20px" layout=fixed class="travis_badge"></amp-img>
  #+html: <amp-img src="https://img.shields.io/badge/License-GPLv3-blue.svg" width="92px" height="20px" layout="fixed"></amp-img>
  #+html: <a href="https://github.com/uwabami/emacs"><span class="icon-github"><svg id="SVGRoot" width="20px" height="20px" version="1.1" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="m5.4144 12.761c0 0.0645-0.0742 0.11613-0.16774 0.11613-0.10645 0.01-0.18064-0.0419-0.18064-0.11613 0-0.0645 0.0742-0.11613 0.16774-0.11613 0.0968-0.01 0.18064 0.0419 0.18064 0.11613zm-1.0032-0.14516c-0.0226 0.0645 0.0419 0.13871 0.13871 0.15806 0.0839 0.0323 0.18064 0 0.2-0.0645 0.0194-0.0645-0.0419-0.13871-0.13871-0.16775-0.0839-0.0226-0.17742 0.01-0.2 0.0742zm1.4258-0.0548c-0.0935 0.0226-0.15806 0.0839-0.14838 0.15806 0.01 0.0645 0.0935 0.10645 0.19032 0.0839 0.0936-0.0226 0.15806-0.0839 0.14839-0.14838-0.01-0.0613-0.0968-0.10323-0.19033-0.0935zm2.1226-12.361c-4.4742 0-7.8968 3.3968-7.8968 7.871 0 3.5774 2.2516 6.6387 5.4677 7.7161 0.41291 0.0742 0.55807-0.18064 0.55807-0.39032 0-0.2-0.01-1.3032-0.01-1.9806 0 0-2.2581 0.48387-2.7323-0.96129 0 0-0.36774-0.93871-0.89677-1.1806 0 0-0.73871-0.50645 0.0516-0.49677 0 0 0.80323 0.0645 1.2452 0.83226 0.70645 1.2452 1.8903 0.88709 2.3516 0.67419 0.0742-0.51613 0.28387-0.87419 0.51613-1.0871-1.8032-0.2-3.6226-0.46129-3.6226-3.5645 0-0.8871 0.24516-1.3323 0.76129-1.9-0.0839-0.20968-0.35806-1.0742 0.0839-2.1903 0.6742-0.20967 2.2258 0.87097 2.2258 0.87097 0.64516-0.18064 1.3387-0.27419 2.0258-0.27419 0.68709 0 1.3806 0.0936 2.0258 0.27419 0 0 1.5516-1.0839 2.2258-0.87097 0.44193 1.1194 0.16774 1.9806 0.0839 2.1903 0.51613 0.57096 0.83226 1.0161 0.83226 1.9 0 3.1129-1.9 3.3613-3.7032 3.5645 0.29678 0.25484 0.54839 0.73871 0.54839 1.4968 0 1.0871-0.01 2.4322-0.01 2.6968 0 0.20968 0.14839 0.46452 0.55807 0.39032 3.2258-1.071 5.4129-4.1322 5.4129-7.7097 0-4.4742-3.629-7.871-8.1032-7.871zm-4.7613 11.126c-0.0419 0.0323-0.0323 0.10646 0.0226 0.16775 0.0516 0.0516 0.12581 0.0742 0.16775 0.0323 0.0419-0.0323 0.0323-0.10645-0.0226-0.16774-0.0516-0.0516-0.12581-0.0742-0.16775-0.0323zm-0.34838-0.26129c-0.0226 0.0419 0.01 0.0935 0.0742 0.12581 0.0516 0.0323 0.11613 0.0226 0.13871-0.0226 0.0226-0.0419-0.01-0.0935-0.0742-0.12581-0.0645-0.0194-0.11613-0.01-0.13871 0.0226zm1.0452 1.1484c-0.0516 0.0419-0.0323 0.13871 0.0419 0.2 0.0742 0.0742 0.16775 0.0839 0.20968 0.0323 0.0419-0.0419 0.0226-0.13871-0.0419-0.2-0.071-0.0742-0.16775-0.0839-0.20968-0.0323zm-0.36774-0.47419c-0.0516 0.0323-0.0516 0.11613 0 0.19032 0.0516 0.0742 0.13871 0.10645 0.18064 0.0742 0.0516-0.0419 0.0516-0.1258 0-0.2-0.0452-0.0742-0.12903-0.10645-0.18064-0.0645z" fill="currentColor" stroke-width=".032258"/></svg></span></a>

  åŸºæœ¬æ–¹é‡ã¯ä»¥ä¸‹ã®é€šã‚Š:
** Debian ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ãªã‚‰ã°ï¼Œãã‚Œã‚’å„ªå…ˆã™ã‚‹
   :[[https://en.wikipedia.org/wiki/Eating_your_own_dog_food][Eating your own dog food - Wikipedia]]

   Emacsã«é–¢é€£ã™ã‚‹Debianãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’å¹¾ã¤ã‹ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã—ã¦ã„ã‚‹ã®ã§ï¼Œ
   å¯èƒ½ãªé™ã‚ŠDebianãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ã†ã“ã¨ã«ã—ã¦ã„ã¾ã™.
** Emacs ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸(=package.el=)ã¨ [[https://github.com/quelpa/quelpa][quelpa]], [[https://github.com/jwiegley/use-package][use-package]] ã‚’ä½¿ã†
   åŸºæœ¬ã¯ =package.el= ã‚’ä½¿ã„ã¾ã™ãŒã€
   VCS ã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸã„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒå¹¾ã¤ã‹ã‚ã‚‹ã®ã§ã€
   ãã‚Œã‚‰ã«ã¤ã„ã¦ã¯ [[https://github.com/quelpa/quelpa][quelpa]] + [[https://framagit.org/steckerhalter/quelpa-use-package][quelpa-use-package]] ã‚’ä½¿ã„ã¾ã™ã€‚
** è¨­å®šã¯ [[http://orgmode.org/][Org mode]] ã§æ›¸ããŸã„
   ä»¥å‰ã“ã‚“ãªãƒ–ãƒ­ã‚°è¨˜äº‹ã‚’æ›¸ãã¾ã—ãŸ: [[http://uwabami.junkhub.org/log/20111213.html#p01][Emacsã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’orgã§æ›¸ã]]

   ã¨ã„ã†ã‚ã‘ã§ï¼Œè¨­å®šã¯ [[http://orgmode.org/worg/org-contrib/babel/intro.html][Org Babel]] ã§æ›¸ã„ã¦ã„ã¾ã™ï¼
   æœ¬ãƒ•ã‚¡ã‚¤ãƒ«(=README.org=) ã‹ã‚‰ï¼Œ
   Makefile å†…ã®ä»¥ä¸‹ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ =~/init.el= ã‚’ç”Ÿæˆã—ï¼Œbyte-compile ã—ã¾ã™ï¼
   #+begin_src makefile-gmake :tangle no
init.el: README.org
$(EMACS) -q --batch --eval \
"(progn \
(require 'ob-tangle) \
(org-babel-tangle-file \"$<\" \"$@\" \"emacs-lisp\"))"
%.elc: %.el
$(EMACS) -l $< -batch -f batch-byte-compile $<
   #+end_src
* ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ
  åˆ†å‰²ã—ãŸè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ç¾¤ã‚„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ install ã—ãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
  ã®ç½®ãå ´æ‰€ã¯ =user-emacs-directory= ä»¥ä¸‹ã«ã¾ã¨ã‚ã¦ã„ã¾ã™ï¼

  è©¦è¡ŒéŒ¯èª¤ã®çµæœï¼Œãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ã—ã¾ã—ãŸ:
  #+begin_example
    ~/.emacs.d/
     |-- Makefile    â†  byte-compile ç”¨ã® rule
     |-- README.org  â†  æœ¬ãƒ•ã‚¡ã‚¤ãƒ«ï¼`org-babel-tangle' ã§ init.el ã‚’ç”Ÿæˆ
     |-- pkg/
         |-- elpa/   â†  package.el ã§å°å…¥ã—ãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒç½®ã‹ã‚Œã‚‹å ´æ‰€
         `-- quelpa/ â†  quelpa ã§å°å…¥ã—ãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒç½®ã‹ã‚Œã‚‹å ´æ‰€
     |-- share/      â†  (åŸºæœ¬çš„ã«)å‚ç…§ã™ã‚‹ã ã‘ã®è³‡æºç½®ãå ´æ‰€
     `-- tmp/        â†  ä¸€æ¬¡ãƒ•ã‚¡ã‚¤ãƒ«ã®ç½®ãå ´æ‰€
  #+end_example
  ä¸Šè¨˜ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆã‚’è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã§ä½¿ç”¨ã™ã‚‹ãŸã‚ã«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªé…ç½®ã‚’å®£è¨€ã—ã¦ãŠãã¾ã™ï¼
  #+begin_src emacs-lisp
(when load-file-name
  (setq user-emacs-directory (file-name-directory load-file-name)))
(defconst my:d:share
  (expand-file-name "share/" user-emacs-directory))
(defconst my:d:tmp
  (expand-file-name "tmp/" user-emacs-directory))
  #+end_src
  ã¤ã„ã§ã«ï¼Œ
  =custom-set-variables= ã¯åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ã«å‡ºåŠ›ï¼Œçµ‚äº†æ™‚ã«å‰Šé™¤ã™ã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ï¼
  #+begin_src emacs-lisp
(setq custom-file (concat my:d:tmp "custom.el"))
(add-hook 'kill-emacs-hook
          (lambda ()
            (if (file-exists-p custom-file)
                (delete-file custom-file))))
  #+end_src
  +init.elãŒæ±šã‚Œã‚‹æ°—ãŒã—ã¦ã‚ã¾ã‚Šå¥½ãã§ã¯ãªã„ã®ã§ã™ãŒ...çš†ã•ã‚“æ°—ã«ã—ã¦ãªã„ã‚“ã§ã™ã‹ã­+
* Package é–¢é€£: =package.el=, [[https://github.com/jwiegley/use-package][use-package]], [[https://github.com/quelpa/quelpa][quelpa]]
  [[https://github.com/jwiegley/use-package][use-package]] ã®ãŠã‹ã‘ã§ã€
  ç„¡ã„ã¨é€”æ–¹ã«æš®ã‚Œã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ä»¥å¤–ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¯ç„¡è¦–ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚
** =package.el=
   ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯åŸºæœ¬çš„ã« =pacakge.el= ã§å°å…¥ã™ã‚‹ã®ã§ã€å…ˆãšã¯ãã®è¨­å®š.
   #+begin_src emacs-lisp
(setq url-http-attempt-keepalives nil)
(require 'package nil 'noerror)
(setq package-enable-at-startup t
      package-user-dir (expand-file-name "pkg/elpa" user-emacs-directory)
      package-gnupghome-dir (expand-file-name ".gnupg" (getenv "HOME")))
(add-to-list 'package-archives '("melpa" . "https://melpa.org/packages/") t)
(eval-when-compile
  (unless (file-exists-p (locate-user-emacs-file "tmp/bootstrap-stamp"))
    (package-refresh-contents)
    (with-temp-buffer (write-file (locate-user-emacs-file "tmp/bootstrap-stamp")))
    ))
(package-initialize)
   #+end_src
** [[https://github.com/jwiegley/use-package][use-package]]
   å€‹ã€…ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®è¨­å®šã«ã¯ [[https://github.com/jwiegley/use-package][use-package]] ã‚’åˆ©ç”¨ã—ã¾ã™ï¼
   #+begin_src emacs-lisp
(unless (require 'use-package nil t)
  (package-install 'use-package))
(setq use-package-always-ensure nil)
(use-package package-utils :ensure t)
   #+end_src
   ãƒ¢ãƒ¼ãƒ‰ãƒ©ã‚¤ãƒ³ã®è¨­å®šç”¨ã« delight, diminish ã‚‚å…¥ã‚Œã¦ãŠã
   #+BEGIN_SRC emacs-lisp
(use-package delight :ensure t)
(use-package diminish
  :ensure t
  :config
  (defmacro my:diminish (file mode &optional new-name)
    "æŒ‡å®šã•ã‚ŒãŸ minor mode ã®è¡¨ç¤ºã‚’å¤‰ãˆã‚‹"
    `(with-eval-after-load ,file
       (diminish ,mode ,new-name)))
  )
   #+END_SRC
** [[https://framagit.org/steckerhalter/quelpa-use-package][quelpa-use-package]]
   melpa ã«ç™»éŒ²ã•ã‚Œã¦ã„ãªã„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚„è‡ªä½œã® elisp ç­‰ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã‚‹æ§˜ã«
   [[https://github.com/quelpa/quelpa][quelpa]] ã‚’ä½¿ã„ã¾ã™. ã“ã‚Œã¨ [[https://github.com/jwiegley/use-package][use-package]] ã‚’é€£æºã™ã‚‹ [[https://framagit.org/steckerhalter/quelpa-use-package][quelpa-use-package]] ã‚’
   melpa ã‹ã‚‰å°å…¥ã—ã¦ãŠãã¾ã™.
   ã¨ã¯ã„ãˆã€[[https://github.com/quelpa/quelpa][quelpa]] ã¯ã‚ãã¾ã§ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã™ã‚“ã§,
   melpa ã®åŒæœŸã¯ã—ã¾ã›ã‚“.
   #+begin_src emacs-lisp
(use-package quelpa-use-package
  :ensure t
  :init
  (setq quelpa-dir (expand-file-name "pkg/quelpa" user-emacs-directory)
        quelpa-upgrade-p nil
        quelpa-checkout-melpa-p nil
        quelpa-update-melpa-p nil
        quelpa-melpa-recipe-stores nil)
  )
   #+end_src
* èµ·å‹•æ™‚é–“ã®è¨ˆæ¸¬: =esup=
  #+BEGIN_SRC emacs-lisp
(use-package esup :ensure t)
  #+END_SRC
* ç‹¬è‡ªé–¢æ•°
  ç´°ã‹ã„ç‹¬è‡ªé–¢æ•°ï¼Œãªã©ï¼
** ã‚«ãƒ¼ã‚½ãƒ«ã®ã‚ã‚‹ä½ç½®ã® face ã‚’èª¿ã¹ã‚‹é–¢æ•°
   ã‚ã‚Šã¨è‰¯ãä½¿ã†. åœ°å‘³ã«ä¾¿åˆ©
   #+begin_src emacs-lisp
(defun my:describe-face-at-point ()
  (interactive)
  (message "%s" (get-char-property (point) 'face)))
   #+end_src
** æ©Ÿèƒ½ã‚’ç„¡åŠ¹åŒ–ã™ã‚‹ãŸã‚ã®é–¢æ•°ã®å®šç¾©
   =line-number-mode= ãªã©ã€Œæœ‰åŠ¹ç„¡åŠ¹ã‚’toggleã™ã‚‹é–¢æ•°ã€ã¯
   æ…£ç¿’çš„ã« =0= ä»¥ä¸‹ã®æ•°å­—ã‚’æŒ‡å®šã™ã‚‹ã¨æ˜ç¤ºçš„ã«ç„¡åŠ¹åŒ–ã§ãã‚‹ã®ã§ï¼Œ
   =-1= ã‚’è¨­å®šã™ã‚‹é–¢æ•°ã‚’å®šç¾©ã—ã¦ãŠã.
   #+begin_src emacs-lisp
(defun my:disable-builtin-mode (mode)
  "ä¸ãˆã‚‰ã‚ŒãŸ mode ãŒå­˜åœ¨ã™ã‚‹ã®ã§ã‚ã‚Œã° -1 ã‚’ã‚»ãƒƒãƒˆã—ã¦ç„¡åŠ¹åŒ–"
  (if (fboundp mode) (funcall mode -1)))
   #+end_src
** dpkg-status
   ã‚‚ã£ã¨è‰¯ã„æ–¹æ³•ãŒã‚ã‚Šãã†ãªãƒ¢ãƒ³ã§ã™ãŒï¼
   #+begin_src emacs-lisp
(defun my:dpkg-status (package)
  "Return the package status from dpkg --get-selections."
  (string-match "^ii" (shell-command-to-string (format "dpkg -l %s" package))))
   #+end_src
** è¡Œæœ«ã®ç„¡é§„ãªç©ºç™½/æ”¹è¡Œã‚’å‰Šé™¤ã™ã‚‹
   @see [[http://d.hatena.ne.jp/tototoshi/20101202/1291289625][ç„¡é§„ãªè¡Œæœ«ã®ç©ºç™½ã‚’å‰Šé™¤ã™ã‚‹(Emacs Advent Calendar jp:2010)]]

   ãŸã ã—, RD ã‚„ Markdown ã ã¨ç©ºç™½è¡Œã«æ„å‘³ãŒã‚ã£ãŸã‚Šã™ã‚‹ã®ã§ï¼Œ
   å¿…è¦ã«å¿œã˜ã¦æ‹¡å¼µå­ã§åˆ¤æ–­ã—ã¦å¤–ã—ã¦ã„ã‚‹ï¼
   #+begin_src emacs-lisp
(defvar my:delete-trailing-whitespace-exclude-suffix
  (list "\\.rd$" "\\.md$" "\\.rbt$" "\\.rab$"))
(defun my:delete-trailing-whitespace ()
  (interactive)
  (cond
   ((equal nil
           (cl-loop for pattern in my:delete-trailing-whitespace-exclude-suffix
                    thereis (string-match pattern buffer-file-name)))
    (delete-trailing-whitespace))))
(add-hook 'before-save-hook 'my:delete-trailing-whitespace)
   #+end_src
** ç©ºã«ãªã£ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’å°‹ã­ãšã«è‡ªå‹•å‰Šé™¤
   ã‚´ãƒŸãŒæ®‹ã‚‰ãªã„ã—ï¼Œåœ°å‘³ã«ä¾¿åˆ©ï¼
   #+begin_src emacs-lisp
(defun my:delete-file-if-no-contents ()
  (when (and (buffer-file-name (current-buffer))
             (= (point-min) (point-max)))
    (delete-file
     (buffer-file-name (current-buffer)))))
(if (not (memq 'my:delete-file-if-no-contents after-save-hook))
    (setq after-save-hook
          (cons 'my:delete-file-if-no-contents after-save-hook)))
   #+end_src
** scratch ã‚’æ®ºã•ãªã„. æ¶ˆã—ãŸã‚‰å†ç”Ÿæˆ
   ...å…ƒãƒã‚¿ãŒã©ã“ã ã£ãŸã®ã‹å¿˜ã‚Œã¦ã—ã¾ã£ãŸ...
   #+begin_src emacs-lisp
(defun my:make-scratch (&optional arg)
  (interactive)
  (progn
    ;; "*scratch*" ã‚’ä½œæˆã—ã¦ buffer-list ã«æ”¾ã‚Šè¾¼ã‚€
    (set-buffer (get-buffer-create "*scratch*"))
    (funcall initial-major-mode)
    (erase-buffer)
    (when (and initial-scratch-message (not inhibit-startup-message))
      (insert initial-scratch-message))
    (or arg
        (progn
          (setq arg 0)
          (switch-to-buffer "*scratch*")))
    (cond ((= arg 0) (message "*scratch* is cleared up."))
          ((= arg 1) (message "another *scratch* is created")))))

(defun my:buffer-name-list ()
  (mapcar (function buffer-name) (buffer-list)))
(add-hook 'kill-buffer-query-functions
          ;; *scratch* ãƒãƒƒãƒ•ã‚¡ã§ kill-buffer ã—ãŸã‚‰å†…å®¹ã‚’æ¶ˆå»ã™ã‚‹ã ã‘ã«ã™ã‚‹
          (function (lambda ()
                      (if (string= "*scratch*" (buffer-name))
                          (progn (my:make-scratch 0) nil)
                        t))))
(add-hook 'after-save-hook
          ;; *scratch* ãƒãƒƒãƒ•ã‚¡ã®å†…å®¹ã‚’ä¿å­˜ã—ãŸã‚‰
          ;; *scratch* ãƒãƒƒãƒ•ã‚¡ã‚’æ–°ã—ãä½œã‚‹.
          (function
           (lambda ()
             (unless (member "*scratch*" (my:buffer-name-list))
               (my:make-scratch 1)))))
   #+end_src
** ãƒ•ã‚¡ã‚¤ãƒ«åã‚’ minibuffer ã«ãŠã•ã¾ã‚‹æ§˜ã«æ•´å½¢
   zsh é¢¨å‘³
   #+begin_src emacs-lisp
(defun my:shorten-file-path (fpath max-length)
  "Show up to `max-length' characters of a directory name `fpath' like zsh"
  (let* ((path (reverse (split-string (abbreviate-file-name fpath) "/")))
         (output "")
         (top (mapconcat 'identity (reverse (last path 3)) "/"))
         (vmax (- max-length 4 (length top)))
         (path (butlast path 3))
         )
    (while (and path
                (and (< (length output) vmax)
                     (< (length (concat "/" (car path) output)) vmax)))
      (setq output (concat "/" (car path) output))
      (setq path (cdr path)))
    ;; çœç•¥
    (when path
      (setq output (concat "/..." output)))
    (format "%s%s" top output)
    ))
   #+end_src
* ç’°å¢ƒå¤‰æ•°ã®èª­ã¿è¾¼ã¿: =exec-path-from-shell=
  zsh ã§è¨­å®šã—ãŸ =PATH= ãªã©ã®ç’°å¢ƒå¤‰æ•°ã‚’ Emacs ã«å¼•ãç¶™ããŸã‚ã«
  [[https://github.com/purcell/exec-path-from-shell][purcell/exec-path-from-shell]] ã‚’ä½¿ã„ã¾ã™ï¼
  ä»Šã®æ‰€
  - =SHELL=
  - =DEBFULLNAME=
  - =DEBEMAIL=
  - =TEXMFHOME=
  - =SKKSERVER=
  - =http_proxy=
  - =GPG_KEY_ID=
  - =GPG_AGENT_INFO=
  - =PASSWORD_STORE_DIR=
  - =PATH=
  ã‚’èª­ã¿è¾¼ã‚“ã§ã„ã¾ã™ï¼
  #+begin_src emacs-lisp
(defvar my:d:password-store nil)
(use-package exec-path-from-shell
  :ensure t
  :config
  (when (memq window-system '(mac ns)) (exec-path-from-shell-initialize))
  (exec-path-from-shell-copy-envs
   '("SHELL"
     "DEBFULLNAME"
     "DEBEMAIL"
     "SKKSERVER"
     "TEXMFHOME"
     "http_proxy"
     "GPG_KEY_ID"
     "GPG_AGENT_INFO"
     "PASSWORD_STORE_DIR"
     "PATH"
     ))
  (setq user-full-name (concat (getenv "DEBFULLNAME"))
        user-mail-address (concat (getenv "DEBEMAIL"))
        my:d:password-store (concat (getenv "PASSWORD_STORE_DIR") "/Emacs/" (system-name)))
  )
  #+end_src
* è¨€èªã®è¨­å®š
  æ—¥æœ¬èª, UTF-8 ã«ã—ã¦ã„ã¾ã™.
  #+begin_src emacs-lisp
;; (set-language-environment "Japanese")
(set-language-environment 'utf-8)
(prefer-coding-system 'utf-8)
(set-file-name-coding-system 'utf-8)
(set-keyboard-coding-system 'utf-8)
(set-terminal-coding-system 'utf-8)
(set-default 'buffer-file-coding-system 'utf-8)
  #+end_src
  ãã®ä»–, æ©Ÿç¨®ä¾å­˜æ–‡å­—ç­‰ã«ã¤ã„ã¦ã®è¨­å®šã‚’ã‚¢ãƒ¬ã‚³ãƒ¬.
** cp5022x.el
   Emacs23 ã‹ã‚‰å†…éƒ¨ãŒ Unicode ãƒ™ãƒ¼ã‚¹ã«ãªã£ã¦ã„ã¾ã™ï¼

   ã—ã‹ã—æ–‡å­—ã‚³ãƒ¼ãƒ‰ã®å¤‰æ›ã¯ GNU libc ã® iconv ã‚’ãƒ™ãƒ¼ã‚¹ã«ã—ã¦ã„ã‚‹ãŸã‚ï¼Œ
   ç’°å¢ƒã«ã‚ˆã£ã¦ã¯æ–‡å­—ã®å¤‰æ›ãŒã†ã¾ãè¡Œãªãˆã¾ã›ã‚“ï¼
   ãã“ã§è¨€èªè¨­å®šå‰ã« =cp5022x.el= ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã“ã¨ã«ã—ã¦ã„ã¾ã™ï¼
   #+begin_src emacs-lisp
(use-package cp5022x
  :ensure t
  :config
  (set-charset-priority 'ascii 'japanese-jisx0208 'latin-jisx0201
                        'katakana-jisx0201 'iso-8859-1 'unicode)
  (set-coding-system-priority 'utf-8 'euc-jp 'iso-2022-jp 'cp932)
  )
   #+end_src
** East Asian Ambiguos å¯¾å¿œ
   CJK ä»¥å¤–ã® East Asian Ambiguosï¼Œçµµæ–‡å­—ã‚‚2æ–‡å­—å¹…ã«ã™ã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ï¼
   æ‹™ä½œã®ä¿®æ­£ãƒ­ã‚±ãƒ¼ãƒ«ã¯ã“ã¡ã‚‰: [[https://github.com/uwabami/locale-eaw-emoji]]
   #+begin_src emacs-lisp
(use-package locale-eaw-emoji
  :quelpa (locale-eaw-emoji
           :fetcher github
           :repo "uwabami/locale-eaw-emoji")
  :config
  (eaw-and-emoji-fullwidth))
   #+end_src
** OSã®é•ã„ã«èµ·å› ã™ã‚‹æ¡ä»¶åˆ†å²
   Mac ã¨ Linux ã§ã¯åŒã˜ Unicode ã§ã‚‚æ­£è¦åŒ–ãŒç•°ãªã‚Šã¾ã™
   (å…·ä½“çš„ã«ã¯ Mac ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã§ã‚ã‚‹ HFS+ ã§ã¯ Unicode ã®æ­£è¦åŒ–ãŒç•°ãªã‚Šã¾ã™).
   Unicode ã®æ­£è¦åŒ–ã¨ Mac OS X ç‰¹æœ‰ã®äº‹æƒ…ã«ã¤ã„ã¦ã¯
   - [[http://homepage1.nifty.com/nomenclator/unicode/normalization.htm][Unicodeæ­£è¦åŒ–ã¨ã¯]]
   - [[http://www.sakito.com/2010/05/mac-os-x-normalization.html][Mac OS X ã«ãŠã‘ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«åã«é–¢ã™ã‚‹ãƒ¡ãƒ¢(NFC, NFDç­‰)]]
   ç­‰ãŒå‚è€ƒã«ãªã‚‹ã§ã—ã‚‡ã†.

   æ—¥æœ¬èªã®ãƒ•ã‚¡ã‚¤ãƒ«åã‚’æ‰±ã†ã“ã¨ã¯æ»…å¤šã«ãªã„ã‚‚ã®ã®,
   ãŸã¾ã«ç¥Ÿã‚ŠãŒã‚ã‚‹ã®ã§ãã‚Œã‚’å›é¿ã™ã‚‹ãŸã‚ã®è¨­å®šã‚’ã—ã¦ã„ã¾ã™.

   Windows ã®å ´åˆã¯ãƒ•ã‚¡ã‚¤ãƒ«åãªã©ã¯ cp932 ã«ã—ã¦ã„ã‚‹ã‚‚ã®ã®,
   æœ€è¿‘ Windows ä½¿ã£ã¦ã„ãªã„ã®ã§è‰¯ãçŸ¥ã‚Šã¾ã›ã‚“(ã¨ã„ã†ã‚ã‘ã§ï¼Œè¨­å®šã‚’æ¨ã¦ã¾ã—ãŸ).
   +ã•ã‚‰ã«ï¼Œæœ€è¿‘ã¯ Mac OS ã§ã‚‚ Emacs ä½¿ã£ã¦ãªã„ã‹ã‚‰ï¼Œã“ã‚ŒãŒæ­£ã—ã®ã‹è‰¯ãã‚ã‹ã‚‰ãªã„...+
   #+begin_src emacs-lisp
(use-package ucs-normalize
  :if (eq system-type 'darwin)
  :config
  (set-file-name-coding-system 'utf-8-hfs)
  (setq locale-coding-system 'utf-8-hfs)
  ;; ã¤ã„ã§ã«ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒ‰: Ctrl ã‚’ Mac ã‹ã‚‰å¥ªã„å–ã‚‹
  (setq mac-pass-control-to-system t)
  ;; Cmd ã¨ Option ã‚’é€†ã«ã™ã‚‹
  (setq ns-command-modifier 'meta)
  (setq ns-alternate-modifier 'super)
  (global-set-key [ns-drag-file] 'ns-find-file)
  )
   #+end_src
* ä¸»ã«Emacsæœ¬ä½“ã«åŒæ¢±ã•ã‚Œã¦ã„ã‚‹æ‹¡å¼µã«é–¢ã™ã‚‹è¨­å®š
  æœ€è¿‘ã¼ã¡ã¼ã¡ä»–ã®æ‹¡å¼µã‚‚å…¥ã‚Œã‚‹æ§˜ã«ãªã£ã¦ããŸ.
** æ¨™æº–æ©Ÿèƒ½ã®è¨­å®š
*** è¡¨ç¤ºé–¢é€£
    èµ·å‹•æ™‚ã®ã‚¹ãƒ—ãƒ©ãƒƒã‚·ãƒ¥ç”»é¢ã‚’è¡¨ç¤ºã—ãªã„
    #+begin_src emacs-lisp
(setq inhibit-startup-screen t
      inhibit-startup-message t)
    #+end_src
    å¤§æŠµã®å ´åˆã‚¿ãƒ¼ãƒŸãƒŠãƒ«å†…ã§ =-nw= ã¨ã—ã¦èµ·å‹•ã™ã‚‹ã—,
    ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã¯è§¦ã£ãŸã“ã¨ãªã„ã®ã§ä½¿ã‚ãªã„ã®ã§ï¼Œ
    ãƒ•ãƒ¬ãƒ¼ãƒ , ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ç­‰ã‚’éè¡¨ç¤ºã«ã™ã‚‹ï¼
    #+begin_src emacs-lisp
(my:disable-builtin-mode 'tool-bar-mode)
(my:disable-builtin-mode 'scroll-bar-mode)
(my:disable-builtin-mode 'menu-bar-mode)
(my:disable-builtin-mode 'blink-cursor-mode)
(my:disable-builtin-mode 'column-number-mode)
    #+end_src
    ãƒ™ãƒ«ç„¡åŠ¹åŒ–
    #+begin_src emacs-lisp
(setq ring-bell-function 'ignore)
    #+end_src
    ç¾åœ¨è¡Œã®ãƒã‚¤ãƒ©ã‚¤ãƒˆ
    #+begin_src emacs-lisp
(global-hl-line-mode t)
    #+end_src
    é¸æŠãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã«è‰²ä»˜ã‘
    #+begin_src emacs-lisp
(setq transient-mark-mode t)
    #+end_src
    å¯¾å¿œã™ã‚‹æ‹¬å¼§ã‚’å¼·èª¿è¡¨ç¤º
    #+begin_src emacs-lisp
(show-paren-mode +1)
(setq show-paren-style 'mixed)
    #+end_src
    è¡Œç•ªå·ã‚’è¡¨ç¤ºã™ã‚‹ =linum-mode= ã¯åŸºæœ¬ä½¿ã‚ãªã„(å¿…è¦ã«å¿œã˜ã¦æœ‰åŠ¹ã«ã™ã‚‹)
    ã®ã§é€šå¸¸ã¯ãƒ¢ãƒ¼ãƒ‰ãƒ©ã‚¤ãƒ³ã«è¡Œç•ªå·ã‚„æ¡ç•ªå·ã‚’è¡¨ç¤ºã—ãªã„ã‚ˆã†ã™ã‚‹.
    ã¤ã„ã§ã« =linum-mode= ã‚’æœ‰åŠ¹ã«ã—ãŸå ´åˆã®æ¡è¡¨ç¤ºã‚’ 5 æ¡ã«.
    #+begin_src emacs-lisp
(my:disable-builtin-mode 'line-number-mode)
(setq linum-format "%5d ")
    #+end_src
    debug ã¯è¡¨ç¤ºã—ãªã„: å¿…è¦ã«å¿œã˜ã¦ t ã«å¤‰æ›´ã™ã‚‹
    #+begin_src emacs-lisp
(setq debug-on-error nil)
    #+end_src
    Compile-Log ã®éè¡¨ç¤º:     ã»ã¨ã‚“ã©è¦‹ãªã„ã—ï¼
    #+begin_src emacs-lisp
(let ((win (get-buffer-window "*Compile-Log*")))
  (when win (delete-window win)))
    #+end_src
    Warning ã®æŠ‘åˆ¶: ã“ã‚Œã‚‚ã»ã¨ã‚“ã©è¦‹ãªã„ã—ï¼
    #+begin_src emacs-lisp
(setq byte-compile-warnings
      '(not
        free-vars
        unresolved
        callargs
        redefine
        ;;        obsolete
        noruntime
        cl-functions
        interactive-only
        make-local
        ))
    #+end_src
*** ç·¨é›†é–¢é€£
    yes or no ã‚’ y or n ã«
    #+begin_src emacs-lisp
(fset 'yes-or-no-p 'y-or-n-p)
    #+end_src
    ãƒ•ã‚¡ã‚¤ãƒ«åã®å¤§æ–‡å­—å°æ–‡å­—ã‚’åŒºåˆ¥ã—ãªã„(zshé¢¨)
    #+begin_src emacs-lisp
(setq read-file-name-completion-ignore-case t)
    #+end_src
    tab å¹… 4, tab ã§ã®ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã¯ã—ãªã„
    #+begin_src emacs-lisp
(setq-default tab-width 4)
(setq-default indent-tabs-mode nil)
    #+end_src
    æ–‡å­—åˆ—ã¯ 72 æ–‡å­—ã§æŠ˜ã‚Šè¿”ã—(RFC2822é¢¨å‘³)
    #+begin_src emacs-lisp
(setq-default fill-column 72)
(setq paragraph-start '"^\\([ ã€€ãƒ»â—‹<\t\n\f]\\|(?[0-9a-zA-Z]+)\\)")
(setq-default auto-fill-mode nil)
    #+end_src
    é•·ã„è¡Œã®æŠ˜ã‚Šè¿”ã—:
    ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯æŠ˜ã‚Šè¿”ã—æœ‰ã§ =\C-c M-l= ã§ toggle
    #+begin_src emacs-lisp
(set-default 'truncate-lines nil)
(setq truncate-partial-width-windows nil)
(define-key global-map (kbd "C-c M-l") 'toggle-truncate-lines)
    #+end_src
    ãƒãƒƒãƒ•ã‚¡çµ‚ç«¯ã§ newline ã‚’å…¥ã‚Œãªã„
    #+begin_src emacs-lisp
(setq next-line-add-newlines nil)
    #+end_src
    å¤‰æ›´ã®ã‚ã£ãŸãƒ•ã‚¡ã‚¤ãƒ«ã®è‡ªå‹•å†èª­ã¿è¾¼ã¿
    #+begin_src emacs-lisp
(global-auto-revert-mode 1)
    #+end_src
    ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¨auto-saveã®ä½œæˆ/ä½ç½®ã®å¤‰æ›´:
    #+begin_src emacs-lisp
(setq auto-save-list-file-prefix (concat my:d:tmp ".saves-")
      auto-save-default t
      auto-save-timeout 15
      auto-save-interval 60
      make-backup-files t
      backup-by-copying t ; symlink ã¯ä½¿ã‚ãªã„
      backup-directory-alist `(("." . ,my:d:tmp))
      auto-save-file-name-transforms `((".*" ,my:d:tmp t))
      version-control t
      kept-new-versions 5
      kept-old-versions 5
      delete-old-versions t
      delete-auto-save-files t
      )
    #+end_src
    Undo/Redo:
    =undo-limit= ã¯ç„¡é™å¤§ã«ã—ãŸã„ã®ã§ã™ãŒï¼Œã©ã†ã™ã‚‹ã®ã‹ãª...?
    #+begin_src emacs-lisp
(setq undo-limit 200000
      undo-strong-limit 260000)
(savehist-mode 1)
(setq history-length t  ; t ã§ç„¡åˆ¶é™
      savehist-file (concat my:d:tmp "history"))
    #+end_src
** ãƒ•ã‚¡ã‚¤ãƒ«ï¼Œãƒ‡ã‚¤ãƒ¬ã‚¯ãƒˆãƒªæ•´ç†
   =~/.emacs.d/= ä»¥ä¸‹ã«ãƒ•ã‚¡ã‚¤ãƒ«ãŒè»¢ãŒã‚‹ã®ãŒãªã‚“ã‹å«Œãªã®ã§, æ°—ãŒã¤ãåº¦ã«è¨­å®šã—ã¦ã„ã‚‹.
   #+begin_src emacs-lisp
(use-package url
  :init
  (setq url-configuration-directory (concat my:d:tmp "url")))
(use-package nsm
  :if (featurep 'nsm)
  :init
  (setq nsm-settings-file (concat my:d:tmp "network-settings.data")))
   #+end_src
   ä»–ã«ã‚‚ã‚¤ãƒ­ã‚¤ãƒ­ã‚ã‚Šãã†ï¼
** versionç®¡ç†: =vc=
   çµ„ã¿è¾¼ã¿ã® vc-mode ã¯ mode-line ã®æ•´å½¢ã«ã—ã‹åˆ©ç”¨ã—ãªã„.
   #+BEGIN_SRC emacs-lisp
(use-package vc
  :config
  (setq vc-handled-backends '(Git)
        ;; symlink ã¯å¸¸ã«ãŠã„ã‹ã‘ã‚‹
        vc-follow-symlinks t)
  )
   #+END_SRC
** =recentf=: æœ€è¿‘ä½¿ã£ãŸãƒ•ã‚¡ã‚¤ãƒ«å±¥æ­´ã®ä¿ç®¡
   ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ãéš›ã«ã¯ =ido-recentf-open= ã‚’ä½¿ã†ã®ã§,
   çµå±€å±¥æ­´ã‚’è²¯ã‚ã‚‹è¨­å®šã‚’ã—ã¦ã„ã‚‹äº‹ã«ãªã£ã¦ã„ã‚‹.
   #+begin_src emacs-lisp
(use-package recentf
  :defer t
  :init
  (add-hook 'after-init-hook 'recentf-mode)
  (use-package recentf-ext :ensure t :defer t)
  :config
  (setq recentf-max-saved-items 256
        recentf-save-file (expand-file-name (concat my:d:tmp "recentf"))
        recentf-auto-cleanup 'never
        recentf-exclude '(".recentf"
                          "^/tmp\\.*"
                          "^/private\\.*"
                          "^/var/folders\\.*"
                          "/TAGS$"
                          "^/home/uwabami/.mozilla/\\.*"
                          "\\.*è‰ç¨¿\\.*"
                          ))
  )
   #+end_src
   ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å±¥æ­´ã‚‚å–ã‚Œã‚‹ã®ã§ recentf-ext ã‚’å…¥ã‚Œã¦ãŠã
** =.elc= ã¨ =.el= ã® timestamp ã‚’æ¯”è¼ƒã—ï¼Œæ–°ã—ã„æ–¹ã‚’èª­ã¿è¾¼ã‚€
   =load-prefer-newer= ã¯ Emacs >= 24.4 ã‹ã‚‰ï¼
   #+begin_src emacs-lisp
(when (boundp 'load-prefer-newer)
  (setq load-prefer-newer t))
   #+end_src
** ã‚¬ãƒ™ãƒ¼ã‚¸ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã® +é »åº¦ã‚’ä¸‹ã’ã‚‹+ è¡¨ç¤ºã‚’ã—ãªã„
   message ã« gc ãŒèµ°ã£ã¦ã„ã‚‹ã“ã¨ã‚’è¡¨ç¤ºã—ãªã„
   #+begin_src emacs-lisp
(setq gc-cons-threshold (* 8 1024 1024)
      garbage-collection-messages nil)
   #+end_src
   =gc-cons-threshold= ã¯ã¨ã‚Šã‚ãˆãš default ã®è¨­å®šã«.
   ãƒ¡ãƒ¢ãƒªå–°ã„ãªæ‹¡å¼µã‚’å…¥ã‚Œã¦ã„ã‚‹å ´åˆã«ã¯, å®‰æ˜“ã« =gc-cons-threshold= ã‚’ä¸Šã’ã‚‹ã®ã¯è€ƒãˆã‚‚ã®ã§ã‚ã‚‹.
   ã€Œgc ãŒèµ°ã‚‹â†’å¤§ããªé ˜åŸŸã‚’æƒé™¤ã™ã‚‹ã®ã§ãã®é–“ emacs ãŒæ­¢ã¾ã‚‹ã€ã¨ã„ã†äº‹ã‚’é »ç¹ã«çµŒé¨“ã™ã‚‹ã“ã¨ã«ãªã‚‹ã ã‚ã†.
** =abbrev=: ç•¥èªå±•é–‹
   #+begin_src emacs-lisp
(use-package abbrev
  :diminish abbrev-mode
  :config
  (setq abbrev-file-name (concat my:d:share "abbrev_defs")
        save-abbrevs t)
  (setq-default abbrev-mode t)
  )
   #+end_src
** =eldoc=: emacs-lisp document
   #+begin_src emacs-lisp
(use-package eldoc
  :diminish eldoc-mode
  :config
  (add-hook 'emacs-lisp-mode-hook 'turn-on-eldoc-mode)
  )
   #+end_src
** =midnight=: ä¸€å®šæœŸé–“ä½¿ç”¨ã—ãªã‹ã£ãŸ buffer ã‚’è‡ªå‹•å‰Šé™¤
   #+begin_src emacs-lisp
(use-package midnight
  :config
  (setq clean-buffer-list-delay-general 1))
   #+end_src
** =uniquify=: ãƒ¢ãƒ¼ãƒ‰ãƒ©ã‚¤ãƒ³ã®ãƒ•ã‚¡ã‚¤ãƒ«åã«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚‚è¡¨ç¤ºã™ã‚‹
   #+begin_src emacs-lisp
(use-package uniquify
  :config
  (setq uniquify-buffer-name-style 'post-forward-angle-brackets
        uniquify-min-dir-content 1
        )
  )
   #+end_src
** =whitespace=: ç©ºç™½ã®å¼·èª¿è¡¨ç¤º
   #+begin_src emacs-lisp
(use-package whitespace
  :config
  (setq whitespace-line-column 72
        whitespace-style '(face              ; faceã‚’ä½¿ã£ã¦è¦–è¦šåŒ–ã™ã‚‹ï¼
                           trailing          ; è¡Œæœ«ã®ç©ºç™½ã‚’å¯¾è±¡ã¨ã™ã‚‹ï¼
                           tabs              ; tab
                           spaces            ; space
                           )
        whitespace-display-mappings '((space-mark ?\u3000 [?\â–¡])
                                      (tab-mark ?\t [?\u00BB ?\t] [?\\ ?\t]))
        whitespace-space-regexp "\\(\u3000+\\)"
        whitespace-global-modes '(not
                                  eww-mode
                                  term-mode
                                  eshell-mode
                                  org-agenda-mode
                                  calendar-mode)
        )
  (global-whitespace-mode 1)
  )
   #+end_src
** =saveplace=: å‰å›ã®ä¿®æ­£ä½ç½®ã‚’è¨˜æ†¶ã™ã‚‹.
   è¨˜æ†¶ã®ä¿å­˜å…ˆã¯ =~/.emacs.d/tmp/emacs-places= ã«å¤‰æ›´.
   #+begin_src emacs-lisp
(use-package saveplace
  :config
  (setq-default save-place t)
  (setq save-place-file (concat my:d:tmp "emacs-places")))
   #+end_src
** =time-stamp=: ä¿å­˜æ™‚ã« timestamp ã‚’è‡ªå‹•æ›´æ–°
   ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã„ã‚ã„ã‚ã¨è¡çªã—ãŸã®ã§
   æ›´æ–°æ–‡å­—åˆ—ã‚’å¤‰æ›´ã—ï¼Œ =ï¼„Lastupdate: 2= (ï¼„ã¯åŠè§’) ãŒã‚ã£ãŸã‚‰ timestamp ã‚’æ›´æ–°ã™ã‚‹æ§˜ã«ã—ãŸï¼
   #+begin_src emacs-lisp
(use-package time-stamp
  :config
  (setq time-stamp-active t
        time-stamp-line-limit 10
        time-stamp-start "$Lastupdate: 2"
        time-stamp-end "\\$"
        time-stamp-format "%03y-%02m-%02d %02H:%02M:%02S")
  (add-hook 'before-save-hook 'time-stamp))
   #+end_src
   ãƒ¢ãƒ¼ãƒ‰ç‹¬è‡ªã®è¨­å®š(ä¾‹ãˆã° Org ã¨ã‹)ã«é–¢ã—ã¦ã¯åˆ¥é€”ï¼
** =tramp=: ssh è¶Šã—ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†
   #+begin_src emacs-lisp
(use-package tramp
  :no-require t
  :config
  (setq tramp-persistency-file-name (concat my:d:tmp "tramp"))
  )
   #+end_src
** =bookmark=: bookmark ãƒ•ã‚¡ã‚¤ãƒ«
   ã‚¤ãƒã‚¤ãƒä½¿ã„ã“ãªã›ã¦ãªã„. å ´æ‰€ã ã‘å¤‰æ›´ã—ã¦ãŠã.
   #+begin_src emacs-lisp
(setq bookmark-default-file (concat my:d:share "bookmarks"))
   #+end_src
** =eww=: å†…è”µãƒ–ãƒ©ã‚¦ã‚¶
   å¹…ã¨èƒŒæ™¯è‰²ã®æŒ‡å®šãŒãƒ¡ã‚¤ãƒ³ã ãŒã€
   ä¸Šæ‰‹ãã†ã”ã„ã¦ãã‚Œã¦ã„ãªã„ã€ã‚ˆã†ãªã€‚
   #+begin_src emacs-lisp
(use-package eww
  ;; vi like <- vimperator, vimium ã«æ…£ã‚Œã¦ã—ã¾ã£ãŸã®ã§
  :bind (:map eww-mode-map
              ("r"  . eww-reload)
              ("o"  . eww)
              ("&"  . eww-browse-with-external-browser)
              ("b"  . eww-back-url)
              ("]"  . eww-next-url)
              ("["  . eww-previous-url)
              ("g"  . eww-top-url)
              ("+"  . my:eww-increase-width)
              ("-"  . my:eww-decrease-width)
              ("h"  . backward-char)
              ("j"  . next-line)
              ("k"  . previous-line)
              ("l"  . forward-char)
              ("/"  . isearch-forward)
              ("?"  . isearch-backward)
              ("n"  . isearch-next)
              ("N"  . isearch-previous)
              ("f"  . ace-link-eww)
              )
  :init
  ;; eww
  (unless (file-directory-p (expand-file-name "eww" my:d:tmp))
    (make-directory (expand-file-name "eww" my:d:tmp)))
  (setq eww-bookmarks-directory (expand-file-name "eww" my:d:tmp)
        eww-search-prefix "https://www.google.com/search?&gws_rd=cr&complete=0&pws=0&tbs=li:1&lr=lang_ja|lang_en&q=")
  ;; èƒŒæ™¯è‰²ã®è¨­å®š
  (defvar eww-disable-colorize t)
  (defun shr-colorize-region--disable (orig start end fg &optional bg &rest _)
    (unless eww-disable-colorize
      (funcall orig start end fg)))
  (advice-add 'shr-colorize-region :around 'shr-colorize-region--disable)
  (advice-add 'eww-colorize-region :around 'shr-colorize-region--disable)
  (defun eww-disable-color ()
    "eww ã§æ–‡å­—è‰²ã‚’åæ˜ ã•ã›ãªã„"
    (interactive)
    (setq-local eww-disable-colorize t)
    (eww-reload))
  (defun eww-enable-color ()
    "eww ã§æ–‡å­—è‰²ã‚’åæ˜ ã•ã›ã‚‹"
    (interactive)
    (setq-local eww-disable-colorize nil)
    (eww-reload))
  (defun eww-disable-images ()
    "eww ã§ç”»åƒè¡¨ç¤ºã•ã›ãªã„"
    (interactive)
    (setq-local shr-put-image-function 'shr-put-image-alt)
    (eww-reload))
  (defun eww-enable-images ()
    "eww ã§ç”»åƒè¡¨ç¤ºã•ã›ã‚‹"
    (interactive)
    (setq-local shr-put-image-function 'my:shr-put-image)
    (eww-reload))
  (defun my:shr-put-image (spec alt &optional flags)
    "call xdg-open"
    (message "spec: %s" spec)
    (shr-put-image (spec alt &optional flags)))
  (defun shr-put-image-alt (spec alt &optional flags)
    (insert alt))
  ;; ã¯ã˜ã‚ã‹ã‚‰éè¡¨ç¤º
  (defun eww-mode-hook--disable-image ()
    (setq-local shr-put-image-function 'shr-put-image-alt))
  (add-hook 'eww-mode-hook 'eww-mode-hook--disable-image)
  ;; ãƒ†ã‚­ã‚¹ãƒˆå¹…ã®æŒ‡å®š
  (setq shr-width 78)
  (defvar my:shr-width 78)
  (defun my:shr-insert-document (&rest them)
    (let ((shr-width (min (1- (window-width)) my:shr-width)))
      (apply them)))
  (defun eww-display-html--fill-column (&rest them)
    (advice-add 'shr-insert-document :around 'my:shr-insert-document)
    (unwind-protect
        (apply them)
      (advice-remove 'shr-insert-document 'my:shr-insert-document)))
  (advice-add 'eww-display-html :around 'eww-display-html--fill-column)
  ;; increase
  (defun my:eww-increase-width ()
    (interactive)
    (make-local-variable 'my:shr-width)
    (setq my:shr-width  (+ 10 my:shr-width))
    (eww-reload))
  ;; decrease
  (defun my:eww-decrease-width ()
    (interactive)
    (make-local-variable 'my:shr-width)
    (setq my:shr-width  (- my:shr-width 10))
    (eww-reload))
  ;; buffer ã‚’ rename
  (defun eww-mode-hook--rename-buffer ()
    "Rename eww browser's buffer so sites open in new page."
    (rename-buffer "eww" t))
  (add-hook 'eww-mode-hook 'eww-mode-hook--rename-buffer)
  )
   #+end_src
** =browse-url=
   Firefox ã®å‘¼ã³å‡ºã—æ–¹ãŒå¤‰ã‚ã£ãŸã®ã§ï¼Œãã®ãŸã‚ã«é–¢æ•°ã‚’è¿½åŠ ï¼
   è©³ç´°ã¯ [[http://www.emacswiki.org/emacs/BrowseUrl]] ã‚’å‚ç…§ã®ã“ã¨ï¼
   #+begin_src emacs-lisp
(use-package browse-url
  :bind (("C-c C-j" . browse-url-at-point))
  :config
  (defun browse-url-firefox (url &optional new-window)
    "@see http://www.emacswiki.org/emacs/BrowseUrl"
    (interactive (browse-url-interactive-arg "URL: "))
    (setq url (browse-url-encode-url url))
    (let* ((process-environment (browse-url-process-environment))
           (window-args (if (browse-url-maybe-new-window new-window)
                            (if browse-url-firefox-new-window-is-tab
                                '("-new-tab")
                              '("-new-window"))))
           (ff-args (append browse-url-firefox-arguments window-args (list url)))
           (process-name (concat "firefox " url))
           (process (apply 'start-process process-name nil
                           browse-url-firefox-program ff-args) ))))
  (if (executable-find "firefox")
      (setq browse-url-browser-function 'browse-url-firefox
            shr-external-browser 'browse-url-firefox)
    (setq browse-url-browser-function 'eww-browse-url))
  )
   #+end_src
** =server=: Emacs server
   #+begin_src emacs-lisp
(use-package server
  :config
  (unless (server-running-p)
    (server-start)))
   #+end_src
* åŸºæœ¬çš„ãªã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒ‰ã®è¨­å®š
  æ—¢ã«æ‰‹ç™–ã«ãªã£ã¦ã—ã¾ã£ã¦ã„ã‚‹ã‚¢ãƒ¬ã‚³ãƒ¬ï¼
  ç‰¹ã« =[home]= ã¨ =[end]= ã¯ç„¡ã„ã¨é€”æ–¹ã«æš®ã‚Œã¾ã™ï¼
  #+BEGIN_SRC emacs-lisp
(use-package bind-key
  :config
  (bind-keys*
   ("<f2>"    . eww)
   ("C-h"     . backward-delete-char)
   ("C-c M-a" . align-regexp)
   ("C-c ;"   . comment-region)
   ("C-c M-;" . uncomment-region)
   ("C-/"     . undo)
   ("C-x M-b" . ibuffer-other-window)
   ("C-c M-r" . replace-regexp)
   ("C-c r"   . replace-string)
   ("<home>"  . beginning-of-buffer)
   ("<end>"   . end-of-buffer)
   ("C-c C-j" . browse-url-at-point)
   ))
  #+END_SRC
* Elscreen
** å°å…¥ [0/1]
   modeline ã®è¡¨ç¤ºãã®ã‚‚ã®ã¯ç„¡åŠ¹åŒ–ã—ã¦ãŠãï¼
   - [ ] Debian ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç‰ˆã¯å¤ã„ï¼æ›´æ–°ã™ã¹ã
   #+begin_src emacs-lisp
(use-package elscreen
  :ensure t
  :no-require t
  :init
  (setq elscreen-tab-display-control nil
        elscreen-prefix-key (kbd "C-o")
        elscreen-display-tab 8
        elscreen-display-screen-number nil)
  :config
  (elscreen-start))
   #+end_src
** elscreen + zsh ã§ã®é€£æº
   è©³ç´°ã¯
   - [[https://masutaka.net/chalow/2011-09-28-1.html][ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã® zsh ã¨ Emacs ã‚’é¢¨ã®ã‚ˆã†ã«é§†ã‘æŠœã‘ã‚‹ï¼]]
   - [[http://syohex.hatenablog.com/entry/20111026/1319606395][cdeã‚’æ”¹è‰¯]]
   - [[https://qiita.com/__hage/items/2dd732b4dd68e124e8bd][cdeã¨elscreen-separate-buffer-listã®ç›¸æ€§ãŒæ‚ªã„]]
   ãªã©ã‚’å‚è€ƒã«.
   #+begin_src emacs-lisp
(defun return-current-working-directory-to-shell ()
  (expand-file-name
   (with-current-buffer
       (if (featurep 'elscreen)
           (let* ((frame-confs (elscreen-get-frame-confs (selected-frame)))
                  (num (nth 1 (assoc 'screen-history frame-confs)))
                  (cur-window-conf
                   (assoc 'window-configuration
                          (assoc num (assoc 'screen-property frame-confs))))
                  (marker (nth 2 cur-window-conf)))
             (marker-buffer marker))
         (nth 1
              (assoc 'buffer-list
                     (nth 1 (nth 1 (current-frame-configuration))))))
     default-directory)))
   #+end_src
* Emacså†…ã®terminal: =multi-term=
  eshell ã¯ã‚‚ã£ã•ã‚Šã—ã¦ã„ã‚‹ã—, ansi-term ã¯è¤‡æ•°èµ·å‹•ã§ããªã„ã®ã§.
  #+BEGIN_SRC emacs-lisp
(use-package multi-term
  :ensure t
  :bind (:map term-raw-map
              ("C-h" . term-send-backspace)
              ("C-y" . term-paste))
  :config
  (setq multi-term-program (getenv "SHELL"))
  )
  #+END_SRC
  multi-term ã¨ elscreen ã®é€£æº
  #+BEGIN_SRC emacs-lisp
(use-package elscreen-multi-term
  :ensure t
  :after (elscreen multi-term)
  :bind (("C-c t" . emt-multi-term))
  )
  #+END_SRC
* æ—¥æœ¬èªå…¥åŠ›: =ddskk=
  [[http://openlab.ring.gr.jp/skk/ddskk-ja.html][Daredevil SKK (DDSKK)]] ã‚’ãƒ¡ã‚¤ãƒ³ã§ä½¿ç”¨ä¸­ï¼ç„¡ã„ã¨é€”æ–¹ã«æš®ã‚Œã‚‹ï¼
  ã¡ãªã¿ã«GTKãŒæœ‰åŠ¹ã«ãªã£ã¦ã„ã‚‹ã¨ =gtk-immodule= ãªã‚“ã‹ã¨è¡çªã™ã‚‹ã®ã§
  =~/.Xresources= ã§ xim ã‚’ç„¡åŠ¹ã«ã—ã¦ãŠãã¨è‰¯ã„ï¼
  ä¾‹ãˆã°ä»¥ä¸‹ã®æ§˜ã«:
  #+begin_src conf :tangle no
! disable XIM
Emacs*useXIM: false
  #+end_src
** Emacs æœ¬ä½“å´ã®è¨­å®š
   å®Ÿéš›ã®è¨­å®šã¯åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ã§è¡Œãªã‚ã‚Œã‚‹ãŸã‚
   ã“ã“ã§ã¯è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ä½ç½®å¤‰æ›´ã‚’å¤‰æ›´ã—ã¦ã„ã‚‹ï¼
   #+begin_src emacs-lisp
(unless (locate-library "skk")
  (package-install 'ddskk))
(use-package skk
  :bind (("C-x j"   . skk-mode)
         ("C-x C-j" . skk-mode)
         ("C-\\"    . skk-mode))
  :init
  (setq skk-user-directory (concat my:d:tmp "skk")
        skk-init-file (concat user-emacs-directory "init-ddskk")
        default-input-method "japanese-skk" )
  :config
  )
   #+end_src
** DDSKK æœ¬ä½“ã®è¨­å®š
   sticky shift: [[http://homepage1.nifty.com/blankspace/emacs/sticky.html][sticky shift]] ã‚’å‚ç…§ã®ã“ã¨.
   ddskk ã® 14.2 ä»¥é™ã‹ã‚‰åŒæ¢±ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã£ãŸ(ã‚ã‚ŠãŒãŸã„)
   #+begin_src emacs-lisp :tangle init-ddskk.el
(setq skk-sticky-key ";")
   #+end_src
   å¤‰æ›å€™è£œã®è¡¨ç¤ºä½ç½®
   #+begin_src emacs-lisp :tangle init-ddskk.el
(setq skk-show-candidates-always-pop-to-buffer t)
   #+end_src
   å€™è£œè¡¨ç¤ºä»¶æ•°ã‚’2åˆ—ã«
   #+begin_src emacs-lisp :tangle init-ddskk.el
(setq skk-henkan-show-candidates-rows 2)
   #+end_src
   æ—¥æœ¬èªè¡¨ç¤ºã—ãªã„
   #+begin_src emacs-lisp :tangle init-ddskk.el
(setq skk-japanese-message-and-error nil)
   #+end_src
   ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’æ—¥æœ¬èªã«ã—ãªã„ -> toolbar éè¡¨ç¤ºã ã—.
   #+begin_src emacs-lisp :tangle init-ddskk.el
(setq skk-show-japanese-menu nil)
   #+end_src
   æ³¨é‡ˆã®è¡¨ç¤º
   #+begin_src emacs-lisp :tangle init-ddskk.el
(setq skk-show-annotation nil)
   #+end_src
   ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ã®è¡¨ç¤ºã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º
   #+begin_src emacs-lisp :tangle init-ddskk.el
(setq skk-latin-mode-string "[_A]")
(setq skk-hiragana-mode-string "[ã‚]")
(setq skk-katakana-mode-string "[ã‚¢]")
(setq skk-jisx0208-latin-mode-string "[ï¼¡]")
(setq skk-jisx0201-mode-string "[_ï½±]")
(setq skk-abbrev-mode-string "[aA]")
(setq skk-indicator-use-cursor-color nil)
   #+end_src
   ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ã‚’å·¦ç«¯ã«è¡¨ç¤º
   #+begin_src emacs-lisp :tangle init-ddskk.el
(setq skk-status-indicator 'left)
   #+end_src
   mode-line ãŒå‹•ãã®ãŒè¨±ã›ãªã„ã®ã§ï¼Œã¡ã‚‡ã£ã¨ä¿®æ­£
   #+begin_src emacs-lisp :tangle init-ddskk.el
(defadvice skk-make-indicator-alist
    (after my:set-skk-default-indicator activate)
  (dolist (elem
           '((abbrev " [aA]" . "--[aA]:")
             (latin " [_A]" . "--[_A]:")
             (default " [--]" . "--[--]:")))
    (setq ad-return-value
          (append (cons elem nil)
                  (delq (assoc (car elem) ad-return-value) ad-return-value)))))
(setq skk-show-inline t)
   #+end_src
   ã‚«ãƒ¼ã‚½ãƒ«ã«ã¯è‰²ã‚’ã¤ã‘ãªã„
   #+begin_src emacs-lisp :tangle init-ddskk.el
(setq skk-use-color-cursor nil)
   #+end_src
*** ç·¨é›†é–¢é€£
    ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒ‰
    #+begin_src emacs-lisp :tangle init-ddskk.el
(global-set-key "\C-x\C-j" 'skk-mode)
(global-set-key "\C-xj" 'skk-mode)
(global-set-key "\C-j" 'skk-mode)
(global-set-key "\C-\\" 'skk-mode)
    #+end_src
    åŠè§’ã‚«ãƒŠã‚’å…¥åŠ›
    #+begin_src emacs-lisp :tangle init-ddskk.el
(setq skk-use-jisx0201-input-method t)
    #+end_src
    Enter ã§æ”¹è¡Œã—ãªã„
    #+begin_src emacs-lisp :tangle init-ddskk.el
(setq skk-egg-like-newline t)
    #+end_src
    "ã€Œ"ã‚’å…¥åŠ›ã—ãŸã‚‰"ã€"ã‚‚è‡ªå‹•ã§æŒ¿å…¥
    #+begin_src emacs-lisp :tangle init-ddskk.el
(setq skk-auto-insert-paren t)
    #+end_src
    å¥èª­ç‚¹å¤‰æ›ãƒ«ãƒ¼ãƒ«
    #+begin_src emacs-lisp :tangle init-ddskk.el
(setq skk-kuten-touten-alist
      '(
        (jp    . ("ã€‚" . "ã€"))
        (en-jp . ("ï¼" . "ï¼Œ"))
        (en    . (". " . ", "))
        ))
(setq-default skk-kutouten-type 'en)
    #+end_src
    å…¨è§’è¨˜å·ã®å¤‰æ›: @ ã§ã®æ—¥ä»˜å…¥åŠ›ã¯ä½¿ã‚ãªã„
    #+begin_src emacs-lisp :tangle init-ddskk.el
(setq skk-rom-kana-rule-list
      (append skk-rom-kana-rule-list
              '(("!" nil "!")
                (":" nil ":")
                (";" nil ";")
                ("?" nil "?")
                ("z " nil "ã€€")
                ("\\" nil "\\")
                ("@" nil "@")
                )))
    #+end_src
    é€ã‚Šä»®åãŒå³å¯†ã«æ­£ã—ã„å€™è£œã‚’å„ªå…ˆ
    #+begin_src emacs-lisp :tangle init-ddskk.el
(setq skk-henkan-strict-okuri-precedence t)
    #+end_src
    è¾æ›¸ã®å…±æœ‰
    #+begin_src emacs-lisp :tangle init-ddskk.el
(setq skk-share-private-jisyo t)
    #+end_src
    å¤‰æ›å€™è£œã‚’ç¸¦ã«è¡¨ç¤º
    #+begin_src emacs-lisp :tangle init-ddskk.el
(setq skk-show-inline 'vertical)
    #+end_src
*** ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ã‚¿ãƒ«ã‚µãƒ¼ãƒ
    minibuffer å†…ã§ã¯å¼·åˆ¶çš„ã« skk off.
    #+begin_src emacs-lisp :tangle init-ddskk.el
(add-hook 'skk-mode-hook
          (lambda ()
            (and (skk-in-minibuffer-p)
                 (skk-mode-exit))))
(setq skk-isearch-start-mode 'latin)
    #+end_src
    ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ã‚¿ãƒ«ã‚µãƒ¼ãƒã¯ migemo ã«ä»»ã›ã‚‹ã“ã¨ã«ï¼
*** è¾æ›¸ã®è¨­å®š
    è¿½åŠ ã—ã¦ã„ã‚‹è¾æ›¸ã®ä¸€è¦§ã¯
    - [[http://www.chibutsu.org/jisho/][åœ°çƒç‰©ç†è¾æ›¸]]
    - [[http://www.geocities.jp/living_with_plasma/tanudic.html][å¤©æ–‡ãƒ»å¤©ä½“ç‰©ç†ç”¨èªã®æ¼¢å­—å¤‰æ›ç”¨è¾æ›¸]]
    - ã¯ã¦ãªã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰
    - [[http://matsucon.net/material/dic/][2ã¡ã‚ƒã‚“ã­ã‚‹é¡”æ–‡å­—è¾æ›¸ MatsuCon]]
    - [[http://matsucon.net/][MatsuCon]]
    ã¨ã„ã£ãŸæ‰€.
    ã¯ã¦ãªã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‹ã‚‰ã®è¾æ›¸ã®æŠ½å‡ºã¯ [[http://d.hatena.ne.jp/znz][znz]] ã•ã‚“ã®
    - [[http://rubyist.g.hatena.ne.jp/znz/20060924/p1][ã€Œã¯ã¦ãªãƒ€ã‚¤ã‚¢ãƒªãƒ¼ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãµã‚ŠãŒãªãƒªã‚¹ãƒˆã€ã‚’ SKK ã®è¾æ›¸ã«å¤‰æ›]]
    ã‚’å‚è€ƒã«.
    [[http://matsucon.net/][MatsuCon]] ã§å…¬é–‹ã•ã‚Œã¦ã„ã‚‹é¡”æ–‡å­—ã«é–¢ã—ã¦ã¯
    é¡”æ–‡å­—ã« ; ã‚„ ãŒå«ã¾ã‚Œã¦ã„ã‚‹å ´åˆã«, é©å®œquoteã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã®ã§
    ä»¥ä¸‹ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§é©å½“ã«å¤‰æ›.
    #+begin_src ruby :tangle no
#!/usr/bin/env ruby
require 'nkf'
src = ARGV[0]
if ARGV.size < 1
  puts "usage: ime2skk.rb ime_dictionary"
  exit 0
end
File.open(src, "r") {|f|
  f.each do |line|
    line_euc = NKF.nkf("-S -e",line)
    if line_euc =~ /^([^!]+?)\t(.+?)\t.+$/
      entry = $1
      content = $2
      if content =~/;/
        puts entry + " /(concat \"" + content.gsub(';','\\\\073') + "\")/"
      elsif content =~/\//
        puts entry + " /(concat \"" + content.gsub('/','\\\\057') + "\")/"
      else
        puts entry + " /" + content + "/"
      end
    end
  end
}
    #+end_src
    ä»–ã«ã‚‚ quote ã™ã‚‹å¿…è¦ã‚ã‚‹ã‚ˆã†ãªæ°—ã‚‚ã™ã‚‹ã‘ã‚Œã©, ãã‚Œã¯æ°—ãŒã¤ã„ãŸæ™‚ã«.

    è¾æ›¸ã‚µãƒ¼ãƒã®æŒ‡å®šã¯ä»¥ä¸‹.
    #+begin_src emacs-lisp :tangle init-ddskk.el
(cond
 ((getenv "SKKSERVER")
  (setq skk-server-host "127.0.0.1"
        skk-server-portnum "1178"
        skk-large-jisyo  nil)
  (add-to-list 'skk-search-prog-list
               '(skk-server-completion-search) t)
  (add-to-list 'skk-search-prog-list
               '(skk-comp-by-server-completion) t))
 (t
  (setq skk-get-jisyo-directory (concat my:d:tmp "skk-jisyo")
        skk-large-jisyo (concat skk-get-jisyo-directory "/SKK-JISYO.L")))
 )
(when (file-exists-p "/usr/local/share/skkdic/SKK-JISYO.emoji.utf8")
  (setq skk-extra-jisyo-file-list
        (list '("/usr/local/share/skkdic/SKK-JISYO.emoji.utf8" . utf-8))))
    #+end_src
    è¾æ›¸ç™»éŒ²ã®éš›ã«é€ã‚Šä»®åã‚’å‰Šé™¤
    #+begin_src emacs-lisp :tangle init-ddskk.el
(setq skk-check-okurigana-on-touroku 'auto)
    #+end_src
    æ¼¢å­—ç™»éŒ²ã®ãƒŸã‚¹ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹
    #+begin_src emacs-lisp :tangle init-ddskk.el
(setq skk-check-okurigana-on-touroku t)
    #+end_src
*** å‹•çš„è£œå®Œ
    ã¾ã è¨­å®šã—ã¦ã„ãªã„...
    #+begin_src emacs-lisp :tangle init-ddskk.el
;; ;; å‹•çš„è£œå®Œ
;; (setq skk-dcomp-activate t)
;; (setq skk-dcomp-multiple-activate t)
;; (setq skk-dcomp-multiple-rows 5)
;; ;; å‹•çš„è£œå®Œã®è¤‡æ•°è¡¨ç¤ºç¾¤ã®ãƒ•ã‚§ã‚¤ã‚¹
;; (set-face-foreground 'skk-dcomp-multiple-face "Black")
;; (set-face-background 'skk-dcomp-multiple-face "LightGoldenrodYellow")
;; (set-face-bold-p 'skk-dcomp-multiple-face nil)
;; ;; å‹•çš„è£œå®Œã®è¤‡æ•°è¡¨ç¤ºéƒ¡ã®è£œå®Œéƒ¨åˆ†ã®ãƒ•ã‚§ã‚¤ã‚¹
;; (set-face-foreground 'skk-dcomp-multiple-trailing-face "dim gray")
;; (set-face-bold-p 'skk-dcomp-multiple-trailing-face nil)
;; ;; å‹•çš„è£œå®Œã®è¤‡æ•°è¡¨ç¤ºéƒ¡ã®é¸æŠå¯¾è±¡ã®ãƒ•ã‚§ã‚¤ã‚¹
;; (set-face-foreground 'skk-dcomp-multiple-selected-face "White")
;; (set-face-background 'skk-dcomp-multiple-selected-face "LightGoldenrod4")
;; (set-face-bold-p 'skk-dcomp-multiple-selected-face nil)
    #+end_src
*** éƒ¨é¦–å¤‰æ›, ç·ç”»æ•°å¤‰æ›
    ä¸Šæ‰‹ãä½¿ã„ã“ãªã›ã¦ã„ãªã„
    #+begin_src emacs-lisp :tangle init-ddskk.el
(add-to-list 'skk-search-prog-list
             '(skk-tankan-search 'skk-search-jisyo-file
                                 skk-large-jisyo 10000))
    #+end_src
* Copy & Paste:
** Linux: =xclip=
   =xclip= ã§ clipboard ã¨ãƒ‡ãƒ¼ã‚¿ã‚’ã‚„ã‚Šã¨ã‚Šï¼
   #+begin_src emacs-lisp
(use-package xclip
  :if (and (executable-find "xclip")
           (eq system-type 'gnu/linux))
  :ensure t
  :config
  (xclip-mode 1))
   #+end_src
   clipboard ã¨ PRIMARY ã®åŒæœŸã«ã¯ =gpaste= ã‚’ä½¿ã£ã¦ã„ã‚‹ï¼
** macOS
   #+begin_src emacs-lisp
(defun my:copy-from-osx ()
  "Get string via pbpaste"
  (shell-command-to-string "pbpaste"))
(defun my:paste-to-osx (text &optional push)
  "put `TEXT' via pbcopy with `PUSH' mode"
  (let ((process-connection-type nil))
    (let ((proc (start-process "pbcopy" "*Messages*" "pbcopy")))
      (process-send-string proc text)
      (process-send-eof proc))))
(if (eq system-type 'darwin)
    (progn
      (setq interprogram-cut-function 'my:paste-to-osx
            interprogram-paste-function 'my:copy-from-osx)))
   #+end_src
* ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ã‚¿ãƒ«æ¤œç´¢: =migemo=
  #+begin_src emacs-lisp
(use-package migemo
  :if (executable-find "cmigemo")
  :quelpa (migemo
           :fetcher github
           :repo "uwabami/migemo")
  :config
  (cond
   ((and (eq system-type 'darwin)
         (file-directory-p "/usr/local/share/migemo/utf-8/"))
    (setq migemo-dictionary "/usr/local/share/migemo/utf-8/migemo-dict"))
   (t
    (setq migemo-dictionary "/usr/share/cmigemo/utf-8/migemo-dict")))
  (setq migemo-command "cmigemo"
        migemo-options '("-q" "--emacs")
        migemo-user-dictionary nil
        migemo-regex-dictionary nil
        migemo-coding-system 'utf-8-unix)
  (migemo-init)
  )
  #+end_src
* Undo/Redo: =undo-tree=
  #+BEGIN_SRC emacs-lisp
(use-package undo-tree
  :ensure t
  :diminish " ğŸŒ´"
  :config
  (setq undo-tree-auto-save-history t
        my:undo-tree-history-dir (let ((dir (concat my:d:tmp
                                                    "undo-tree-history/")))
                                   (make-directory dir :parents) dir)
        undo-tree-history-directory-alist `(("." . ,my:undo-tree-history-dir)))
  (global-undo-tree-mode +1)
  )
  #+END_SRC
* è£œå®Œ: =ido=
  è£œå®Œã¯ =ido= ãŒè»½ã„ã—é€Ÿã„ã®ã§å¥½ã¿.
  è¦‹ãŸç›®ãŒã¡ã‚‡ã£ã¨ç°¡ç´ ã™ãã‚‹æ°—ã‚‚ã™ã‚‹ã®ã§ã€ãªã‚“ã¨ã‹å¼„ã‚ŠãŸã„æ‰€ã§ã¯ã‚ã‚‹ã€‚
** =ido= ã®è¨­å®š
   #+begin_src emacs-lisp
(use-package ido
  :bind (("C-x C-f" . ido-find-file))
  :config
  (ido-mode t)
  ;; (ido-everywhere t)  ; <- Wanderlust ã¿ãŸã„ã«, éå»ã®é¸æŠã‚’è¦šãˆã¦ã„ã‚‹å¥´ã¨ç›¸æ€§æ‚ªã„.
  (setq ido-enable-prefix nil             ; prefix match å…¥åŠ›ã‚’å…ˆé ­ä¸€è‡´å¯èƒ½
        ido-confirm-unique-completion t   ; TAB ã§åå‰ã®ä¸€è‡´ã¾ã§. ãã®å¾Œ RET ã§å®Ÿè¡Œ
        ido-enable-flex-matching t        ; flx matching ã‚’è©¦ã™éš›ã«ã¯ prefix ã‚’ç„¡åŠ¹åŒ–ã™ã‚‹ã“ã¨
        ido-enable-dot-prefix t           ; . ã‚’ prefix ã¨ã—ã¦æ‰±ã†
        ido-default-file-method   'selected-window
        ido-default-buffer-method 'selected-window
        ido-max-directory-size 100000  ;; avoid [Too Big]
        ido-enable-tramp-completion nil
        ido-use-faces t
        ido-ignore-extensions t
        ido-cannot-complete-command 'ido-next-match
        ido-save-directory-list-file (concat my:d:tmp "ido.last"))
  ;; è£œå®Œã§ç„¡è¦–ã™ã‚‹æ‹¡å¼µå­ã®è¿½åŠ ï¼ãã®ã†ã¡å¢—ãˆã‚‹ï¼
  (cl-loop for ext in
           '(".dvi"
             ".fdb_latexmk"
             ".fls"
             ".ilg"
             ".jqz"
             ".mod"
             ".nav"
             ".out"
             ".snm"
             ".synctex.gz"
             ".vrb"
             )
           do (add-to-list 'completion-ignored-extensions ext))
  (add-hook 'ido-setup-hook
            (lambda ()
              (define-key ido-completion-map (kbd "C-h") 'ido-delete-backward-updir)
              (define-key ido-completion-map (kbd "C-l") 'ido-delete-backward-updir)))
  (defun my:ido-disable-line-trucation ()
    (set (make-local-variable 'truncate-lines) nil))
  (add-hook 'ido-minibuffer-setup-hook 'my:ido-disable-line-trucation)
  )
   #+end_src
** =flx-ido=: flex match ã®å¼·åŒ–
   æ›–æ˜§ãƒãƒƒãƒãŒéå¸¸ã«ç›´æ„Ÿçš„ã«ãªã£ãŸï¼åœ°å‘³ã«ä¾¿åˆ©ã§æ‰‹æ”¾ã›ãªã„ï¼
   #+begin_src emacs-lisp
(use-package flx-ido
  :ensure t
  :config
  (flx-ido-mode 1)
  (setq flx-ido-use-faces nil
        flx-ido-threshold 10000)
  )
   #+end_src
** =ido-flx-with-migemo=: flx + migemo
   ã“ã‚Œã¯ä¾¿åˆ©ã 
   #+BEGIN_SRC emacs-lisp
(use-package ido-flex-with-migemo
  :if (executable-find "cmigemo")
  :ensure t
  :after (flx migemo)
  :config
  (ido-flex-with-migemo-mode))
   #+END_SRC
** =ido-grid=: å€™è£œã‚’ä¸¦ã¹ã¦è¡¨ç¤º
   æ¨ªã«ä¸¦ã¶ã¨æ­£ç›´ã‚·ãƒ³ãƒ‰ã‚¤ã®ã§ä¸¦ã¹ã¦ã¿ã‚‹ã€‚
   elpa ã«ã‚ã‚‹ã®ã¯ [[https://github.com/larkery/ido-grid-mode.el][ido-grid-mode]] ã ãŒ,
   #+BEGIN_QUOTE
   This is a successor to ido-grid-mode. It does essentially the same thing (display ido prospects in a grid), but itâ€™s rewritten to be faster and less flaky.
   #+END_QUOTE
   ã¨ã®äº‹ãªã®ã§ [[https://github.com/larkery/ido-grid.el][ido-grid.el]] ã®æ–¹ã‚’åˆ©ç”¨ã—ã¦ã„ã‚‹.
   #+begin_src emacs-lisp
(use-package ido-grid
  :quelpa (ido-grid
           :fetcher github
           :repo "larkery/ido-grid.el")
  :config
  (setq ido-grid-enabled t
        ido-grid-start-small nil
        ido-grid-rows 0.15
        ido-grid-max-columns nil
        ido-grid-indent 1
        ido-grid-column-padding 1
        ido-grid-bind-keys t)
  (ido-grid-enable)
  ;;; force single column
  (defun my:ido-grid-force-one-columns (o &rest args)
    (let ((ido-grid-max-columns 1) ;; single vertical col
          (ido-grid-start-small nil) ;; popup immediately
          (ido-grid-rows 0.15)) ;; 15% of frame height
      (apply o args)
      ))
  )
   #+end_src
** =ido-recentf=: recentf ã‚’ ido ã§
   "recentf-list" ã®çµæœã‚’æ•´å½¢ã—ã¦, minibuffer ã«ç´ã¾ã‚‹æ§˜ã«ç¸®å°ã—ãŸã‚Š
   #+begin_src emacs-lisp
(defun ido-recentf-open ()
  "Use `ido-completing-read' to \\[find-file] a recent file"
  (interactive)
  (let ((files (mapcar (lambda (f)
                         (cons (my:shorten-file-path f 77) f))
                       recentf-list)))
    (let ((selected (ido-completing-read "Files: " (mapcar #'car files))))
      (find-file (assoc-default selected files)))))
(bind-key "C-x C-r" 'ido-recentf-open)
   #+end_src
** =ido-
   #+BEGIN_SRC emacs-lisp
(use-package ido-completing-read+
  :ensure t)
   #+END_SRC
** =smex=
   M-x ã‚’ ido ã§ã€‚
   #+begin_src emacs-lisp
(use-package smex
  :bind (("M-x" . smex))
  :ensure t
  :config
  (setq smex-auto-update t
        smex-save-file (concat my:d:tmp "smex-items")
        smex-prompt-string "smex: "
        smex-flex-matching nil
        )
  )
   #+end_src
* è£œå®Œ: =compnay=
  ä»¥å‰ã¯ auto-complete ã‚’ä½¿ã£ã¦ã„ãŸãŒ, æœ€è¿‘ã“ã¡ã‚‰ã«ä¹—ã‚Šæ›ãˆãŸ.
  #+begin_src emacs-lisp
(use-package company
  :ensure t
  :bind (("C-M-i" . company-complete))
  :config
  ;; C-n, C-pã§è£œå®Œå€™è£œã‚’æ¬¡/å‰ã®å€™è£œã‚’é¸æŠ
  (define-key company-active-map (kbd "C-n") 'company-select-next)
  (define-key company-active-map (kbd "C-p") 'company-select-previous)
  (define-key company-search-map (kbd "C-n") 'company-select-next)
  (define-key company-search-map (kbd "C-p") 'company-select-previous)
  ;; C-sã§çµã‚Šè¾¼ã‚€
  (define-key company-active-map (kbd "C-s") 'company-filter-candidates)
  ;; TABã§å€™è£œã‚’è¨­å®š
  (define-key company-active-map (kbd "C-i") 'company-complete-selection)
  ;; å„ç¨®ãƒ¡ã‚¸ãƒ£ãƒ¼ãƒ¢ãƒ¼ãƒ‰ã§ã‚‚ C-M-iã§ company-modeã®è£œå®Œã‚’ä½¿ã†
  ;; (define-key emacs-lisp-mode-map (kbd "C-M-i") 'company-complete)
  (setq company-auto-expand t                 ; 1å€‹ç›®ã‚’è‡ªå‹•çš„ã«è£œå®Œ
        company-transformers
        '(company-sort-by-backend-importance) ; ã‚½ãƒ¼ãƒˆé †
        company-idle-delay 0.5                ; é…å»¶ãªã—ã«ã™ãè¡¨ç¤º
        company-minimum-prefix-length 4       ; ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯4
        company-selection-wrap-around t       ; å€™è£œã®æœ€å¾Œã®æ¬¡ã¯å…ˆé ­ã«æˆ»ã‚‹
        completion-ignore-case t
        company-dabbrev-downcase nil)
  (global-company-mode +1)
  )
  #+end_src
* è£œå®Œ: =yasnippet=
  #+BEGIN_SRC emacs-lisp
(use-package yasnippet
  :ensure t
  :bind (:map yas-minor-mode-map
              ("<C-tab>" . my:yas-ido-expand))
  :init
  (defvar my:snippet-dirs (concat my:d:share "snippets"))
  (unless (file-directory-p my:snippet-dirs)
    (make-directory my:snippet-dirs))
  ;; @see https://www.emacswiki.org/emacs/Yasnippet
  (defun my:yas-ido-expand ()
    "Lets you select (and expand) a yasnippet key"
    (interactive)
    (let ((original-point (point)))
      (while (and
              (not (= (point) (point-min) ))
              (not
               (string-match "[[:space:]\n]" (char-to-string (char-before)))))
        (backward-word 1))
      (let* ((init-word (point))
             (word (buffer-substring init-word original-point))
             (list (yas-active-keys)))
        (goto-char original-point)
        (let ((key (remove-if-not
                    (lambda (s) (string-match (concat "^" word) s)) list)))
          (if (= (length key) 1)
              (setq key (pop key))
            (setq key (ido-completing-read "key: " list nil nil word)))
          (delete-char (- init-word original-point))
          (insert key)
          (yas-expand)))))
  :config
  (setq yas-snippet-dirs
        '(my:snippet-dirs
          yasnippet-snippets-dir))
  (setq yas-prompt-function '(yas-ido-prompt))
  (add-hook 'after-init-hook
            (lambda ()
              (yas-global-mode 1)))
  )
  #+END_SRC
* æ ¡æ­£ï¼Œè¾æ›¸ç­‰
** spell checker
   ispell ã¯ã‚³ãƒãƒ³ãƒ‰ã¨ã—ã¦ =aspell= ã‚’åˆ©ç”¨ã™ã‚‹ï¼
   #+BEGIN_SRC emacs-lisp
(use-package ispell
  :if (file-executable-p "aspell")
  :init
  (setq-default ispell-program-name "aspell")
  :config
  (add-to-list 'ispell-skip-region-alist '("[^\000-\377]+")))
   #+END_SRC
   flyspell-mode ã¯åˆ¥é€”æœ‰åŠ¹åŒ–ã—ã¦ãŠã„ãŸæ–¹ãŒè‰¯ã„ã®ã‹ã‚‚ã—ã‚Œãªã„
   #+BEGIN_SRC emacs-lisp
(use-package flyspell
  :config
  (defun my:flyspell-popup-choose (orig event poss word)
    (if (window-system)
        (funcall orig event poss word)
      (flyspell-emacs-popup-textual event poss word)))
  (advice-add 'flyspell-emacs-popup :around #'my:flyspell-popup-choose)
  )
   #+END_SRC
** è¾æ›¸
   #+BEGIN_SRC emacs-lisp
(use-package lookup
  :if (and (my:dpkg-status "lookup-el")
           (file-exists-p "/usr/local/share/dict/lookup-enabled"))
  :commands (lookup lookup-region lookup-pattern)
  :no-require t
  :bind (("C-c w" . lookup-pattern)
         ("C-c W" . lookup-word))
  :init
  (setq lookup-search-agents
        '(
          (ndeb   "/usr/local/share/dict/eijiro"    :alias "è‹±è¾éƒ")
          (ndeb   "/usr/local/share/dict/waeijiro"  :alias "å’Œè‹±è¾éƒ")
          (ndeb   "/usr/local/share/dict/rikagaku5" :alias "ç†åŒ–å­¦è¾å…¸ ç¬¬5ç‰ˆ")
          (ndeb   "/usr/local/share/dict/koujien4"  :alias "åºƒè¾è‹‘ ç¬¬4ç‰ˆ")
          (ndeb   "/usr/local/share/dict/wadai5"    :alias "ç ”ç©¶ç¤¾ å’Œè‹±å¤§è¾å…¸ ç¬¬5ç‰ˆ")
          (ndeb   "/usr/local/share/dict/eidai6"    :alias "ç ”ç©¶ç¤¾ è‹±å’Œå¤§è¾å…¸ ç¬¬6ç‰ˆ")
          (ndeb   "/usr/local/share/dict/colloc"    :alias "ç ”ç©¶ç¤¾ è‹±å’Œæ´»ç”¨å¤§è¾å…¸ ")
          )))
   #+END_SRC
* èªè¨¼é–¢é€£: =plstore=, =oauth2=, =password-store=
** oauth2, plstore
   oauth2 ã®èªè¨¼æƒ…å ±ã¯ =plstore= ã§ä¿å­˜ã•ã‚Œã‚‹ï¼
   ãƒ•ã‚¡ã‚¤ãƒ«ã®ç½®ãå ´æ‰€ã¨æš—å·éµã®è¨­å®šã‚’ã—ã¦ãŠã.
   ã¾ãŸ, plstore ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯å¯¾ç§°éµæš—å·åŒ–ãªã®ã§ï¼Œ
   =GPG_KEY_ID= ã‚’è¨­å®šã—ã¦ãŠã.
   #+begin_src emacs-lisp
(use-package oauth2
  :ensure t
  :init
  (use-package plstore
    :if (getenv "GPG_KEY_ID")
    :init
    (setq plstore-secret-keys 'silent
          plstore-encrypt-to (getenv "GPG_KEY_ID"))
    )
  (setq oauth2-token-file (concat my:d:tmp "oauth2.plstore"))
  )
   #+end_src
** password-store
   #+begin_src emacs-lisp
(use-package password-store
  :if (and my:d:password-store
           (executable-find "pass"))
  :ensure t
  )
   #+end_src
** auth-password-store
   auth-source ã¨ã—ã¦ =password-store= ã‚’ä½¿ã†æ‹¡å¼µ
   #+begin_src emacs-lisp
(use-package auth-source-pass
  :if (and my:d:password-store
           (executable-find "pass"))
  :ensure t
  )
   #+end_src
* MUA ã®è¨­å®š: =wanderlust=
  MUA ã¨ã—ã¦ Wanderlust ã‚’ä½¿ã£ã¦ã„ã‚‹
** Emacs æœ¬ä½“å´ã®è¨­å®š
   Emacs æœ¬ä½“ã§ã®è¨­å®šã¯ä»¥ä¸‹ã®é€šã‚Š. Wanderlust è‡ªä½“ã®è¨­å®šã¯åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ã§è¡Œãªã‚ã‚Œã‚‹ï¼
   ã“ã“ã§ã¯ =wl-init-file= ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§ï¼Œè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ˜ç¤ºã—ã¦ã„ã‚‹ï¼
   #+begin_src emacs-lisp
(use-package wl
  :if (and (or (my:dpkg-status "wl")
               (my:dpkg-status "wl-beta"))
           (my:dpkg-status "rail"))
  :no-require t
  :commands (wl wl-other-frame wl-draft wl-user-agent wl-user-agent-compose wl-draft-send wl-draft-kill)
  :init
  (define-mail-user-agent
    'wl-user-agent
    'wl-user-agent-compose
    'wl-draft-send
    'wl-draft-kill
    'mail-send-hook)
  (setq elmo-msgdb-directory "~/.cache/wanderlust"
        elmo-maildir-folder-path "~/.cache/wanderlust"
        elmo-cache-directory "~/.cache/wanderlust"
        wl-score-files-directory "~/.cache/wanderlust"
        wl-init-file (concat user-emacs-directory "init-wl")
        mail-user-agent 'wl-user-agent
        read-mail-command 'wl)
  (unless (file-directory-p elmo-msgdb-directory)
    (make-directory elmo-msgdb-directory))
  (unless (file-directory-p (concat elmo-msgdb-directory "/local"))
    (make-directory (concat elmo-msgdb-directory "/local")))
  (unless (file-directory-p (concat elmo-msgdb-directory "/local/Trash"))
    (make-directory (concat elmo-msgdb-directory "/local/Trash")))
  ;; mode-line å¼„ã‚Š
  (defun my:wl-mode-line-buffer-identification (&optional id)
    (force-mode-line-update t))
  :config
  (with-eval-after-load 'wl
    (advice-add 'wl-mode-line-buffer-identification :override 'my:wl-mode-line-buffer-identification))
  (add-hook 'wl-folder-mode-hook  (lambda () (setq mode-name "ğŸ“")))
  (add-hook 'wl-summary-mode-hook (lambda () (setq mode-name "ğŸ“‚")))
  (add-hook 'wl-draft-mode-hook   (lambda () (setq mode-name "ğŸ“„")))
  (add-hook 'mime-view-mode-hook  (lambda () (setq mode-name "ğŸ“§")))
  )
   #+end_src
   å‰²ã¨ =/etc/emacs/site-start.d/65wl-beta.el= ã¨é‡è¤‡ã—ã¦ã„ã‚‹æ°—ãŒã™ã‚‹ãŒ...
** Wanderlust æœ¬ä½“ã®è¨­å®š
   å®Ÿéš›ã®è¨­å®šã¯ä»¥ä¸‹ã®é€šã‚Š
*** ä¾å­˜/è¿½åŠ ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨èª­ã¿è¾¼ã¿
**** rail
     SEMI ã‚„ FLIM ãªã©ã® UA ã®è¡¨ç¤ºã« [[http://uwabami.github.com/rail/][rail]] ã‚’ä½¿ã£ã¦ã„ã‚‹.
     ã¡ãªã¿ã« rail ã‚’æœ‰åŠ¹ã«ã™ã‚‹ã¨, ä»¥ä¸‹ã®æ§˜ã« User-Agent ãŒè¡¨ç¤ºã•ã‚Œã‚‹
     #+html: <div class="col-7 px2 mx-auto">
     #+html: <amp-img layout="responsive" width=640 height=400 src="https://uwabami.github.io/software/rail/images/wanderlust_with_or_without_rail.png" alt="rail preview"></amp-img>
     #+html: </div>

     #+begin_src emacs-lisp :tangle init-wl.el
(eval-when-compile (require 'mime-def))
(use-package rail
  :config
  (setq rail-emulate-genjis t))
     #+end_src
**** cp5022x ã‚’ä½¿ã†
     ISO-2022-JP ã‚’ CP50220 ã¨ã—ã¦æ‰±ã†.
     [[http://d.hatena.ne.jp/kiwanami/20091103/1257243524][Wanderlustã¨æ–‡å­—ã‚³ãƒ¼ãƒ‰]] ã‚‚å‚ç…§ã®ã“ã¨.
     #+begin_src emacs-lisp :tangle init-wl.el
(add-to-list 'mime-charset-coding-system-alist '(iso-2022-jp . cp50220))
(setq wl-mime-charset 'iso-2022-jp)
     #+end_src
**** elscreen-wl
     ãƒ¡ãƒ¼ãƒ«ä½œæˆæ™‚ã« =elscreen= ã¨é€£æºã—ã¦ãã‚Œã‚‹ï¼ä¾¿åˆ©
     #+begin_src emacs-lisp :tangle init-wl.el
                                        ; (use-package elscreen-wl)
     #+end_src
**** SEMI ã®è¿½åŠ è¨­å®š
     HTML ãƒ¡ãƒ¼ãƒ«ã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚ã« eww ã‚’ä½¿ã†.
     mime-setup ãŒãƒ­ãƒ¼ãƒ‰ã•ã‚Œã‚‹å‰ã«è¨˜è¿°ã™ã‚‹å¿…è¦ã‚ã‚Š.
     #+begin_src emacs-lisp :tangle init-wl.el
(setq mime-view-text/html-previewer 'shr)
(setq mime-setup-enable-inline-html 'shr)
;; å¹…æŒ‡å®š â†’ å®Ÿéš›ã®é–¢æ•°ã¯ eww ã®è¨­å®šã‚’å‚ç…§
(defun my:mime-shr-preview-text/html (&rest args)
  (advice-add 'shr-insert-document :around 'my:shr-insert-document)
  (unwind-protect
      (apply args)
    (advice-remove 'shr-insert-document 'my:shr-insert-document)))
(advice-add 'mime-shr-preview-text/html :around
            'my:mime-shr-preview-text/html)
;;
(use-package mime-setup)
     #+end_src
     ã©ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§é–‹ãã‹ â†’ =xdg-open= ã«ä¸¸æŠ•ã’ï¼
     #+begin_src emacs-lisp :tangle init-wl.el
;; (setq mime-view-mailcap-files '("~/.mailcap"))
     #+end_src
     =~/.mailcap= è‡ªä½“ã¯ä»¥ä¸‹
     #+begin_src conf :tangle no
applications/*; xdg-open %s;
image/*; xdg-open %s;
video/*; xdg-open %s;
     #+end_src
     MIME ã®ä¾‹ã®ä¿å­˜å…ˆã®å¤‰æ›´
     #+begin_src emacs-lisp :tangle init-wl.el
(setq mime-situation-examples-file
      (concat my:d:tmp "mime-example"))
     #+end_src
     text/plain ã‚’ html ã‚ˆã‚Šå„ªå…ˆ
     #+begin_src emacs-lisp :tangle no
(setq mime-view-type-subtype-score-alist
      '(((text . plain) . 0)
        ((text . html)  . 1)
        ))
     #+end_src
     éŸ³ã‚’é³´ã‚‰ã™ã‚¢ãƒ¬ã‚„ã‚³ãƒ¬ã®ç„¡åŠ¹åŒ–
     #+begin_src emacs-lisp :tangle init-wl.el
(setq mime-play-find-every-situations nil
      mime-play-delete-file-immediately nil
      process-connection-type nil)
     #+end_src
*** å€‹äººæƒ…å ±ã®è¨­å®š
    å…·ä½“çš„ãªè¨­å®šå†…å®¹ã¯ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ç½®ã„ã¦ã„ã‚‹
    #+begin_src emacs-lisp :tangle init-wl.el
(load (concat my:d:password-store "/wl-info.gpg"))
    #+end_src
    è¨­å®šã—ã¦ã„ã‚‹å†…å®¹ã¯ä»¥ä¸‹ã®é€šã‚Š
**** è‡ªèº«ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨è³¼èª­ãƒ¡ãƒ¼ãƒªãƒ³ã‚°ãƒªã‚¹ãƒˆã®è¨­å®š
     #+begin_src emacs-lisp :tangle no
;; From: ã®è¨­å®š
(setq wl-from (concat user-full-name " <" user-mail-address ">"))
;; (system-name) ãŒ FQDN ã‚’è¿”ã•ãªã„å ´åˆã€
;; `wl-local-domain' ã«ãƒ›ã‚¹ãƒˆåã‚’é™¤ã„ãŸãƒ‰ãƒ¡ã‚¤ãƒ³åã‚’è¨­å®š
(setq wl-local-domain "example.com")
;; è‡ªåˆ†ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã®ãƒªã‚¹ãƒˆ
(setq wl-user-mail-address-list
      (list (wl-address-header-extract-address wl-from)
            ;; "e-mail2@example.com"
            ;; "e-mail3@example.net" ...
            ))
;; è‡ªåˆ†ã®å‚åŠ ã—ã¦ã„ã‚‹ãƒ¡ãƒ¼ãƒªãƒ³ã‚°ãƒªã‚¹ãƒˆã®ãƒªã‚¹ãƒˆ
(setq wl-subscribed-mailing-list
      '("wl@lists.airs.net"
        "apel-ja@m17n.org"
        "emacs-mime-ja@m17n.org"
        ;; "ml@example.com" ...
        ))
     #+end_src
**** é€å—ä¿¡ç”¨ã‚µãƒ¼ãƒã®è¨­å®š
     å—ä¿¡(IMAP)
     #+begin_src emacs-lisp :tangle no
(setq elmo-imap4-default-server "your imap server")
(setq elmo-imap4-default-port '993)
(setq elmo-imap4-default-stream-type 'ssl)
     #+end_src
     é€ä¿¡(SMTP)
     #+begin_src emacs-lisp :tangle no
(setq wl-smtp-posting-server "your smtp server")
(setq wl-smtp-posting-user "your account")
(setq wl-smtp-posting-port 587)
(setq wl-smtp-connection-type 'starttls)
(setq wl-smtp-authenticate-type "login")
     #+end_src
**** From ã«å¿œã˜ã¦é€ä¿¡ã‚µãƒ¼ãƒã‚’ãã‚Šã‹ãˆã‚‹.
     æœ¬æ¥ã¯ãƒ¡ãƒ¼ãƒ«ä½œæˆæ™‚/è¿”ä¿¡æ™‚ã® template ã®åˆ‡ã‚Šæ›¿ãˆãªã®ã ã‚Œã©,
     é€ä¿¡æ™‚ã® SMTP ã®è¨­å®šã‚’ from ã«åˆã‚ã›ã¦ãã‚Šã‹ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹.
     default ã«äºŒé‡ã«æŒ‡å®šã—ã¦ã„ã‚‹ã®ã¯ï¼Œ
     ä¸€åº¦åˆ¥ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«åˆ‡ã‚Šæ›¿ãˆãŸå¾Œã«å†ã³ãƒˆã‚°ãƒ«ã—ã¦æˆ»ã£ã¦æ¥ãŸéš›ã«å…ƒã«æˆ»ã™(ä¸Šæ›¸ã)ã™ã‚‹ãŸã‚.
     #+begin_src emacs-lisp :tangle no
(setq wl-template-alist
      '(("default"
         ("From" . wl-from)
         (wl-smtp-posting-server . "your smtp server")
         (wl-smtp-posting-user . "your account")
         (wl-smtp-posting-port . 587)
         (wl-smtp-connection-type . 'starttls)
         (wl-smtp-authenticate-type . "login")
         )
        ("example1"
         ("From" . "Your Name <account@example1.com>")
         (wl-smtp-posting-server . "smtp.example1.com")
         (wl-smtp-posting-user . "your account")
         (wl-smtp-posting-port . 587)
         (wl-smtp-connection-type . 'starttls)
         (wl-smtp-authenticate-type . "login")
         )
        ("example2"
         ("From" . "Your Name <account@example2.com>")
         (wl-smtp-posting-server . "smtp.example2.com")
         (wl-smtp-posting-user . "your account")
         (wl-smtp-posting-port . 587)
         (wl-smtp-connection-type . 'starttls)
         (wl-smtp-authenticate-type . "plain")
         )
        ("ssh:smtp"
         ;; need ssh tunnel
         ;; ssh -f -N -L 20025:localhost:25 smtp.server.com
         ("From" . "Your Name <account@example3.com>")
         (wl-smtp-posting-server . "localhost")
         (wl-smtp-posting-user . "your ssh account")
         (wl-smtp-posting-port . 20025)
         (wl-smtp-connection-type . 'nil)
         (wl-smtp-authenticate-type . 'nil)
         )
        ))
     #+end_src
     ssh tunnel ã‚’è‡ªå‹•çš„ã«ã‚„ã‚‹äº‹ã¯ã§ããªã„ãƒ¢ãƒ³ã ã‚ã†ã‹
     (é€ä¿¡æ™‚ã« open ã—ã¦, é€ä¿¡å¾Œã« close ã™ã‚‹, ã¿ãŸã„ãªã®).

     ã¤ã„ã§ã« template ã®åˆ‡ã‚Šæ›¿ãˆã«é–¢ã—ã¦å¹¾ã¤ã‹è¨­å®š.
     #+begin_src emacs-lisp :tangle init-wl.el
;; template åˆ‡ã‚Šæ›¿ãˆæ™‚ã« å†…å®¹ã‚’è¡¨ç¤º
(setq wl-template-visible-select t)
     #+end_src
     =draft-mode= ã§ =C-c C-n= ã‚’ã™ã‚‹ã¨ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’åˆ‡ã‚Šæ›¿ãˆ
     #+begin_src emacs-lisp  :tangle init-wl.el
(define-key wl-draft-mode-map "\C-c\C-n" 'wl-template-select)
     #+end_src
     from ã«å¿œã˜ã¦ wl-from, wl-envelope-from,
     é€ä¿¡ smtp ã‚µãƒ¼ãƒã‚’å¤‰æ›´ã™ã‚‹é€ä¿¡æ™‚ã«å¤‰æ›´
     #+begin_src emacs-lisp  :tangle init-wl.el
(add-hook 'wl-draft-send-hook
          (lambda ()
            (set (make-local-variable 'wl-from)
                 (std11-fetch-field "From"))))
     #+end_src
     é€ä¿¡æ™‚ã«è‡ªå‹•çš„ã« wl-draft-config-alist ã‚’é©ç”¨...ã—ãªã„?
     #+begin_src emacs-lisp  :tangle init-wl.el
(remove-hook 'wl-draft-send-hook 'wl-draft-config-exec)
     #+end_src
*** åŸºæœ¬è¨­å®š
**** imap é–¢é€£
     ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®èªè¨¼è¨­å®š
     ãƒ•ã‚©ãƒ«ãƒ€åã¯ UTF-7 ã§ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã‚‹ã®ã§,
     è¡¨ç¤ºã™ã‚‹éš›ã«ã“ã‚Œã‚’ãƒ‡ã‚³ãƒ¼ãƒ‰ã™ã‚‹
     #+begin_src emacs-lisp :tangle init-wl.el
(setq elmo-imap4-use-modified-utf7 t)
     #+end_src
**** éåŒæœŸãƒã‚§ãƒƒã‚¯
     #+begin_src emacs-lisp :tangle init-wl.el
(setq wl-folder-check-async t)
     #+end_src
**** ãƒ•ã‚©ãƒ«ãƒ€ã®ä½ç½®ã® default ã‹ã‚‰ã®å¤‰æ›´
     =~/.cache/wanderlust/= ã«é›†ç´„ã—ã¦ã„ã‚‹
     local ã® Mail folder ã®ä½ç½®
     #+begin_src emacs-lisp :tangle init-wl.el
(setq elmo-maildir-folder-path "~/.cache/wanderlust"
      elmo-localdir-folder-path "~/.cache/wanderlust/local")
     #+end_src
     local ãƒ•ã‚©ãƒ«ãƒ€ã®è¨­å®š:
     =.lost+found= ã¯ =elmo-maildir-folder-path= ã‹ã‚‰ã®ç›¸å¯¾ãƒ‘ã‚¹ã«ãªã£ã¦ã„ã‚‹ã“ã¨ã«æ³¨æ„
     #+begin_src emacs-lisp :tangle init-wl.el
(setq elmo-lost+found-folder ".lost+found")
(setq wl-queue-folder "+queue")
     #+end_src
     folders ã®ä½ç½®ã®å¤‰æ›´
     #+begin_src emacs-lisp :tangle init-wl.el
(setq wl-folders-file (concat my:d:password-store "/wl-folders.gpg"))
     #+end_src
     Drafts, Trash ã®ç½®ãå ´æ‰€
     #+begin_src emacs-lisp :tangle init-wl.el
(setq wl-draft-folder "+Drafts")
(setq wl-trash-folder "+Trash")
(setq elmo-lost+found-folder "+lost+found")
(setq wl-temporary-file-directory "~/Downloads/")
     #+end_src
     ã‚¢ãƒ‰ãƒ¬ã‚¹å¸³
     #+begin_src emacs-lisp :tangle init-wl.el
(setq wl-use-petname t)
(setq wl-address-file  "~/.mua/Address")
     #+end_src
     LDAP ã‚µãƒ¼ãƒã‹ã‚‰ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å¼•ãã“ã¨ã‚‚å¯èƒ½.
     ä»¥å‰ã¯ GCALDaemon ã‚’ä½¿ã£ã¦ local ã« ldap ã‚µãƒ¼ãƒã‚’ä¸Šã’ã¦ã„ãŸã®ã ã‘ã‚Œã©ã‚‚,
     Google Contacts ã® API ãŒå¤‰ã‚ã£ãŸã‚‰ã—ã
     GCALDaemon ã§ LDAP ã‚µãƒ¼ãƒã¯ä½¿ãˆãªããªã£ãŸã®ã§ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆ.
     #+begin_src emacs-lisp :tangle no
(setq wl-use-ldap t)
(setq wl-ldap-server "localhost")
(setq wl-ldap-port "389")
(setq wl-ldap-base "dc=math,dc=kyoto-u,dc=ac,dc=jp")
     #+end_src
     ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®ä¿å­˜å…ˆ
     #+begin_src emacs-lisp :tangle init-wl.el
(setq elmo-passwd-alist-file-name (concat my:d:password-store "/wl-passwd.gpg"))
     #+end_src
**** ãƒ•ã‚©ãƒ«ãƒ€ç·¨é›†æ™‚ã« backup ã‚’ä½œæˆã—ãªã„.
     #+begin_src emacs-lisp :tangle init-wl.el
(setq wl-fldmgr-make-backup nil)
     #+end_src
**** FCC, BCC ã®è¨­å®š
     #+begin_src emacs-lisp  :tangle init-wl.el
(setq wl-fcc nil)
;; (setq wl-fcc "%Sent")
     #+end_src
     fcc ã‚’æ—¢èª­ã«ã™ã‚‹å ´åˆã¯ä»¥ä¸‹ï¼=wl-fcc= ãŒ nil ã®å ´åˆã«ã¯æ„å‘³ã¯ç„¡ã„
     #+begin_src emacs-lisp   :tangle init-wl.el
(setq wl-fcc-force-as-read t)
     #+end_src
     bcc ã¯å¸¸ã«è‡ªèº«ã«.
     #+begin_src emacs-lisp  :tangle init-wl.el
(setq wl-bcc (concat user-mail-address))
     #+end_src
**** èµ·å‹•æ™‚ã« =%INBOX= ã®ã¿ã‚’ãƒã‚§ãƒƒã‚¯
     #+begin_src emacs-lisp   :tangle init-wl.el
(setq wl-auto-check-folder-name "%INBOX")
     #+end_src
**** ãƒ•ã‚©ãƒ«ãƒ€é¸æŠæ™‚ã®åˆæœŸè¨­å®š
     imap ã® namespace ã‚’æ¯åº¦å…¥åŠ›ã™ã‚‹ã®ãŒé¢å€’ãªã®ã§ï¼Œã“ã‚Œã‚’è¿½åŠ ã—ã¦ãŠã.
     #+begin_src emacs-lisp   :tangle init-wl.el
(setq wl-default-spec "%")
     #+end_src
**** confirm é–¢é€£ã®è¨­å®š
     ã‚¹ã‚­ãƒ£ãƒ³æ™‚ã®å•ã„åˆã‚ã›ã®ç„¡åŠ¹åŒ–.
     ã¡ãªã¿ã« confirm ã‚’ nil ã«ã—ã¦ã‚‚ å•ã„åˆã‚ã›ãŒç„¡ã„ã ã‘ã§
     threshold ã¯åŠ¹ãã®ã§, æ˜ç¤ºçš„ã« nil ã«.
     #+begin_src emacs-lisp   :tangle init-wl.el
(setq elmo-folder-update-confirm nil)
(setq elmo-folder-update-threshold nil)
(setq elmo-message-fetch-confirm nil)
(setq elmo-message-fetch-threshold nil)
(setq wl-prefetch-confirm nil)
(setq wl-prefetch-threshold nil)
     #+end_src
     çµ‚äº†æ™‚ã«ç¢ºèªã—ãªã„
     #+begin_src emacs-lisp  :tangle init-wl.el
(setq wl-interactive-exit nil)
     #+end_src
     é€ä¿¡æ™‚ã¯ç¢ºèªã™ã‚‹
     #+begin_src emacs-lisp :tangle init-wl.el
(setq wl-interactive-send t)
     #+end_src
**** misc.
     å¤§ãã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡æ™‚ã«åˆ†å‰²ã—ãªã„
     #+begin_src emacs-lisp   :tangle init-wl.el
(setq mime-edit-split-message nil)
     #+end_src
     ã‚¹ãƒ¬ãƒƒãƒ‰ã¯å¸¸ã«é–‰ã˜ã‚‹
     #+begin_src emacs-lisp   :tangle init-wl.el
(setq wl-thread-insert-opened nil)
     #+end_src
     3 pain è¡¨ç¤º -> ä½¿ã‚ãªã„
     #+begin_src emacs-lisp   :tangle init-wl.el
(setq wl-stay-folder-window nil)
     #+end_src
     æœªèª­ã‚’å„ªå…ˆçš„ã«èª­ã‚€
     #+begin_src emacs-lisp   :tangle init-wl.el
(setq wl-summary-move-order 'unread)
     #+end_src
     æ”¹ãƒšãƒ¼ã‚¸ç„¡è¦–
     #+begin_src emacs-lisp   :tangle init-wl.el
(setq wl-break-pages nil)
     #+end_src
     icon ã‚’ä½¿ã‚ãªã„ â†’ GUI ã§ã‚‚ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¡¨ç¤ºã—ã¦ãªã„ã—, ä½“æ„Ÿçš„ã«ã¯é…ããªã‚‹
     #+begin_src emacs-lisp   :tangle init-wl.el
(setq wl-highlight-folder-with-icon nil)
     #+end_src
**** dispose, delete ã®è¨­å®š
     Gmailç”¨ã«%INBOXã§ã¯å‰Šé™¤ã‚’ =wl-trash-folder= ã¸ã®ç§»å‹•ã§ã¯ãªãï¼Œã€Œdeleteã€ã«ï¼
     #+begin_src emacs-lisp   :tangle init-wl.el
(add-to-list 'wl-dispose-folder-alist
             '("^%INBOX" . remove))
     #+end_src
     è¿·æƒ‘ãƒ¡ãƒ¼ãƒ«é–¢é€£ã‚‚
     #+begin_src emacs-lisp   :tangle init-wl.el
(add-to-list 'wl-dispose-folder-alist
             '(".*Junk$" . remove))
     #+end_src
**** æŠ˜ã‚Šè¿”ã—ã®è¨­å®š
     message ã¯æŠ˜ã‚Šè¿”ã™.
     #+begin_src emacs-lisp   :tangle init-wl.el
(setq wl-message-truncate-lines nil)
     #+end_src
     draft ã‚‚æŠ˜ã‚Šè¿”ã™
     #+begin_src emacs-lisp   :tangle init-wl.el
(setq wl-draft-truncate-lines nil)
     #+end_src
**** mode-line ã®è¨­å®š
     é•·ã„ã¨å«Œãªã®ã§ã‚¤ãƒ­ã‚¤ãƒ­å‰Šã‚‹
     #+begin_src emacs-lisp   :tangle init-wl.el
(setq wl-summary-mode-line-format "") ; "%f {%t}(%n/%u/%a)"
(setq wl-message-mode-line-format "") ; "<< %f:%F>> [%m]"
     #+end_src
*** ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒ‰é–¢é€£
    =use-package= ã§è¨­å®šã—ã¦ãŠã„ãŸæ–¹ãŒè‰¯ã„ã‹ãªã...
    =C-c C-j= ã‚’ browse-url ã«æ˜ã‘æ¸¡ã™
    #+begin_src emacs-lisp :tangle init-wl.el
(define-key wl-draft-mode-map "\C-c\C-j" 'browse-url-at-point)
    #+end_src
    =M-u= ã§ unread ã«ã™ã‚‹
    #+begin_src emacs-lisp :tangle init-wl.el
(define-key wl-summary-mode-map "\M-u" 'wl-summary-mark-as-unread)
    #+end_src
    =i= ã§ sync <- Mew é¢¨
    #+begin_src emacs-lisp :tangle init-wl.el
(define-key wl-summary-mode-map "i" 'wl-summary-sync-update)
    #+end_src
    =C-o= ã¯ elscreen ã§ä½¿ã†
    #+begin_src emacs-lisp :tangle init-wl.el
(define-key wl-summary-mode-map "\C-o" nil )
    #+end_src
    =M-o= ã§ =auto-refile=  (Mew é¢¨)
    #+begin_src emacs-lisp :tangle init-wl.el
(define-key wl-summary-mode-map "\M-o" 'wl-summary-auto-refile)
    #+end_src
*** flag ã¨ãƒ•ã‚©ãƒ«ãƒ€ã‚’è¡Œãæ¥ã™ã‚‹é–¢æ•°ã®è¿½åŠ 
    "=" ã§ãƒ•ãƒ©ã‚°ä»˜ããƒ•ã‚©ãƒ«ãƒ€ã¨
    å®Ÿéš›ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã‚ã‚‹ãƒ•ã‚©ãƒ«ãƒ€ã‚’è¡Œãæ¥ã™ã‚‹.
    Gmail ã®ã€Œã‚¹ã‚¿ãƒ¼ä»˜ãã€ãƒ•ã‚©ãƒ«ãƒ€ã§ã‚‚æœ‰åŠ¹
    #+begin_src emacs-lisp :tangle init-wl.el
(require 'elmo nil 'noerror)
(defun my:wl-summary-jump-to-referer-message ()
  (interactive)
  (when (wl-summary-message-number)
    (if (eq (elmo-folder-type-internal wl-summary-buffer-elmo-folder) 'flag)
        (progn
          (let* ((referer (elmo-flag-folder-referrer
                           wl-summary-buffer-elmo-folder
                           (wl-summary-message-number)))
                 (folder (if (> (length referer) 1)
                             (completing-read
                              (format "Jump to (%s): " (car (car referer)))
                              referer
                              nil t nil nil (car (car referer)))
                           (car (car referer)))))
            (wl-summary-goto-folder-subr folder 'no-sync nil nil t)
            (wl-summary-jump-to-msg (cdr (assoc folder referer)))))
      (when (eq (elmo-folder-type wl-summary-last-visited-folder) 'internal)
        (wl-summary-goto-last-visited-folder)))))
(define-key wl-summary-mode-map "=" 'my:wl-summary-jump-to-referer-message)
    #+end_src
*** summary-mode ã®è¡¨ç¤ºã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º
**** è‡ªåˆ†ãŒå·®å‡ºäººã§ã‚ã‚‹ mail ã¯ To:æŸ ã¨è¡¨ç¤º
     #+begin_src emacs-lisp  :tangle init-wl.el
(setq wl-summary-showto-folder-regexp ".*")
(setq wl-summary-from-function 'wl-summary-default-from)
     #+end_src
**** ã‚µãƒãƒªè¡Œã®è¡¨ç¤ºé–¢é€£
     ã‚µãƒãƒªè¡Œã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæŒ‡å®š
     #+begin_src emacs-lisp  :tangle init-wl.el
(setq wl-summary-line-format
      "%T%P%1@%1>%Y/%M/%D %21(%t%[%19(%c %f%)%]%) %#%~%s"
      wl-summary-width 84)
     #+end_src
     ã‚µãƒãƒªè¡¨ç¤ºã¯åˆ‡ã‚Šè©°ã‚ãªã„
     #+begin_src emacs-lisp  :tangle init-wl.el
(setq wl-subject-length-limit t)
     #+end_src
     ã‚¹ãƒ¬ãƒƒãƒ‰ã®å¹…ã®æŒ‡å®š
     #+begin_src emacs-lisp  :tangle init-wl.el
(setq wl-thread-indent-level 2)
(setq wl-thread-have-younger-brother-str "+"
      wl-thread-youngest-child-str "+"
      wl-thread-vertical-str "|"
      wl-thread-horizontal-str "-"
      wl-thread-space-str " ")
     #+end_src

     ä»¥ä¸‹ã®äºŒã¤ã®è¨­å®šã‚’æœ‰åŠ¹ã«ã™ã‚‹ã«ã¯
     =elmo-msgdb-extra-fields= ã‚’è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹.
     ã“ã®å¤‰æ•°ã¯æŒ¯ã‚Šåˆ†ã‘åˆ¤å®šã«ã‚‚ä½¿ç”¨ã™ã‚‹ã®ã§ãã“ã§è¨­å®šã—ã¦ã„ã‚‹
**** Gmail é¢¨ã«, è‡ªåˆ†å®›ã®ãƒ¡ãƒ¼ãƒ«ã« ">" ã‚’ã¤ã‘ã¦è¡¨ç¤ºã™ã‚‹
     å…ƒãƒã‚¿ [[http://d.hatena.ne.jp/khiker/20080206/wanderlust]]
     #+begin_src emacs-lisp  :tangle init-wl.el
(setq wl-user-mail-address-regexp "^uwabami.*\\|^sasakyh.*")
;; ä¸€è¦§è¡¨ç¤ºã§ã®ç½®ãæ›ãˆè¦å‰‡ã«è¿½åŠ 
(defun my:wl-summary-line-for-me ()
  (if (catch 'found
        (let ((to (elmo-message-entity-field wl-message-entity 'to))
              (cc (elmo-message-entity-field wl-message-entity 'cc)))
          (when (or (stringp to) cc)
            (setq to
                  (append (if (stringp to) (list to) to)
                          (when cc
                            (if (stringp cc) (list cc) cc)))))
          (dolist (i to)
            (when (wl-address-user-mail-address-p (eword-decode-string i))
              (throw 'found t)))))
      ">"
    ""))
;; > ã‚’ summary-line-format ã«è¿½åŠ 
(setq wl-summary-line-format-spec-alist
      (append wl-summary-line-format-spec-alist
              '((?> (my:wl-summary-line-for-me)))))
     #+end_src
**** æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã£ãŸã‚‰, ã‚µãƒãƒªè¡Œã« @ ã‚’ä»˜ã‘ã‚‹
     #+begin_src emacs-lisp  :tangle init-wl.el
(setq wl-summary-line-format-spec-alist
      (append wl-summary-line-format-spec-alist
              '((?@ (wl-summary-line-attached)))))
     #+end_src
**** ã‚¯ã‚©ãƒ¼ãƒˆã•ã‚ŒãŸæ–‡å­—åˆ—ã‚‚ãƒ‡ã‚³ãƒ¼ãƒ‰ã™ã‚‹
     #+begin_src emacs-lisp  :tangle init-wl.el
(setq mime-header-lexical-analyzer
      '(
        ;; eword-analyze-quoted-string
        eword-analyze-domain-literal
        eword-analyze-comment
        eword-analyze-spaces
        eword-analyze-special
        eword-analyze-encoded-word
        eword-analyze-atom))
     #+end_src
**** Subject ãŒå¤‰ã‚ã£ã¦ã‚‚ã‚¹ãƒ¬ãƒƒãƒ‰ã‚’åˆ‡ã‚‰ãªã„
     #+begin_src emacs-lisp  :tangle init-wl.el
(setq wl-summary-divide-thread-when-subject-changed nil)
     #+end_src
**** Subject ã§ã® Tab ã‚„è¤‡æ•°ã‚¹ãƒšãƒ¼ã‚¹ã‚’ç„¡è¦–
     #+begin_src emacs-lisp  :tangle init-wl.el
(defadvice std11-unfold-string (after simply activate)
  (setq ad-return-value
        (elmo-replace-in-string ad-return-value "[ \t]+" " ")))
     #+end_src
**** é‡è¤‡ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’éè¡¨ç¤ºã«
     ãƒ•ã‚©ãƒ«ãƒ€å†…ã® Message-ID ãŒåŒã˜ãƒ¡ãƒ¼ãƒ«ã‚’éè¡¨ç¤ºã«ã™ã‚‹
     #+begin_src emacs-lisp  :tangle init-wl.el
(setq wl-folder-process-duplicates-alist
      '(
        (".*" . hide)
        ))
     #+end_src
**** sort é †: è¿”ä¿¡ãŒæ¥ãŸé †
     =flet= ã‚’æ›¸ãæ›ãˆã‚‹ã®ãŒé¢å€’ã§ =el-x= ã«ã‚ã‚‹ =dflet= ã‚’ä½¿ã†ã‚ˆã†ã«å¤‰æ›´
     #+begin_src emacs-lisp  :tangle init-wl.el
(use-package el-x :ensure t)
(defun wl-summary-overview-entity-compare-by-reply-date (a b)
  "Compare message A and B by latest date of replies including thread."
  (dflet ((string-max2 (x y)
                       (cond ((string< x y) y)
                             ('t x)))
          (thread-number-get-date (x)
                                  (timezone-make-date-sortable (elmo-msgdb-overview-entity-get-date
                                                                (elmo-message-entity
                                                                 wl-summary-buffer-elmo-folder x))))
          (thread-get-family (x)
                             (cons x (wl-thread-entity-get-descendant (wl-thread-get-entity x))))
          (max-reply-date (x)
                          (cond ((eq 'nil x)
                                 'nil)
                                ((eq 'nil (cdr x))
                                 (thread-number-get-date (car x)))
                                ('t
                                 (string-max2 (thread-number-get-date (car x))
                                              (max-reply-date (cdr x)))))))
         (string<
          (max-reply-date (thread-get-family (elmo-message-entity-number a)))
          (max-reply-date (thread-get-family (elmo-message-entity-number b))))))
(add-to-list 'wl-summary-sort-specs 'reply-date)
(setq wl-summary-default-sort-spec 'reply-date)
     #+end_src
*** æŒ¯ã‚Šåˆ†ã‘è¨­å®š
    =$= ä»¥å¤–ã‚’æŒ¯ã‚Šåˆ†ã‘å¯¾è±¡ã«
    #+begin_src emacs-lisp  :tangle init-wl.el
(setq wl-summary-auto-refile-skip-marks '("$"))
    #+end_src
**** æŒ¯ã‚Šåˆ†ã‘åˆ¤å®šã«ä½¿ç”¨ã™ã‚‹ãƒ˜ãƒƒãƒ€
     æ·»ä»˜ã®æœ‰ç„¡ã®è¡¨ç¤ºã«ã‚‚ä½¿ã†ã®ã§ =Content-Type= ã‚‚ç™»éŒ².
     ã‚ã¨ =Delivered-To= ã¯ãƒ¡ãƒ¼ãƒ«ã®æ¤œç´¢ã®æ™‚ã«çµæ§‹é‡å®ã—ã¦ã„ã‚‹.
     #+begin_src emacs-lisp :tangle init-wl.el
(setq elmo-msgdb-extra-fields
      '(
        "List-Post"
        "List-Id"
        "List-ID"                  ;; ãŸã¾ã« List-ID ã§æ¥ã‚‹ãƒ¡ãƒ¼ãƒ«ã‚ã‚‹ã‚ˆã­?
        "Resent-CC"
        "Mailing-List"
        "X-Mailing-List"
        "X-ML-Address"
        "X-ML-Name"
        "X-ML-To"
        "Delivered-To"
        "Content-Type"              ;; æ·»ä»˜ã®æœ‰ç„¡ã®è¡¨ç¤ºã®ç‚ºã«è¿½åŠ 
        "X-Google-Appengine-App-Id" ;; GAEã®é€ä¿¡ã™ã‚‹ãƒ¡ãƒ¼ãƒ«ã®æŒ¯ã‚Šåˆ†ã‘ç”¨
        "To"
        "Cc"
        "From"
        "Subject"
        "Reply-To"
        "Auto-Submitted"            ;; Git commit/Cron notify
        ))
     #+end_src
*** ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º
**** ã„ã£ãŸã‚“å…¨ã¦éè¡¨ç¤ºã«
     #+begin_src emacs-lisp  :tangle init-wl.el
(setq wl-message-ignored-field-list '("^.*:"))
     #+end_src
**** è¦‹ãŸã„ãƒ˜ãƒƒãƒ€ã ã‘è¡¨ç¤º
     #+begin_src emacs-lisp  :tangle init-wl.el
(setq wl-message-visible-field-list
      '("^Subject:"
        "^From:"
        "^To:"
        "^Cc:"
        "^Date:"
        "^Message-ID:"
        ))
     #+end_src
**** è¡¨ç¤ºé †ã®å¤‰æ›´
     Mew é¢¨...
     #+begin_src emacs-lisp  :tangle init-wl.el
(setq wl-message-sort-field-list
      '("^Subject:"
        "^From:"
        "^To:"
        "^Cc:"
        "^Date:"
        "^Message-ID:"
        ))
     #+end_src
**** From, To ã‚’çœç•¥è¡¨ç¤ºã—ãªã„
     To ã‚„ From ã«ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒæ²¢å±±æŒ‡å®šã•ã‚Œã¦ã„ã‚‹ã¨çœç•¥ã•ã‚Œã‚‹ã®ã§ï¼Œã“ã‚Œã‚’ç„¡åŠ¹åŒ–
     #+begin_src emacs-lisp  :tangle init-wl.el
(setq wl-message-use-header-narrowing nil)
     #+end_src
*** Wanderlust: Face ã®è¨­å®š
    ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚ˆã‚Šç´°ã‹ãæŒ‡å®šã™ã‚‹ãŸã‚ã«å¹¾ã¤ã‹ã® face å®šç¾©ã‚’è¿½åŠ .
    #+begin_src emacs-lisp :tangle init-wl.el
(setq wl-highlight-message-header-alist
      '(("Subject[ \t]*:"
         . wl-highlight-message-subject-header-contents)
        ("From[ \t]*:"
         . wl-highlight-message-from-header-contents)
        ("Date[ \t]*:"
         . wl-highlight-message-date-header-contents)
        ("\\(.*To\\|Cc\\|Newsgroups\\)[ \t]*:"
         . wl-highlight-message-important-header-contents)
        ("\\(User-Agent\\|X-Mailer\\|X-Newsreader\\)[ \t]*:"
         . wl-highlight-message-unimportant-header-contents)
        ))
    #+end_src
    face ã®è‰²ä»˜ã‘
    #+BEGIN_SRC emacs-lisp
(defun my:wl-set-face (face spec)
  (make-face face)
  (cond ((fboundp 'face-spec-set)
         (face-spec-set face spec))
        (t
         (wl-declare-face face spec))))
(my:wl-set-face 'wl-highlight-folder-closed-face
                '((t (:foreground "#4cff4c" :bold nil :italic nil :weight normal ))))
(my:wl-set-face 'wl-highlight-folder-few-face
                '((t (:foreground "#FF4C4C" :bold t :italic nil :weight bold ))))
(my:wl-set-face 'wl-highlight-folder-zero-face
                '((t (:foreground "#f6f3e8" :bold nil :italic nil :weight normal ))))
(my:wl-set-face 'wl-highlight-message-cited-text-1
                '((t (:foreground "#7fff7f" :bold nil :italic nil :weight normal ))))
(my:wl-set-face 'wl-highlight-message-cited-text-2
                '((t (:foreground "#ffff7f" :bold nil :italic nil :weight normal ))))
(my:wl-set-face 'wl-highlight-message-cited-text-3
                '((t (:foreground "#7f7fff" :bold nil :italic nil :weight normal ))))
(my:wl-set-face 'wl-highlight-message-cited-text-4
                '((t (:foreground "#7fffff" :bold nil :italic nil :weight normal ))))
(my:wl-set-face 'wl-highlight-message-cited-text-5
                '((t (:foreground "#ff7fff" :bold nil :italic nil :weight normal ))))
(my:wl-set-face 'wl-highlight-message-cited-text-6
                '((t (:foreground "#ff7f7f" :bold nil :italic nil :weight normal ))))
(my:wl-set-face 'wl-highlight-message-cited-text-7
                '((t (:foreground "#4cff4c" :bold nil :italic nil :weight normal ))))
(my:wl-set-face 'wl-highlight-message-cited-text-8
                '((t (:foreground "#ffff4c" :bold nil :italic nil :weight normal ))))
(my:wl-set-face 'wl-highlight-message-cited-text-9
                '((t (:foreground "#4c4cff" :bold nil :italic nil :weight normal ))))
(my:wl-set-face 'wl-highlight-message-cited-text-10
                '((t (:foreground "#4cffff" :bold nil :italic nil :weight normal ))))
(my:wl-set-face 'wl-highlight-message-cited-text-11
                '((t (:foreground "#ff4cff" :bold nil :italic nil :weight normal ))))
(my:wl-set-face 'wl-highlight-message-cited-text-12
                '((t (:foreground "#ff4c4c" :bold nil :italic nil :weight normal ))))
(my:wl-set-face 'wl-highlight-message-date-header-contents
                '((t (:foreground "#4CFF4C" :bold t :italic nil :weight bold ))))
(my:wl-set-face 'wl-highlight-message-header-contents
                '((t (:foreground "#aaaaaa" :bold nil :italic nil :weight normal ))))
(my:wl-set-face 'wl-highlight-message-headers
                '((t (:foreground "#4CFFFF" :bold t :italic nil :weight bold ))))
(my:wl-set-face 'wl-highlight-message-important-header-contents2
                '((t (:foreground "#4CFF4C" :bold nil :italic nil :weight normal ))))
(my:wl-set-face 'wl-highlight-message-signature
                '((t (:foreground "#aaaaaa" :bold nil :italic nil :weight normal ))))
(my:wl-set-face 'wl-highlight-message-important-header-contents
                '((t (:foreground "#FF4CFF" :bold t :italic nil :weight bold ))))
(my:wl-set-face 'wl-highlight-message-subject-header-contents
                '((t (:foreground "#FF4C4C" :bold t :italic nil :weight bold ))))
(my:wl-set-face 'wl-highlight-message-from-header-contents
                '((t (:foreground "#FFFF4C" :bold t :italic nil :weight bold ))))
(my:wl-set-face 'wl-highlight-message-unimportant-header-contents
                '((t (:foreground "#aaaaaa" :bold nil :italic nil :weight normal ))))
(my:wl-set-face 'wl-highlight-summary-answered-face
                '((t (:foreground "#4CFF4C" :bold nil :italic nil :weight normal ))))
(my:wl-set-face 'wl-highlight-summary-refiled-face
                '((t (:foreground "#7F7FFF" :bold nil :italic nil :weight normal ))))
(my:wl-set-face 'wl-highlight-summary-thread-top-face
                '((t (:foreground "#F6F3E8" :bold nil :italic nil :weight normal ))))
(my:wl-set-face 'wl-highlight-summary-important-flag-face
                '((t (:foreground "#ffff4c" :bold nil :italic nil :weight normal ))))
;;
;; (my:wl-set-face 'wl-highlight-folder-killed-face
;;                 '((t (:foreground ,my:h:black :5Dbold nil :italic nil ))))
;; (my:wl-set-face 'wl-highlight-folder-many-face
;;                 '((t (:foreground ,my:h:magenta :bold nil :italic nil ))))
;; (my:wl-set-face 'wl-highlight-folder-opened-face
;;                 '((t (:foreground "#4cffff" :bold nil :italic nil ))))
;; (my:wl-set-face 'wl-highlight-folder-path-face
;;                 '((t (:underline t :bold nil :italic nil ))))
;; (my:wl-set-face 'wl-highlight-folder-unknown-face
;;                 '((t (:foreground "#4cffff" :bold nil :italic nil ))))
;; (my:wl-set-face 'wl-highlight-folder-unread-face
;;                 '((t (:foreground ,my:n:blue :bold nil :italic nil ))))
;; (my:wl-set-face 'wl-highlight-header-separator-face
;;                 '((t (:inherit highlight :bold t ))))
;; (my:wl-set-face 'wl-highlight-message-citation-header
;;                 '((t (:foreground ,my:h:green :bold nil :italic nil ))))
;; (my:wl-set-face 'wl-highlight-summary-copied-face
;;                 '((t (:foreground "#4CFFFF" :bold nil :italic nil ))))
;; (my:wl-set-face 'wl-highlight-summary-deleted-face
;;                 '((t (:foreground ,my:h:black :bold nil :italic nil ))))
;; (my:wl-set-face 'wl-highlight-summary-displaying-face
;;                 '((t (:underline t :bold nil :italic nil ))))
;; (my:wl-set-face 'wl-highlight-summary-disposed-face
;;                 '((t (:foreground "#aaaaaa" :bold nil :italic nil ))))
;; (my:wl-set-face 'wl-highlight-summary-flagged-face
;;                 '((t (:foreground ,my:h:yellow :bold nil :italic nil ))))
;; (my:wl-set-face 'wl-highlight-summary-forwarded-face
;;                 '((t (:foreground ,my:h:blue :bold nil :italic nil ))))
;; (my:wl-set-face 'wl-highlight-summary-high-read-face
;;                 '((t (:foreground ,my:h:green :bold nil :italic nil ))))
;; (my:wl-set-face 'wl-highlight-summary-high-unread-face
;;                 '((t (:foreground ,my:h:orange :bold nil :italic nil ))))
;; (my:wl-set-face 'wl-highlight-summary-important-face
;;                 '((t (:foreground "#ffff4c" :bold nil :italic nil ))))
;; (my:wl-set-face 'wl-highlight-summary-killed-face
;;                 '((t (:foreground ,my:h:black :bold nil :italic nil ))))
;; (my:wl-set-face 'wl-highlight-summary-l:read-face
;;                 '((t (:foreground "#4CFF4C" :bold nil :italic nil ))))
;; (my:wl-set-face 'wl-highlight-summary-l:unread-face
;;                 '((t (:foreground ,my:h:lightb :bold nil :italic nil ))))
;; (my:wl-set-face 'wl-highlight-summary-new-face
;;                 '((t (:foreground "#ff4c4c" :bold nil :italic nil ))))
;; (my:wl-set-face 'wl-highlight-summary-normal-face
;;                 '((t (:foreground "#f6f3e8" :bold nil :italic nil ))))
;; (my:wl-set-face 'wl-highlight-summary-prefetch-face
;;                 '((t (:foreground ,my:n:blue :bold nil :italic nil ))))
;; (my:wl-set-face 'wl-highlight-summary-resend-face
;;                 '((t (:foreground ,my:h:orange :bold nil :italic nil ))))
;; (my:wl-set-face 'wl-highlight-summary-target-face
;;                 '((t (:foreground "#4CFFFF" :bold nil :italic nil ))))
;; (my:wl-set-face 'wl-highlight-summary-temp-face
;;                 '((t (:foreground ,my:n:violet :bold nil :italic nil ))))
;; (my:wl-set-face 'wl-highlight-summary-unread-face
;;                 '((t (:foreground "#ff4c4c" :bold nil :italic nil ))))
;; (my:wl-set-face 'wl-highlight-thread-indent-face
;;                 '((t (:underline t :bold nil :italic nil ))))
    #+END_SRC
*** ä½œæˆ/è¿”ä¿¡è¨­å®š
    è‡ªåˆ†å®›ã®ãƒ¡ãƒ¼ãƒ«ã«è¿”ä¿¡ã™ã‚‹å ´åˆã¯ =To:=, =Cc:= ã‹ã‚‰è‡ªåˆ†ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å‰Šé™¤
    #+begin_src emacs-lisp  :tangle init-wl.el
(setq wl-draft-always-delete-myself t)
    #+end_src
    "a" (without-argument)ã§ã¯ =Reply-To:= ã‚„ =From:= ãªã©ã§
    æŒ‡å®šã•ã‚ŒãŸå”¯ä¸€äººã¾ãŸã¯å”¯ä¸€ã¤ã®æŠ•ç¨¿å…ˆã«è¿”ä¿¡.
    ã¾ãŸ, =X-ML-Name:= ã¨ =Reply-To:= ãŒã¤ã„ã¦ã„ã‚‹ãªã‚‰ =Reply-To:= å®›ã«è¿”ä¿¡
    #+begin_src emacs-lisp  :tangle init-wl.el
(setq wl-draft-reply-without-argument-list
      '((("X-ML-Name" "Reply-To") . (("Reply-To") nil nil))
        ("X-ML-Name" . (("To" "Cc") nil nil))
        ("Followup-To" . (nil nil ("Followup-To")))
        ("Newsgroups" . (nil nil ("Newsgroups")))
        ("Reply-To" . (("Reply-To") nil nil))
        ("Mail-Reply-To" . (("Mail-Reply-To") nil nil))
        ("From" . (("From") nil nil))))
    #+end_src
    =C-u a= (with-argument)ã§ã‚ã‚Œã°é–¢ä¿‚ã™ã‚‹å…¨ã¦ã®äººãƒ»æŠ•ç¨¿å…ˆã«è¿”ä¿¡
    #+begin_src emacs-lisp  :tangle init-wl.el
(setq wl-draft-reply-with-argument-list
      '(("Followup-To" . (("From") nil ("Followup-To")))
        ("Newsgroups" . (("From") nil ("Newsgroups")))
        ("Mail-Followup-To" . (("Mail-Followup-To") nil ("Newsgroups")))
        ("From" . (("From") ("To" "Cc") ("Newsgroups")))))
    #+end_src
    ã‚µãƒãƒªè¡¨ç¤ºã«ã¯ petname ã‚’ä½¿ã†ãŒ, å¼•ç”¨ã«ã¯ä½¿ã‚ãªã„
    #+begin_src emacs-lisp  :tangle init-wl.el
(setq wl-default-draft-cite-decorate-author nil)
    #+end_src
**** ãƒ¡ãƒ¼ãƒ«æœ¬æ–‡ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰
     ä¸¸å›²ã¿æ•°å­—ãªã‚“ã‹ãŒå…¥ã£ã¦ã—ã¾ã†ã¨
     å‹æ‰‹ã«ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãŒå¤‰ã‚ã£ã¦ã—ã¾ã£ã¦é¬±é™¶ã—ã„. ã©ã†ã—ãŸãƒ¢ãƒ³ã ã‚ã†ã‹ã­.
     #+begin_src emacs-lisp :tangle no
(add-hook 'wl-draft-mode-hook
          (lambda ()
            (add-to-list 'mime-charset-type-list '(utf-8 8 nil))))
     #+end_src
**** draft mode ã§ orgtbl ã‚’æœ‰åŠ¹ã«
     #+begin_src emacs-lisp  :tangle init-wl.el
(add-hook 'wl-draft-mode-hook 'turn-on-orgtbl)
     #+end_src
**** c-sig
     ç½²åã®é¸æŠã« c-sig ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹.
     è¨­å®šã¯ä»¥ä¸‹ã®é€šã‚Š. Mew é¢¨ã« =C-c <tab>= ã§ signature ã‚’æŒ¿å…¥ã™ã‚‹ã‚ˆã†ã«ã—ã¦ã„ã‚‹
     #+begin_src emacs-lisp  :tangle init-wl.el
(use-package c-sig
  :init
  :config
  (eval-when-compile (require 'wl))
  (setq sig-insert-end t
        sig-save-to-sig-name-alist nil
        message-signature-file nil)
  (define-key wl-draft-mode-map "\C-c\t" 'insert-signature-eref)
  (add-hook 'wl-draft-mode-hook
            '(lambda ()
               (define-key (current-local-map) "\C-c\C-w"
                 'insert-signature-eref)))
  )
     #+end_src
*** GPG ç½²å
    ä»¥å‰ã¯ mailcrypt ã‚’ä½¿ã£ã¦ã„ãŸã‘ã‚Œã©,
    epa ãŒã‚ã‚‹ã®ã§ä¸»ã«ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒ‰ã®è¨­å®šã®ã¿.
    =draft-mode= ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’ã‚ã‚‰ã‹ã˜ã‚æŒ‡å®šã—ã¦ãŠã‹ãªã„ã¨,
    é€ä¿¡æ™‚ã«æ–‡å­—ã‚³ãƒ¼ãƒ‰ãŒå¤‰æ›ã•ã‚Œã‚‹ã®ã§ä¸æ­£ãªç½²åã¨ãªã£ã¦ã—ã¾ã†.

    ã‚‚ã£ã¨ã†ã¾ã„æ–¹æ³•/æ­£æ”»æ³•ãŒã‚ã‚Šãã†ãªæ°—ãŒã™ã‚‹ã‘ã‚Œã©,
    ä½¿ãˆã¦ã‚‹ã‹ã‚‰, ã¾ã‚è‰¯ã„ã‹ãª, ã¨ã‹.
    #+begin_src emacs-lisp :tangle init-wl.el
(setq mime-pgp-verify-when-preview nil)
(defun my:epa-wl-decrypt-message ()
  (interactive)
  (save-window-excursion
    (wl-summary-jump-to-current-message)
    (wl-message-decrypt-pgp-nonmime)))
(defun my:epa-wl-verify-message ()
  (interactive)
  (save-selected-window
    (wl-summary-jump-to-current-message)
    (wl-message-verify-pgp-nonmime)))
(bind-keys :map wl-summary-mode-map
           ("C-c : d" . my:epa-wl-decrypt-message)
           ("C-c : v" . my:epa-wl-verify-message))
(bind-keys :map wl-draft-mode-map
           ("C-c : s" . epa-mail-sign)
           ("C-c : e" . epa-mail-encrypt))
    #+end_src
*** æ¤œç´¢
    notmuchã‚’ä½¿ã†.
    #+begin_src emacs-lisp  :tangle init-wl.el
(use-package elmo-search
  :bind (:map wl-summary-mode-map
              ("v" . wl-quicksearch-goto-search-folder-wrapper)
              :map wl-folder-mode-map
              ("v" . wl-quicksearch-goto-search-folder-wrapper))
  :config
  ;; (elmo-search-register-engine
  ;;  'mu-custom 'local-file
  ;;  :prog "mu"
  ;;  :args '("find" "-u" elmo-search-split-pattern-list
  ;;          "--fields" "l" "--sortfield" "date" "-r")
  ;;  :charset 'utf-8
  ;;  )
  (elmo-search-register-engine
   'notmuch-custom 'local-file
   :prog "notmuch-query-custom"
   :args '(elmo-search-split-pattern-list)
   :charset 'utf-8)
  (setq elmo-search-default-engine 'notmuch-custom)
  (setq wl-quicksearch-folder "[]")
  )
    #+end_src
    å®Ÿéš›ã®å‘¼ã³å‡ºã—ã¯ã‚¹ãƒ¬ãƒƒãƒ‰ã‚’å…¨éƒ¨å–å¾—ã—ãŸã„ã®ã§ä»¥ä¸‹ã‚’å‘¼ã³å‡ºã—ã¦ã„ã‚‹
    #+begin_src sh :tangle no
#!/bin/sh
if [ ! x"$*" = x"" ] ; then
    res=$(notmuch search --output=threads "$*")
fi
if [ ! x"$res" = x"" ] ; then
    echo $res | xargs notmuch search --sort=oldest-first --output=files
fi
    #+end_src
    æ¤œç´¢æ™‚ã«ãƒ¡ãƒ¼ãƒ«ãŒå¤šã™ãã‚‹ã¨æ€’ã‚‰ã‚Œã‚‹ã®ã§. æ•°å­—ã¯é©å½“.
    #+begin_src emacs-lisp  :tangle init-wl.el
(setq elmo-multi-divide-number 2000000000)
(setq elmo-multi-number 2000000000)
    #+end_src
** Linux Desktop ã§ =mailto:= ãƒªãƒ³ã‚¯ã‚’æ‰±ã†ãŸã‚ã«
   ã¤ã„ã§ã« =mailto= ã®ãƒªãƒ³ã‚¯ã‚’ emacsclient ã§æ‰±ã†ãŸã‚ã«ï¼Œä»¥ä¸‹ã®é–¢æ•°ã‚’å®šç¾©ã—ã¦ãŠã
   #+begin_src emacs-lisp
(defun my:mailto-compose-mail (mailto-url)
  (if (and (stringp mailto-url)
           (string-match "\\`mailto:" mailto-url))
      (progn
        (require 'rfc2368)
        (let* ((headers (mapcar (lambda (h) (cons (intern (car h)) (cdr h)))
                                (rfc2368-parse-mailto-url mailto-url)))
               (good-headers (remove-if (lambda (h) (member (car h) '(Body))) headers))
               (body (cdr (assoc 'Body headers))))
          (wl-draft good-headers nil nil body)))))
   #+end_src
   Desktop ã®è¨­å®šã§ã¯
   #+begin_src sh :tangle no
#!/bin/sh
# emacs-mailto-handler

mailto=$1
mailto="mailto:${mailto#mailto:}"
mailto=$(printf '%s\n' "$mailto" | sed -e 's/[\"]/\\&/g')
elisp_expr="(my:mailto-compose-mail \"$mailto\")"

emacsclient -a "" -n --eval "$elisp_expr" \
	        '(set-window-dedicated-p (selected-window) t)'
   #+end_src
   ã‚’ãƒ¡ãƒ¼ãƒ©ã¨ã—ã¦æŒ‡å®šã™ã‚Œã°è‰¯ã„ï¼
   GNOME ã¯ =.desktop= ãƒ•ã‚¡ã‚¤ãƒ«ãŒç„¡ã„ã¨ã€ŒãŠæ°—ã«å…¥ã‚Šã€ç™»éŒ²ãŒã§ããªã„ã®ã§
   ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é©å½“ãªåå‰ã§ =~/.local/share/applications/= ä»¥ä¸‹ã«æ”¾ã‚Šè¾¼ã‚“ã§ãŠãã¨è‰¯ã„ã ã‚ã†
   #+begin_src conf :tangle no
[Desktop Entry]
Name=Emacs Mail Handler
GenericName=Mail User Agent
X-GNOME-FullName=Emacs Mail Handler
Comment=Use emacsclient as MUA, handling mailto link
Keywords=email
Exec=/home/uwabami/bin/emacs-mailto-handler %U
Icon=emacs25
Terminal=false
Type=Application
Categories=GNOME;GTK;Office;Email;
StartupNotify=false
MimeType=application/mbox;message/rfc822;x-scheme-handler/mailto;
   #+end_src
** ãƒ¡ãƒ¼ãƒ«ã‹ã‚‰ã®äºˆå®šã®å–ã‚Šè¾¼ã¿: =mhc=
   #+begin_src emacs-lisp
(use-package mhc
  :if (file-directory-p (concat (getenv "HOME") "/.config/mhc"))
  :ensure t
  :config
  (setq mhc-calendar-day-strings ["æ—¥" "æœˆ" "ç«" "æ°´" "æœ¨" "é‡‘" "åœŸ"]
        mhc-calendar-header-function 'mhc-calendar-make-header-ja
        mhc-calendar-language 'japanese)
  )
   #+end_src
* ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼: =japanese-holidays=
  æ—¥æœ¬ã®ç¥æ—¥ã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚ã« =japanese-holidays= ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
  #+begin_src emacs-lisp
(use-package japanese-holidays
  :ensure t
  :init
  (add-hook 'calendar-today-visible-hook   'japanese-holiday-mark-weekend)
  (add-hook 'calendar-today-invisible-hook 'japanese-holiday-mark-weekend)
  (add-hook 'calendar-today-visible-hook   'calendar-mark-today)
  :config
  (setq calendar-holidays               ; ã¨ã‚Šã‚ãˆãšæ—¥æœ¬ã®ã¿ã‚’è¡¨ç¤º
        (append japanese-holidays holiday-local-holidays)
        mark-holidays-in-calendar t     ; ç¥æ—¥ã‚’ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã«è¡¨ç¤º
        calendar-month-name-array       ; æœˆã¨æ›œæ—¥ã®è¡¨ç¤ºèª¿æ•´
        ["01" "02" "03" "04" "05" "06" "07" "08" "09" "10" "11" "12" ]
        calendar-day-name-array
        ["æ—¥" "æœˆ" "ç«" "æ°´" "æœ¨" "é‡‘" "åœŸ"]
        calendar-day-header-array
        ["æ—¥" "æœˆ" "ç«" "æ°´" "æœ¨" "é‡‘" "åœŸ"]
        calendar-date-style 'iso         ; ISO format (YYYY/MM/DD) ã«å¤‰æ›´
        japanese-holiday-weekend '(0 6)  ; åœŸæ›œæ—¥ãƒ»æ—¥æ›œæ—¥ã‚’ç¥æ—¥ã¨ã—ã¦è¡¨ç¤º
        japanese-holiday-weekend-marker
        '(holiday nil nil nil nil nil japanese-holiday-saturday)
        ;; æ—¥æ›œé–‹å§‹
        calendar-week-start-day 0)
  (calendar-set-date-style 'iso)
  )
  #+end_src
* Org-mode
  =org-mode= ãŒç„¡ã„ã¨ç”Ÿãã¦ã„ã‘ãªã„ä½“ã«ãªã‚Šã¾ã—ãŸ
** åŸºæœ¬è¨­å®š: =org=
   ç›®æ–°ã—ã„è¨­å®šã¯ã—ã¦ã„ãªã„ï¼Œã¨æ€ã†ï¼å¼·ã„ã¦è¨€ãˆã°
   ä»¥å‰ã®ãƒ¡ãƒ¢ã®æ•´ç†ã®ãŸã‚ã« [[http://howm.osdn.jp/index-j.html][howm: Hitori Otegaru Wiki Modoki]] ã‚‚ä½¿ã£ã¦ã„ãŸã®ã§,
   howm ã‚‚æœ‰åŠ¹ã«ã—ã¦ã„ã‚‹ï¼Œãã‚‰ã„ï¼
   #+begin_src emacs-lisp
(defvar my:d:org (concat (getenv "HOME") "/Nextcloud/org/"))
(use-package org
  :bind (("C-x n s" . org-narrow-to-subtree)
         ("C-x n w" . widen))
  :init
  (with-eval-after-load "org"
    (setq org-file-apps-defaults '((remote . emacs)  ;; xdg-open ä»»ã›
                                   (system . "xdg-open %s")
                                   (t      . "xdg-open %s")))
    (setq org-file-apps-defaults-gnu '((remote . emacs)  ;; xdg-open ä»»ã›
                                       (system . "xdg-open %s")
                                       (t      . "xdg-open %s")))
    )
  :config
  (setq org-directory my:d:org                 ;; Nextcloud ã«ä¿å­˜ã™ã‚‹
        org-return-follows-link t              ;; return ã§ãƒªãƒ³ã‚¯ã‚’è¾¿ã‚‹
        org-startup-folded t                   ;; è¦‹å‡ºã—ã‚’ç•³ã‚“ã§è¡¨ç¤º
        org-startup-truncated t                ;; æŠ˜ã‚Šè¿”ã—ç„¡ã—
        org-emphasis-alist                     ;; åŸºæœ¬ "-nw" ãªã®ã§è‰²å¤‰æ›´
        (cons '("+" '(:strike-through t :foreground "#999999"))
              (cl-delete "+" org-emphasis-alist :key 'car :test 'equal))
        org-completion-use-ido t
        ;; GTD: çŠ¶æ…‹ã®è¿½åŠ 
        org-todo-keywords
        '((sequence "TODO(t)" "WAIT(w)" "|" "DONE(d)" "CANCEL(c)" "SOMEDAY(s)")
          (type "ARTICLE(a)")
          (type "MEMO(m)")
          )
        ;; GTD: ã‚¿ã‚°ã®è¿½åŠ 
        org-tag-alist '(("OFFICE"     . ?o)
                        ("HOME"       . ?h)
                        ("MAIL"       . ?m)
                        ("WORK"       . ?w)
                        ("Debian"     . ?d)
                        ("Computer"   . ?c)
                        ("Book"       . ?b)
                        ("Emacs"      . ?e)
                        ("TeX"        . ?t)
                        ("Ruby"       . ?r)
                        )
        )
  ;; GTD: TODOâ†’...â†’DONE ã¨ã—ãŸã‚¨ãƒ³ãƒˆãƒªã‚’ =Arhive.org= ã«ç§»å‹•
  (defun my:org-archive-done-tasks ()
    (interactive)
    (org-map-entries 'org-archive-subtree "/DONE" 'file))
  (setq org-archive-location "Archive.org::")
  (add-hook 'org-todo-statistics-hook 'my:org-archive-done-tasks)
  (add-hook 'org-todo-after-statistics-hook 'my:org-archive-done-tasks)
  ;; æ–‡å­—ã‚³ãƒ¼ãƒ‰å¼·åˆ¶ ... ä»Šæ™‚ã„ã‚‰ãªã„ã‹ã‚‚ï¼
  (modify-coding-system-alist 'file "\\.org\\'" 'utf-8)
  ;; howm ãƒ•ã‚¡ã‚¤ãƒ«ã‚‚ org-mode ã§ï¼
  (add-to-list 'auto-mode-alist '("\\.org$" . org-mode))
  (add-to-list 'auto-mode-alist '("\\.howm$" . org-mode))
  ;;; timestamp æ›´æ–°æ–‡å­—åˆ—ã®å¤‰æ›´
  ;;  org-mode ã§ã¯ ï¼ƒ+DATE: ã‚’ã²ã£ã‹ã‘ã‚‹ç”¨ã«(ï¼ƒã¯å°æ–‡å­—)ï¼
  (defun my:org-timestamp-hook ()
    "Change `time-stamp-start' in org-mode"
    (set (make-local-variable 'time-stamp-start) "#\\+date: 2")
    (set (make-local-variable 'time-stamp-end)   "\$")
    )
  (add-hook 'org-mode-hook 'my:org-timestamp-hook)
  )
   #+end_src
** Org-Id
   #+BEGIN_SRC emacs-lisp
(use-package org-id
  :config
  (setq org-id-locations-file (concat my:d:share "org-id-locations"))
  )
   #+END_SRC
** Babel
   #+begin_src emacs-lisp
(use-package org-src
  :config
  (setq org-src-fontify-natively t       ;; font-lock
        org-src-tab-acts-natively t      ;; indent
        org-edit-src-content-indentation 0
        org-src-preserve-indentation t
        )
  )
   #+end_src
** Agenda: ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ŒTODO è¡¨ç¤º
   GTD ç”¨ã®è¨­å®šï¼å¾Œè¿°ã® =org-gcal= ã¨ =orgmine= ã§å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚‚è¡¨ç¤ºã—ã¦ã„ã‚‹ï¼
   ã¤ã„ã§ã«
   - åœŸæ›œæ—¥ã‚’ã® face ã‚’è¿½åŠ .
   - ç¥æ—¥, ä¼‘æ—¥ã‚’æ—¥æ›œã¨åŒã˜faceã«ã™ã‚‹.
   ãªã‚“ã¦äº‹ã‚‚ã‚„ã£ã¦ã„ã‚‹ï¼å…ƒãƒã‚¿ã¯ [[https://julien.danjou.info/blog/2010/org-mode-and-holidays][Org-mode and holidays]]
   #+begin_src emacs-lisp
(use-package org-agenda
  :bind (("C-c a" . org-agenda))
  :init
  (defface my:org-agenda-date-saturday
    '((t (:foreground "#7FBFFF" :bold t )))
    "Agenda è¡¨ç¤ºä¸­ã®åœŸæ›œæ—¥ç”¨ã®face")
  (defface my:org-agenda-date-today-saturday
    '((t (:inherit my:org-agenda-date-saturday :underline t)))
    "Agenda è¡¨ç¤ºä¸­ã®ä»Šæ—¥ã‹ã¤åœŸæ›œæ—¥ç”¨ã®face")
  (defface my:org-agenda-date-today-weekend
    '((t (:inherit org-agenda-date-weekend :underline t)))
    "Agenda è¡¨ç¤ºä¸­ã®ä»Šæ—¥ã‹ã¤æ—¥ãƒ»ç¥æ—¥ç”¨ã®face")
  ;; ã“ã£ã‹ã‚‰ã¯ org-gcal ã§åŒæœŸã—ãŸã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã®è‰²
  (defface my:org-agenda-calendar-KUSM
    '((t (:foreground "#7FFF7F")))
    "Agenda è¡¨ç¤ºä¸­, KUSM.org ã®è¡¨ç¤º face"
    :group 'org-agenda )
  (defface my:org-agenda-calendar-Schedule
    '((t (:foreground "#7FFFFF")))
    "Agenda è¡¨ç¤ºä¸­, Schedule.org ã®è¡¨ç¤º face"
    :group 'org-agenda )
  (defface my:org-agenda-calendar-GFD
    '((t (:foreground "#FFFF7F")))
    "Agenda è¡¨ç¤ºä¸­, GFD.org ã®è¡¨ç¤º face"
    :group 'org-agenda )
  (defface my:org-agenda-calendar-DebianJP
    '((t (:foreground "#BF7FFF")))
    "Agenda è¡¨ç¤ºä¸­, DebianJP.org ã®è¡¨ç¤º face"
    :group 'org-agenda )
  (defface my:org-agenda-calendar-twitter
    '((t (:foreground "#CCCCCC")))
    "Agenda è¡¨ç¤ºä¸­, Twitter log ã®è¡¨ç¤º face"
    :group 'org-agenda )
  ;; æ›´æ–°ç”¨ã®é–¢æ•° - ã¨ã‚Šã‚ãˆãšå‹•ã„ã¦ã„ã‚‹ã®ã§è‰¯ã—ã¨ã™ã‚‹ãŒï¼Œãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã—ãŸã„
  (defun my:org-agenda-day-face-function (date)
    "Compute DATE face for saturday, holidays."
    (cl-dolist (file (org-agenda-files nil 'ifmode))
      (cond
       ((member (calendar-day-of-week date) '(7))
        (if (org-agenda-todayp date)
            (cl-return 'my:org-agenda-date-today-weekend))
        (cl-return 'org-agenda-date-weekend))
       ((member (calendar-day-of-week date) '(6))
        (if (org-agenda-todayp date)
            (cl-return 'my:org-agenda-date-today-saturday))
        (cl-return 'my:org-agenda-date-saturday)))
      (let ((face
             (cl-dolist (entry (org-agenda-get-day-entries file date))
               (let ((category (with-temp-buffer
                                 (insert entry)
                                 (org-get-category (point-min)))))
                 (when (or (string= "ç¥æ—¥" category)
                           (string= "ä¼‘æ—¥" category))
                   (if (org-agenda-todayp date)
                       (cl-return 'my:org-agenda-date-today-weekend)
                     (cl-return 'org-agenda-date-weekend)))))))
        (when face (cl-return face)))))
  :config
  ;; ä½¿ç”¨ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«
  (dolist (file
           '("Archive.org"
             "Holidays.org"
             "Memo.org"
             "Schedule.org"
             "MHC.org"
             "GFD.org"
             "KUSM.org"
             "DebianJP.org"
             "twitter.org"
             "journal.org"
             "Wunderlist.org"
             "redmine_GFD.org"
             "redmine_FluidSoc.org"
             "redmine_KUSM.org"
             ))
    (add-to-list 'org-agenda-files (concat my:d:org file)))
  (add-to-list 'org-agenda-files (locate-user-emacs-file "README.org"))
  ;; è¡¨ç¤ºã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º
  (setq org-agenda-span 'day                   ;; day or week
        org-agenda-format-date "%Y/%m/%d (%a)" ;; YY/MM/DD (æ›œ)
        org-agenda-weekend-days '(0)           ;; æ—¥æ›œå§‹ã¾ã‚Š
        ;; è¡¨ç¤ºé–¢æ•°
        org-agenda-day-face-function 'my:org-agenda-day-face-function
        org-agenda-custom-commands             ;; GTD ç”¨ã®è¨­å®š
        '(
          ("n" "agenda and all TODO list"
           (
            (agenda ""
                    ((org-agenda-ndays 1)
                     (org-agenda-entry-types '(:timestamp :sexp))))
            (todo "TODO"
                  ((org-agenda-prefix-format " %i %-22:c"))
                  )
            (todo "æ–°è¦|ç€æ‰‹|é€²è¡Œä¸­|ç¢ºèª"
                  ((org-agenda-prefix-format " %i %-22:c"))
                  )
            (todo "WAIT"
                  ((org-agenda-prefix-format " %i %-22:c"))
                  )
            (todo "SOMEDAY"
                  ((org-agenda-prefix-format " %i %-22:c"))
                  )
            ))
          ("N" "All memo entry"
           (;;
            (todo "MEMO")
            ))
          )
        )
  ;; è‰²ä»˜ã‘
  (add-hook 'org-agenda-finalize-hook
            (lambda ()
              (save-excursion
                (goto-char (point-min))
                (while (re-search-forward "KUSM:" nil t)
                  (add-text-properties (match-beginning 0) (point-at-eol)
                                       '(face my:org-agenda-calendar-KUSM)))
                (goto-char (point-min))
                (while (re-search-forward "Schedule:" nil t)
                  (add-text-properties (match-beginning 0) (point-at-eol)
                                       '(face my:org-agenda-calendar-Schedule)))
                (goto-char (point-min))
                (while (re-search-forward "MHC:" nil t)
                  (add-text-properties (match-beginning 0) (point-at-eol)
                                       '(face my:org-agenda-calendar-Schedule)))
                (goto-char (point-min))
                (while (re-search-forward "DebianJP:" nil t)
                  (add-text-properties (match-beginning 0) (point-at-eol)
                                       '(face my:org-agenda-calendar-DebianJP)))
                (goto-char (point-min))
                (while (re-search-forward "GFD:" nil t)
                  (add-text-properties (match-beginning 0) (point-at-eol)
                                       '(face my:org-agenda-calendar-GFD)))
                (goto-char (point-min))
                (while (re-search-forward "twitter:" nil t)
                  (add-text-properties (match-beginning 0) (point-at-eol)
                                       '(face my:org-agenda-calendar-twitter)))
                (goto-char (point-min))
                (while (re-search-forward "èª•ç”Ÿæ—¥:" nil t)
                  (add-text-properties (match-beginning 0) (point-at-eol)
                                       '(face org-agenda-date-weekend)))
                (goto-char (point-min))
                (while (re-search-forward "ç¥æ—¥:" nil t)
                  (add-text-properties (match-beginning 0) (point-at-eol)
                                       '(face org-agenda-date-weekend)))
                (goto-char (point-min))
                (while (re-search-forward "ä¼‘æ—¥:" nil t)
                  (add-text-properties (match-beginning 0) (point-at-eol)
                                       '(face org-agenda-date-weekend)))
                )))
  )
   #+end_src
** Org-journal: æ—¥è¨˜
   å˜ä¸€ãƒ•ã‚¡ã‚¤ãƒ«ã«è¨˜è¿°ã™ã‚‹ã“ã¨, ãŠã‚ˆã³
   ã‚¨ãƒ³ãƒˆãƒªä½œæˆæ™‚ã«æ—¥ä»˜ã‚’å…¥ã‚Œã‚‹ãŸã‚ã« =org-jounnal-new-entry= ã‚’ =advice= ã—ã¦ã„ã‚‹
   #+BEGIN_SRC emacs-lisp
(use-package org-journal
  :if (and (file-directory-p my:d:org)
           (>= emacs-major-version 25))
  :ensure t
  :after (org)
  :init
  (add-hook 'org-journal-mode-hook
            (setq truncate-lines t))
  :config
  (unbind-key "C-c C-j" org-journal-mode-map)
  (bind-key   "C-c C-j" 'browse-url-at-point)
  (setq org-journal-dir my:d:org
        org-journal-file-format "journal.org"
        org-journal-date-format "%x (%a)"
        org-journal-date-prefix "* "
        org-journal-time-format "<%Y-%m-%d %R> "
        org-journal-time-prefix "** MEMO "
        org-journal-find-file 'find-file
        )
  (defun my:org-journal-add-date-entry (prefix &optional time)
    "Insert date entry to `org-journal-file'"
    (find-file (expand-file-name org-journal-file-format org-journal-dir))
    (org-journal-decrypt)
    (unless
        (string-match (format-time-string org-journal-date-format)
                      (buffer-substring-no-properties (point-min) (point-max)))
      (progn
        (goto-char (point-max))
        (insert (concat "\n" org-journal-date-prefix
                        (format-time-string org-journal-date-format)))
        ))
    )
  (advice-add 'org-journal-new-entry :before 'my:org-journal-add-date-entry)
  )
;; Key bindings -- ä½¿ãˆã¦ãªã„...
;; (define-key org-journal-mode-map (kbd "C-c C-f") 'org-journal-open-next-entry)
;; (define-key org-journal-mode-map (kbd "C-c C-b") 'org-journal-open-previous-entry)
;; (define-key org-journal-mode-map (kbd "C-c C-j") 'org-journal-new-entry)
;; (define-key calendar-mode-map "j" 'org-journal-read-entry)
;; (define-key calendar-mode-map (kbd "C-j") 'org-journal-display-entry)
;; (define-key calendar-mode-map "]" 'org-journal-next-entry)
;; (define-key calendar-mode-map "[" 'org-journal-previous-entry)
;; (define-key calendar-mode-map (kbd "i j") 'org-journal-new-date-entry)
;; (define-key calendar-mode-map (kbd "f f") 'org-journal-search-forever)
;; (define-key calendar-mode-map (kbd "f w") 'org-journal-search-calendar-week)
;; (define-key calendar-mode-map (kbd "f m") 'org-journal-search-calendar-month)
;; (define-key calendar-mode-map (kbd "f y") 'org-journal-search-calendar-year)))
   #+END_SRC
** Capture: ãƒ¡ãƒ¢å–ã‚Š
   ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒ‰ã¯ä»¥å‰ changelog memo ã‚’ã‚„ã£ã¦ã„ãŸæ™‚ã®ç™–ã§ =C-x m= ã‚’ãƒ¡ãƒ¢ã«ã—ã¦ã„ã‚‹.
   ä»–ã«ã¯ wanderlust ã®ãƒ¡ãƒ¼ãƒ«ã‚’æ‰±ãˆã‚‹ã‚ˆã†ã« =org-wl= ã‚’èª­ã¿è¾¼ã‚“ã§ template ã‚’è¿½åŠ ã—ãŸãã‚‰ã„.
   notmuch ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®æ–¹ãŒè‰¯ã„ã‹ã‚‚ã—ã‚Œãªã„, ã¨æœ€è¿‘æ€ã£ã¦ã„ã‚‹.
   #+BEGIN_SRC emacs-lisp
(use-package org-wl
  :if (and (or (my:dpkg-status "wl-beta")
               (my:dpkg-status "wl"))
           (file-directory-p my:d:org))
  :quelpa (org-wl
           :fetcher url
           :url "https://code.orgmode.org/bzg/org-mode/raw/master/contrib/lisp/org-wl.el")
  )
(use-package org-capture
  :bind (("C-x m" . org-capture))
  :if (file-directory-p my:d:org)
  :config
  (defun my:org-journal-add-date-entry-capture ()
    (my:org-journal-add-date-entry nil)
    (goto-char (point-max))
    )
  ;; @see https://github.com/sprig/org-capture-extension/issues/37
  ;; Brackets '{' '}' in link description cause broken org-mode link #37]]
  (defun my:transform-square-brackets-to-round-ones (string-to-transform)
    "Transforms [ into ( and ] into ), other chars left unchanged."
    (concat
     (mapcar #'(lambda (c) (if (equal c ?\[) ?\( (if (equal c ?\]) ?\) c)))
             string-to-transform))
    )
  (setq org-default-notes-file (concat my:d:org "journal.org")
        org-capture-templates
        `(
          ("t" "TODO" plain
           (function my:org-journal-add-date-entry-capture)
           "** TODO %^{title} %^g\n  %?\n  %a"
           :prepend nil
           :unnarrowed nil
           :kill-buffer t
           )
          ;; "* TODO <%<%Y-%m-%d>> %:subject %^g\n  %?\n  %a\n  #+BEGIN_QUOTE\n%i\n  #+END_QUOTE"
          ("e" "Email TODO" plain
           (function my:org-journal-add-date-entry-capture)
           "** TODO [[wl:\%5Bmsgid:%:message-id-no-brackets\%5D][%(my:transform-square-brackets-to-round-ones \"%:subject\")]]\n  :PROPERTIES:\n  :CREATED: %u\n  :END:%?\n"
           :prepend nil
           :unnarrowed nil
           :kill-buffer t
           )
          ("m" "Memo/Journal Entry" plain
           (function my:org-journal-add-date-entry-capture)
           "** MEMO %T %?"
           :prepend nil
           :unnarrowed nil
           :kill-buffer t
           )
          ("a" "Aritcle Entry" plain
           (function my:org-journal-add-date-entry-capture)
           "** ARTICLE %T %? "
           :prepend nil
           :unnarrowed nil
           :kill-buffer t
           )
          )
        )
  )
   #+END_SRC
** Orgã¨Google ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã®é€£æº: =org-gcal=
*** token ç­‰ã®ç½®ãå ´æ‰€ã®å¤‰æ›´
    #+begin_src emacs-lisp
(use-package request
  :ensure t
  :init
  (setq request-storage-directory (concat my:d:tmp "request"))
  (unless (file-directory-p request-storage-directory)
    (make-directory request-storage-directory)))
    #+end_src
*** org-gcal æœ¬ä½“ã®è¨­å®š
    å®Ÿéš›ã®æƒ…å ±ç­‰ã¯ =password-store= ã‚’ä½¿ã£ã¦è¨­å®šã—ã¦ãŠã.
    ã¤ã„ã§ã« agenda è¡¨ç¤ºã®éš›ã®è‰²ä»˜ã‘ã‚’è¨­å®šï¼
    #+begin_src emacs-lisp
(use-package org-gcal
  :if (and my:d:password-store
           (file-directory-p my:d:org))
  :no-require t
  :ensure t
  :init
  (setq org-gcal-dir (concat my:d:tmp "org-gcal"))
  (unless org-gcal-dir (make-directory org-gcal-dir))
  (setq org-gcal-token-file (expand-file-name ".org-gcal-token" org-gcal-dir)
        alert-log-messages t
        alert-default-style 'log
        org-gcal-down-days   90  ;; éå» 3 month
        org-gcal-up-days    180  ;; æœªæ¥ 6 month
        org-gcal-auto-archive nil)
  (with-eval-after-load "org-gcal"
    (if (file-directory-p my:d:password-store)
        (load (concat my:d:password-store "/org-gcal.gpg"))))
  )
    #+end_src
    password-store ã«ã¯ multiline ã§è¨­å®šã‚’æ›¸ãï¼ä¾‹ãˆã°ä»¥ä¸‹:
    #+begin_src emacs-lisp :tangle no
(setq org-gcal-client-id "XXXXXXXXXXX"
      org-gcal-client-secret "XXXXXXXXXXX"
      org-gcal-file-alist
      '(("XXXXX@gmail.com" . "~/org/Schedule.org")
        ("YYYYY@group.calendar.google.com" . "~/org/Project1.org")))
    #+end_src
** Orgã¨Redmine ã®é€£æº: =orgmine=
   ç´ æ™´ã—ã„!!
   [[https://github.com/kametoku/orgmine][kametoku/orgmine: Emacs minor mode for org-mode with redmine integration]]
   #+begin_src emacs-lisp
(use-package orgmine
  :if  (and my:d:password-store
            (file-directory-p my:d:org))
  :no-require t
  :commands (orgmine-mode)
  :quelpa (orgmine
           :fetcher github
           :repo "kametoku/orgmine")
  :init
  (add-to-list 'safe-local-variable-values
               '(orgmine-note-block-begin . "#+begin_src textile"))
  (add-to-list 'safe-local-variable-values
               '(orgmine-note-block-begin . "#+BEGIN_SRC textile"))
  (use-package elmine :ensure t)
  ;; (add-to-list 'safe-local-variable-values
  ;;              '(orgmine-note-block-begin . "#+begin_src textile"))
  (add-hook 'org-mode-hook
            (lambda ()
              (if (assoc "om_server" org-file-properties) (orgmine-mode))))
  ;; ã‚µãƒ¼ãƒè¨­å®š
  (with-eval-after-load "orgmine"
    (if (file-directory-p my:d:password-store)
        (load (concat my:d:password-store "/orgmine.gpg"))))
  :config
  (setq orgmine-note-block-begin "#+begin_src gfm"   ;; è¦èª¿æ•´
        orgmine-note-block-end   "#+end_src\n"
        orgmine-default-todo-keyword "æ–°è¦")
  )
   #+end_src
** Org-Wiki
   è¨ˆç®—æ©Ÿé–¢é€£ã®ãƒ¡ãƒ¢ã¯ [[https://github.com/uwabami/org-wiki][uwabami/org-wiki]] ã§æ›¸ã„ã¦ã„ã¾ã™ï¼å…ƒã€…ã¯
   [[https://github.com/caiorss/org-wiki][caiorss/org-wiki]] ã‚’ä½¿ã£ã¦ã„ãŸã®ã§ã™ãŒ helm ä¾å­˜ã®éƒ¨åˆ†ã‚’ ido ã«æ›¸ãæ›
   ãˆã¦ã¾ã™.
   #+begin_src emacs-lisp
(use-package org-wiki
  :if (file-directory-p "~/Public/cc-env")
  :no-require t
  :commands (org-wiki)
  :quelpa (org-wiki
           :fetcher github
           :repo "uwabami/org-wiki")
  :bind (("C-x M" . org-wiki ))
  :config
  (setq org-wiki-location "~/Public/cc-env"
        org-wikitemplate "#+TITLE:
,#+DATE: 20
,#+LANGUAGE: ja
,#+REF: cc-env/%n
,#+LAYOUT: default
,#+PERMALINK: /cc-env/%n.html
Related [[wiki:index][Index]]
"))
   #+end_src
* Howm
  Org ã‚’ä½¿ã†å‰ã¯ Howm ã‚’ä½¿ã£ã¦ã„ã¾ã—ãŸ.
  éå»ã®ãƒ¡ãƒ¢ã‚’æ¤œç´¢ã™ã‚‹ãŸã‚ã ã‘ã«æœªã ã« Howm ã‚’ä½¿ã£ã¦ã„ã¾ã™.
  #+BEGIN_SRC emacs-lisp
(use-package howm
  :if (and (my:dpkg-status "howm")
           (executable-find "ag"))
  :no-require t
  :after (org)
  :commands (howm-menu)
  :bind (:map howm-mode-map
              ("C-c , ,"     . howm-menu)
              ("C-c C-c"     . nil)
              ("C-x C-z C-c" . howm-save-and-kill-buffer/screen))
  :init
  (add-hook 'howm-menu-hook (lambda ()
                              (setq truncate-lines t)))
  :config
  ;;; ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®è¨­å®š
  ;; ãƒ¡ãƒ¢ã®å†…å®¹ã¯ Nextcloud ã§åŒæœŸã™ã‚‹ã“ã¨ã«
  (setq howm-directory "~/Nextcloud/org")
  ;; ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã¨å±¥æ­´ã‚’æ¤œç´¢å¯¾è±¡ã‹ã‚‰é™¤å¤–ã™ã‚‹ãŸã‚ã«åˆ¥ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¸
  (setq howm-keyword-file "~/Nextcloud/howm/keys"
        howm-history-file "~/Nextcloud/howm/history"
        howm-menu-file "~/Nextcloud/howm/menu")
  ;; ãƒ¡ãƒ¢ãƒ•ã‚¡ã‚¤ãƒ«ã¯æ—¥ä»˜æ™‚åˆ»æ¯ã«åˆ†é›¢
  (setq howm-file-name-format "%Y%m%d-%H%M%S.howm")
  ;;;  ãƒ¡ãƒ¢ã¯orgã§æ›¸ã
  ;; - org-mode ã® hook ã¨ã—ã¦ howm-mode ã‚’ç™»éŒ²
  ;; - C-c ãŒ org ã«å–ã‚‰ã‚Œã‚‹ã®ã§, howm ã® prefix ã¯ C-xC-z ã«
  (add-hook 'org-mode-hook 'howm-mode)
  (global-unset-key (kbd "C-x C-z"))
  (setq howm-prefix (kbd "C-x C-z"))
  ;; title header ã¯ "*"
  (setq howm-view-title-header "*")
  ;; :config
  ;; (use-package "elscreen-howm")
  ;; è‰²ä»˜ã‘ã¯ org-mode ä»»ã›: howm ã® font-lock ã‚’ç„¡åŠ¹åŒ–
  (setq howm-use-color nil)
  ;;; ä»¥ä¸‹ï¼Œæ±ºã¾ã‚Šæ–‡å¥
  ;; æ¤œç´¢ã§å¤§æ–‡å­—å°æ–‡å­—ã‚’åŒºåˆ¥ã—ãªã„
  (setq howm-keyword-case-fold-search t)
  ;; grep ã® ä»£ã‚ã‚Šã« ag ã‚’ä½¿ã†
  (setq howm-view-use-grep t
        howm-view-grep-command "ag"
        howm-view-grep-option "--nocolor --nogroup"
        howm-view-grep-extended-option nil
        howm-view-grep-fixed-option "-F"
        howm-view-grep-expr-option nil
        howm-view-grep-file-stdin-option nil)
  (defun my:howm:add-dev-null (args)
    (let ((str   (car args))               ;; æ¤œç´¢æ–‡å­—åˆ—
          (files (nth 1 args)))            ;; ãƒ•ã‚¡ã‚¤ãƒ«ãƒªã‚¹ãƒˆ
      (when (= 1 (length files))           ;; å˜ä¸€ãƒ•ã‚¡ã‚¤ãƒ«ï¼Ÿ
        (if (file-regular-p (car files))   ;; é€šå¸¸ãƒ•ã‚¡ã‚¤ãƒ«ï¼Ÿ
            ;; å˜ä¸€ã®é€šå¸¸ãƒ•ã‚¡ã‚¤ãƒ«ãŒæŒ‡å®šã•ã‚ŒãŸå ´åˆã« /dev/null ã‚’è¿½åŠ 
            (setq files (append files '("/dev/null")))))
      (list str files)))
  (advice-add 'howm-real-grep-single :filter-args #'my:howm:add-dev-null)
  ;; æ¤œç´¢å¯¾è±¡ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®è¿½åŠ ...ã¨ã‚Šã‚ãˆãšè¿½åŠ ã—ãªã„ã“ã¨ã«ï¼
  (setq howm-search-other-dir nil)
  ;; æ¤œç´¢å¯¾è±¡å¤–ã®ãƒ•ã‚¡ã‚¤ãƒ«: ad hoc ã«ã©ã‚“ã©ã‚“å¢—ãˆã¦ã„ããªã...
  (setq howm-excluded-file-regexp
        "/\\.#\\|[~#]$\\|\\.bak$\\|/CVS/\\|\\.doc\\|\\.pdf\\|\\.txt$\\|\\.html$\\|\\.tex$\\|\\.dvi$\\|\\.fdb_latexmk$\\|\\.ppt$\\|\\.xls$\\|\\.howm-menu$\\|.howm-keys$\\|\\.png$\\|\\.gif$\\|\\.tif$\\|\\.tiff$\\|\\.jpg$\\|\\.jpeg$\\|\\.el$\\|\\.aux$\\|\\.log$\\|Makefile\\|\\.txt$\\|EUC-UCS2\\|\\.fdb_latexmk$\\|latexmkrc\\|\\.gpg$\\|\\.org$")
  ;; org-mode ã®æ—¥ä»˜æ¤œç´¢ç”¨
  (setq howm-reminder-regexp-grep-format
        (concat "<" howm-date-regexp-grep "[ :0-9]*>%s"))
  (setq howm-reminder-regexp-format
        (concat "\\(<" howm-date-regexp "[ :0-9]*>\\)\\(\\(%s\\)\\([0-9]*\\)\\)"))
  ;;; è¡¨ç¤ºè¨­å®š
  (setq howm-menu-top nil
        howm-menu-lang 'ja)
  ;; ä¸€è¦§ã«ã‚¿ã‚¤ãƒˆãƒ«è¡¨ç¤ºã—ãªã„
  (setq howm-list-title nil)
  ;; save æ™‚ã«ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’æ›´æ–°ã—ãªã„
  (setq howm-menu-refresh-after-save nil)
  (setq howm-refresh-after-save nil)
  ;; æ–°è¦ãƒ¡ãƒ¢ã‚’ä¸Šã«
  (setq howm-prepend t)
  ;; å…¨ãƒ¡ãƒ¢ä¸€è¦§æ™‚ã«ã‚¿ã‚¤ãƒˆãƒ«è¡¨ç¤º
  (setq howm-list-all-title t)
  ;; ã€Œæœ€è¿‘ã®ãƒ¡ãƒ¢ã€ä¸€è¦§æ™‚ã«ã‚¿ã‚¤ãƒˆãƒ«è¡¨ç¤º
  (setq howm-list-recent-title t)
  ;; ã€Œæœ€è¿‘ã®ãƒ¡ãƒ¢ã€ã®è¡¨ç¤ºä»¶æ•°
  (setq howm-menu-recent-num 15)
  ;; ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’ 2 æ™‚é–“ã‚­ãƒ£ãƒƒã‚·ãƒ¥
  (setq howm-menu-expiry-hours 2)
  ;; RET ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ãéš›, ä¸€è¦§ãƒãƒƒãƒ•ã‚¡ã‚’æ¶ˆã™. C-u RET ãªã‚‰æ®‹ã‚‹
  (setq howm-view-summary-persistent nil)
  ;;; ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¡¨ç¤ºç”¨ã®é–¢æ•°å®šç¾©
  ;; æ­£è¦è¡¨ç¾ã§æ¤œç´¢, é€†é †,  è¡¨ç¤ºä»¶æ•°ã¯ =howm-menu-recent-num=, ã¨ã„ã† ad hoc ãªé–¢æ•°
  (defun my:howm-menu-search (key &optional formatter regexp-p)
    "Embed search result of KEY into menu, reverse-order, howm-menu-recent-num"
    (let ((fixed-p (not regexp-p)))
      (howm-menu-general "menu-search"
                         formatter
                         (howm-first-n
                          (howm-sort-items-by-reverse-date
                           (howm-view-search-folder-items key (howm-folder) nil fixed-p)
                           ) howm-menu-recent-num)
                         )))
  (setq howm-menu-allow
        (append '(my:howm-menu-search) howm-menu-allow))
  ;; ç·¨é›†ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®
  (setq howm-dtime-format (concat "<" howm-dtime-body-format ">")
        howm-insert-date-format "<%s>"
        howm-template-date-format "<%Y-%m-%d %a %H:%M:%S>"
        howm-template-file-format "==>%s"
        howm-template "* MEMO %date %cursor\n%file\n"
        howm-reminder-today-format (format howm-insert-date-format howm-date-format))
  )
  #+END_SRC
* VCS
** git-commit
   #+BEGIN_SRC emacs-lisp
(use-package git-commit
  :if (>= emacs-major-version 25)
  :ensure t)
   #+END_SRC
** git{attributes,config,ignore}-mode
   #+BEGIN_SRC emacs-lisp
(use-package gitattributes-mode :if (>= emacs-major-version 25) :ensure t)
(use-package gitconfig-mode :if (>= emacs-major-version 25) :ensure t)
(use-package gitignore-mode :if (>= emacs-major-version 25) :ensure t)
   #+END_SRC
** magit:
   magit ã¯ Emacs ã® Git Frontend.
   çµå±€ã®æ‰€ CUI ã§ã‚³ãƒãƒ³ãƒ‰å©ãäº‹ã‚‚å¤šã„ã‘ã‚Œã©ï¼Œã“ã‚Œã¯ã“ã‚Œã§é‡å®ã—ã¦ã„ã‚‹ï¼
   #+BEGIN_SRC emacs-lisp
(use-package magit
  :bind (("C-x g" . magit-status))
  :ensure t
  :config
  (setq magit-completing-read-function 'magit-ido-completing-read
        magit-refs-show-commit-count 'all
        magit-log-buffer-file-locked t
        magit-revision-show-gravatars nil
        )
  )
   #+END_SRC
** Git Gutter+
   é£½ããŸã‚‰æ­¢ã‚ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ã‘ã‚Œã©.
   #+BEGIN_SRC emacs-lisp
(use-package git-gutter+
  :if (>= emacs-major-version 25)
  :ensure t
  :bind ("C-x G" . global-git-gutter+-mode)
  :config
  )
   #+END_SRC
** ãƒªãƒã‚¸ãƒˆãƒªã®ç§»å‹•: =ido-ghq=
   ghq list ã‚’ ido ã§é¸ã‚“ã§ dired ã§é–‹ã
   #+BEGIN_SRC emacs-lisp
(use-package ido-ghq
  :if (executable-find "ghq")
  :quelpa (ido-ghq
           :fetcher github
           :repo "uwabami/ido-ghq")
  :bind (("C-x f" . ido-ghq-open))
  :config
  (setq ido-ghq-short-list t)
  )
   #+END_SRC
* ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¯ã® coding rule ã®é©ç”¨: =editorconfig=
  #+BEGIN_SRC emacs-lisp
(use-package editorconfig
  :ensure t
  :diminish " âœ’"
  :config
  (editorconfig-mode 1)
  )
  #+END_SRC
* Syntax checker: =flycheck= [0/1]
  ä»¥å‰ã¯ flymake ã‚’åˆ©ç”¨ã—ã¦ã„ãŸã‘ã‚Œã©, æœ€è¿‘ã¯ flycheck ã‚’ä½¿ã£ã¦ã„ã‚‹.
  ã€Œãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§è‰¯ã„ã‚ˆã†ã«ã—ã¦ãã‚Œã‚‹ã€ç­ˆãªã‚“ã ã‘ã‚Œã©,
  ã€Œç—’ã„æ‰€ã«æ‰‹ãŒå±Šã‹ãªã„ã€ã¨ã„ã†ã‹, ãªã‚“ã¨ã„ã†ã‹...
  ã¾ã‚, default ã£ã¦ãã‚“ãªãƒ¢ãƒ³ã ã‚ˆãª.
  - [ ] autotools ãªã‚“ã‹ã ã¨ã©ã†ã™ã‚‹ã®ãŒç­‹ã‹ã—ã‚‰?
  ãã®ã†ã¡å«Œã«ãªã£ã¦ flymake ã«æˆ»ã™ã‹ã‚‚.
  #+BEGIN_SRC emacs-lisp
(use-package flycheck
  :ensure t
  :init
  ;; org-src ã§ã® emacs-lisp-checkdoc ã¯æ„å‘³ãŒç„¡ã„
  (defun my:disable-fylcheck-in-org-src-block ()
    "Disable emacs-lisp-checkdoc in org-src-block."
    (interactive)
    (setq-local flycheck-disabled-checkers '(emacs-lisp-checkdoc)))
  ;; projectile-project-root ã«åˆã‚ã›ã¦ include path ç­‰ã‚’è¿½åŠ ã—ã¦ã¿ã‚‹ãƒ†ã‚¹ãƒˆ
  ;; æœ¬å½“ã¯ .dir-local.el ã‚’ç”¨æ„ã™ã¹ãã‹ãª.
  :config
  (setq flycheck-emacs-lisp-package-user-dir package-user-dir
        flycheck-emacs-lisp-load-path 'inherit)
  (if (featurep 'org-src)
      (add-hook 'org-src-mode-hook #'my:disable-fylcheck-in-org-src-block))
  (if (executable-find "flycheck_chktex.sh")
      (setq flycheck-tex-chktex-executable "flycheck_chktex.sh"))
  (add-hook 'after-init-hook #'global-flycheck-mode)
  )
  #+END_SRC
  popup ã§è¡¨ç¤ºã•ã›ã‚‹ [[https://github.com/flycheck/flycheck-popup-tip][flycheck-popup-tip]] ã‚‚å…¥ã‚Œã¦ãŠã
  #+BEGIN_SRC emacs-lisp
(use-package flycheck-popup-tip
  :ensure t
  :config
  (with-eval-after-load 'flycheck
    (add-hook 'flycheck-mode-hook #'flycheck-popup-tip-mode))
  )
  #+END_SRC
  status ã‚’çµµæ–‡å­—ã§è¡¨ç¤º
  #+BEGIN_SRC emacs-lisp
(use-package flycheck-status-emoji
  :ensure t
  :config
  (setq flycheck-status-emoji-indicator-running          ?ğŸ”ƒ
        flycheck-status-emoji-indicator-finished-ok      ?âœ”
        flycheck-status-emoji-indicator-finished-error   ?âœ–
        flycheck-status-emoji-indicator-finished-warning ?âš 
        flycheck-status-emoji-indicator-finished-info    ?ğŸ’
        flycheck-status-emoji-indicator-not-checked      ?ğŸš¬
        flycheck-status-emoji-indicator-no-checker       ?ğŸ’¤
        flycheck-status-emoji-indicator-errored          ?âœ–
        flycheck-status-emoji-indicator-interrupted      ?ğŸ˜
        flycheck-status-emoji-indicator-suspicious       ?â“)
  (with-eval-after-load 'flycheck
    (flycheck-status-emoji-mode +1))
  )
  #+END_SRC
* TeX
** AUCTeX
   Debian ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç‰ˆã‚’ä½¿ã†ï¼
   ã‚„ã£ã¦ã„ã‚‹äº‹ã¯
   - japanese-latex-mode ã«ãŠã„ã¦, å¹¾ã¤ã‹ã®ã‚³ãƒãƒ³ãƒ‰ãŒè¿½åŠ /ä¸Šæ›¸ãã•ã‚Œã¦ã„ã‚‹ãŒï¼Œ ã‚ã¾ã‚Šä½¿ã†ã“ã¨ã®ç„¡ã„ã‚³ãƒãƒ³ãƒ‰ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã®ãŒå«Œãªã®ã§ãã‚Œã‚‰ã‚’å‰Šé™¤ï¼
   - ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã«ã¯ latexmk ã‚’ä½¿ã†
   ã¨è¨€ã£ãŸæ‰€.
   #+BEGIN_SRC emacs-lisp
(use-package tex-jp
  :if (and (executable-find "uplatex")
           (my:dpkg-status "auctex"))
  :init (progn
          (add-hook 'LaTeX-mode-hook #'TeX-source-correlate-mode)
          (add-hook 'LaTeX-mode-hook #'TeX-PDF-mode)
          (add-hook 'LaTeX-mode-hook #'turn-on-reftex))
  :config
  (add-hook 'LaTeX-mode-hook
            (function
             (lambda ()
               (dolist (command '("pTeX"
                                  "LaTeX"
                                  "pLaTeX"
                                  "pBibTeX"
                                  "jTeX"
                                  "jLaTeX"
                                  "jBibTeX"))
                 (delq (assoc command TeX-command-list) TeX-command-list))
               (setq TeX-command-default "LaTeX"
                     japanese-LaTeX-command-default "LaTeX"
                     TeX-PDF-mode t
                     TeX-command-output-list '(("LaTeX" ("pdf")))
                     )
               (add-to-list 'TeX-expand-list
                            '("%(LATEXENC)"
                              (lambda ()
                                (let ((str (japanese-TeX-get-encoding-string)))
                                  (if str (format "%s" str) "")))))
               (add-to-list 'TeX-command-list
                            '("LaTeX"
                              "LATEXENC=%(LATEXENC) latexmk -gg %t"
                              TeX-run-TeX nil (latex-mode) :help "Run Latexmk")))))
  (setq TeX-source-correlate-method 'synctex
        TeX-source-correlate-start-server t
        TeX-source-correlate-mode t
        TeX-view-program-selection '((output-dvi "xdvi")
                                     (output-pdf "Evince")
                                     (output-html "xdg-open"))
        TeX-auto-save t
        TeX-auto-local  (expand-file-name "auctex/auto" my:d:tmp)
        TeX-style-local (expand-file-name "auctex/style" my:d:tmp)
        TeX-parse-self t
        TeX-auto-untabify t
        font-latex-fontify-script nil
        font-latex-fontify-sectioning 1.0
        font-latex-script-display nil
        reftex-plug-into-AUCTeX t
        )
  )
   #+END_SRC
   =~/.latexmkrc= ã¯ä»¥ä¸‹ã®é€šã‚Š
   #+BEGIN_SRC perl :tangle no
#!/usr/bin/env perl
$kanji  = defined $ENV{"LATEXENC"} ? "-kanji=$ENV{\"LATEXENC\"}" : "-kanjii=utf8" ;
$latex  = "platex -interaction=nonstopmode -src-specials -shell-escape --synctex=1 $kanji";
$latex_silent = "platex -interaction=batchmode -src-specials -shell-escape --synctex=1 $kanji";
$bibtex = "pbibtex $kanji";
$makeindex = "touch -m %D";
$dvipdf = "dvipdfmx %O -o %D %S";
$dvips = 'dvips %O -z -f %S | convbkmk -u > %D';
$ps2pdf = 'ps2pdfwr %O %S %D';
$pdf_mode = 3;
$pdf_previewer = 'start xdg-open';
$pdf_update_method = 0;
$clean_ext = "snm nav vrb synctex.gz";
   #+END_SRC
** Zotero ã¨ã®é€£æº
   ver.5 ä»¥é™, è¿·èµ°ä¸­. ä»¥å‰ã»ã©æ¥½ã˜ã‚ƒãªã„æ°—ãŒ.
   #+BEGIN_SRC emacs-lisp
(use-package emacs-zotero-bib-fetch
  :quelpa (emacs-zotero-bib-fetch
           :fetcher url
           :url "https://gist.githubusercontent.com/andersjohansson/fa7ca643782771b6e15da41514e1358a/raw/25e9f875ef6a34bbdd2c24c34637310596755722/emacs-zotero-bib-fetch.el")
  :config
  (add-hook 'TeX-mode-hook 'ezbf-minor-mode)
  )
   #+END_SRC
* æ—¥è¨˜: =tDiary=
  org2blog ã§ tDiary ã‚’æ›´æ–°ã§ããªã„ã‹å¦„æƒ³ã—ã¦ã„ã‚‹
  #+BEGIN_SRC emacs-lisp
(use-package tdiary-mode
  :if (and (file-directory-p my:d:password-store)
           (file-directory-p (concat (getenv "HOME") "/Nextcloud/tdiary")))
  :no-require t
  :quelpa (tdiary-mode
           :fetcher github
           :repo "uwabami/tdiary-mode")
  :commands (tdiary-new tdiary-replace tdiary-append)
  :config
  (setq tdiary-text-directory (concat (getenv "HOME") "/Nextcloud/tdiary/")
        tdiary-diary-list '(("log" "https://uwabami.junkhub.org/log/"))
        tdiary-style-mode 'org-mode
        tdiary-text-suffix ".org"
        )
  (with-eval-after-load "tdiary-mode"
    (load (expand-file-name "tdiary-mode.gpg" my:d:password-store))
    (tdiary-passwd-file-load))
  )
  #+END_SRC
* ãƒ†ãƒ¼ãƒ, ãƒ•ã‚©ãƒ³ãƒˆ, ãƒ¢ãƒ¼ãƒ‰ãƒ©ã‚¤ãƒ³, ãªã©ãªã©
** ãƒ•ã‚©ãƒ³ãƒˆã¨è‰²
   ãã‚ãã‚ãƒ†ãƒ¼ãƒã«ã—ãŸæ–¹ãŒè‰¯ã„ï¼Œã¨ã¯æ€ã£ã¦ã¯ã„ã‚‹ï¼
   #+begin_src emacs-lisp
(use-package ansi-color
  :config
  (setq ansi-color-names-vector
        [unspecified
         "#242424" "#FF4c4c" "#4cff4c" "#ffff4c"
         "#4c4cff" "#ff4cff" "#4cffff" "#aaaaaa"
         ])
  (add-hook 'shell-mode-hook 'ansi-color-for-comint-mode-on)
  )
(defun my:load-window-config ()
  "load window-system specific settings"
  (interactive)
  (when window-system
    (progn
      (set-frame-parameter nil 'alpha 90)
      (set-face-attribute 'default nil
                          :family "RictyDiscord Nerd Font"
                          :height 180)
      (set-face-attribute 'fixed-pitch nil
                          :family "RictyDiscord Nerd Font"
                          :height 180)
      (set-face-attribute 'variable-pitch nil
                          :family "RictyDiscord Nerd Font"
                          :height 180)
      (set-background-color "#242424")
      )))
(my:load-window-config)
(setq frame-background-mode (frame-parameter nil 'background-mode))
(setq default-frame-alist
      '(
        (foreground-color . "#F6F3E8")
        (scroll-bar-foreground-color . "red")
        (vertical-scroll-bars . right)
        ))
   #+end_src
   ç¾åœ¨ä¿®æ­£ä¸­ï¼
   #+begin_src emacs-lisp
(custom-set-faces
 '(default                             ((t (:foreground "#F6F3E8" ))))
 '(cursor                              ((t (:foreground "#4CFF4C" :background "#4CFF4C" ))))
 ;; basic
 '(font-lock-builtin-face              ((t (:foreground "#7FBFFF" ))))
 '(font-lock-comment-delimiter-face    ((t (:foreground "#a5a5a6" ))))
 '(font-lock-comment-face              ((t (:foreground "#a5a5a6" ))))
 '(font-lock-constant-face             ((t (:foreground "#FFBF7F" ))))
 '(font-lock-doc-face                  ((t (:foreground "#7FFF7F" ))))
 '(font-lock-doc-string-face           ((t (:foreground "#7FFF7F" ))))
 '(font-lock-function-name-face        ((t (:foreground "#BF7FFF"))))
 '(font-lock-keyword-face              ((t (:foreground "#FF7F7F"))))
 '(font-lock-link-face                 ((t (:foreground "#7FFFFF" ))))
 '(font-lock-negation-char-face        ((t (:foreground "#7FFFFF" :bold t   :italic nil))))
 '(font-lock-preprocessor-face         ((t (:foreground "#FF4C4C" :bold nil :italic nil))))
 '(font-lock-regexp-grouping-backslash ((t (:foreground "#A5EE4C" :bold t   :italic nil))))
 '(font-lock-regexp-grouping-construct ((t (:foreground "#7F7FFF" :bold t   :italic nil))))
 '(font-lock-string-face               ((t (:foreground "#7FFF7F" ))))
 '(font-lock-type-face                 ((t (:foreground "#FFFF7F" ))))
 '(font-lock-variable-name-face        ((t (:foreground "#7F7FFF" ))))
 '(font-lock-warning-face              ((t (:foreground "#FF7FBF" :bold t ))))
 '(mode-line                           ((t (:foreground "#F6F3E8" :background "#222244" ))))
 '(mode-line-inactive                  ((t (:foreground "#666666" :background "#999999" :bold nil ))))
 '(fringe                              ((t (:foreground "#666666" :background "#282828" ))))
 ;; '(hl-line                           ((t (:inherit highlight :underline t ))))
 '(highlight                           ((t (:background "#556b2f" ))))
 '(term-color-black                    ((t (:background "#242424" :foreground "#242424"))))
 '(term-color-blue                     ((t (:background "#4c4cff" :foreground "#4c4cff"))))
 '(term-color-cyan                     ((t (:background "#4cffff" :foreground "#4cffff"))))
 '(term-color-green                    ((t (:background "#4cff4c" :foreground "#4cff4c"))))
 '(term-color-magenta                  ((t (:background "#ff4cff" :foreground "#ff4cff"))))
 '(term-color-red                      ((t (:background "#ff4c4c" :foreground "#ff4c4c"))))
 '(term-color-white                    ((t (:background "#f6f3e8" :foreground "#f6f3e8"))))
 '(term-color-yellow                   ((t (:background "#ffff4c" :foreground "#ffff4c"))))
 ;;
 '(minibuffer-prompt                   ((t (:foreground "#BF7FFF" ))))
 '(region                              ((t (:background "#222244" ))))
 ;; dired
 '(dired-directory                     ((t (:bold t :foreground "#7F7FFF" ))))
 '(dired-flagged                       ((t (:inherit error ))))
 ;; '(dired-header
 '(dired-ignored                       ((t (:inherit shadow ))))
 ;; '(dired-mark
 ;; '(dired-marked
 '(dired-perm-write                    ((t (:bold t :foreground "#FFFF7F" ))))
 '(dired-symlink                       ((t (:bold t :foreground "#7FFFFF" ))))
 '(dired-warning                       ((t (:inherit font-lock-warning-face ))))
 ;; helm
 '(helm-source-header                  ((t (:foreground "#F6F3E8" :background "#224488" :bold t))))
 '(helm-visible-mark                   ((t (:inherit highlight ))))
 '(helm-selection                      ((t (:inherit highlight ))))
 '(helm-selection-line                 ((t (:inherit highlight ))))
 '(helm-ff-directory                   ((t (:inherit dired-directory ))))
 '(helm-bookmark-directory             ((t (:inherit helm-ff-directory ))))
 '(helm-buffer-directory               ((t (:inherit helm-ff-directory ))))
 '(helm-ff-dotted-directory            ((t (:inherit helm-ff-directory ))))
 '(helm-ff-file                        ((t (:inherit default ))))
 '(helm-bookmark-file                  ((t (:inherit helm-ff-file ))))
 '(helm-buffer-file                    ((t (:inherit helm-ff-file ))))
 '(helm-grep-file                      ((t (:inherit helm-ff-file ))))
 '(helm-etags-file                     ((t (:inherit helm-ff-file ))))
 '(helm-ff-executable                  ((t (:inherit helm-ff-file :foreground "#7FFF7F" :bold t))))
 '(helm-ff-symlink                     ((t (:inherit default :foreground "#7FFFFF" :bold t))))
 '(helm-ff-dotted-symlink-directory    ((t (:inherit helm-ff-symlink ))))
 '(helm-ff-invalid-symlink             ((t (:inherit default :foreground "#FF7F7F" ))))
 ;; ido
 '(ido-first-match                     ((t (:underline t :weight bold))))
 '(ido-only-match                      ((t (:foreground "#FFFF4C" :overline nil :weight bold))))
 '(ido-subdir                          ((t (:inherit dired-directory))))
 '(ido-vertical-first-match-face       ((t (:inherit ido-first-match))))
 '(ido-vertical-match-face             ((t (:foreground "#4CFF4C"))))
 '(ido-grid-mode-match                 ((t (:inherit ido-first-match ))))
 ;; powerline
 '(powerline-active1                   ((t (:background "#000000":foreground "#F6F3E8"))))
 '(powerline-active2                   ((t (:background "#666666" :foreground "#F6F3E8"))))
 '(powerline-inactive1                 ((t (:inherit mode-line-inactive))))
 '(powerline-inactive2                 ((t (:inherit mode-line-inactive))))
 ;; preview-latex
 '(font-latex-sectioning-0-face        ((t (:inherit font-latex-sectioning-1-face))))
 '(font-latex-sectioning-1-face        ((t (:inherit font-latex-sectioning-2-face))))
 '(font-latex-sectioning-2-face        ((t (:inherit font-latex-sectioning-3-face))))
 '(font-latex-sectioning-3-face        ((t (:inherit font-latex-sectioning-4-face))))
 '(font-latex-sectioning-4-face        ((t (:inherit font-latex-sectioning-5-face ))))
 '(font-latex-sectioning-5-face        ((t (:inherit font-lock-type-face :bold t))))
 '(font-latex-slide-title-face         ((t (:inherit font-lock-type-face :bold t))))
 '(font-latex-subscript-face           ((t nil)))
 '(font-latex-superscript-face         ((t nil)))
 '(font-latex-math-face                ((t (:inherit font-lock-constant-face ))))
 '(font-latex-script-char-face         ((t (:inherit font-lock-preprocessor-face :bold t))))
 '(font-latex-verbatim-face            ((t (:inherit font-lock-doc-string-face ))))
 ;; elscreen
 '(elscreen-tab-control-face           ((t (:background "#222244" :foreground "#f6f3e8" :underline t :bold t ))))
 '(elscreen-tab-current-screen-face    ((t (:background "#222244" :foreground "#f6f3e8" :underline t :bold t ))))
 '(elscreen-tab-other-screen-face      ((t (:background "#222244" :foreground "#aaaaaa" :underline t :bold nil ))))
 '(elscreen-tab-background-face        ((t (:background "#222244" :foreground "#aaaaaa" :underline t :bold nil ))))
 ;; git-gutter
 '(git-gutter:added                    ((t (:inherit default :bold t :foreground "#4CFF4C" :background "#666666"))))
 '(git-gutter:deleted                  ((t (:inherit default :bold t :foreground "#FF7FBF" :background "#666666"))))
 '(git-gutter:modified                 ((t (:inherit default :bold t :foreground "#FFFF4C" :background "#666666"))))
 '(git-gutter:unchanged                ((t (:inherit default :background "#666666" ))))
 '(git-gutter:separator-face           ((t (:inherit default :foreground "#FF4C4C" :background "#666666"))))
  ;;; howm
 '(howm-mode-keyword-face              ((t (:foreground "#7F7FFF" :background nil ))))
 '(howm-mode-title-face                ((t (:foreground "#4CFFFF" :background nil ))))
 '(howm-reminder-deadline-face         ((t (:bold t :foreground "#FF4C4C" :background nil ))))
 '(howm-reminder-late-deadline-face    ((t (:bold t :underline t :foreground "#FF0000" :background nil ))))
 '(howm-reminder-today-face            ((t (:bold t :foreground "#FFBF7F" :background nil ))))
 '(howm-reminder-tomorrow-face         ((t (:bold t :foreground "#FF7FBF" :background nil ))))
 ;; outline
 '(outline-1                           ((t (:inherit font-lock-function-name-face :bold t))))
 '(outline-2                           ((t (:inherit font-lock-string-face :bold t))))
 '(outline-3                           ((t (:inherit font-lock-keyword-face :bold t))))
 '(outline-4                           ((t (:inherit font-lock-type-face :bold t ))))
 '(outline-5                           ((t (:inherit font-lock-constant-face :bold t ))))
 '(outline-6                           ((t (:inherit font-lock-variable-name-face :bold t))))
 '(outline-7                           ((t (:inherit font-lock-builtin-face :bold t ))))
 '(outline-8                           ((t (:inherit font-lock-comment-face :bold t ))))
 ;; org
 '(org-agenda-date-today               ((t (:underline t ))))
 '(org-agenda-date                     ((t (:foreground "#FFFFFF" ))))
 '(org-agenda-date-weekend             ((t (:foreground "#FF7F7F" :bold t))))
 '(org-agenda-calendar-event           ((t (:foreground "#F6F3E8" ))))
 '(org-hide                            ((t (:foreground "#4C4C4C" ))))
 '(org-block                           ((t (:inherit font-lock-comment-face))))
 ;;
 ;; moinmoin
 '(moinmoin-h1                         ((t (:inherit outline-1))))
 '(moinmoin-h2                         ((t (:inherit outline-2))))
 '(moinmoin-h3                         ((t (:inherit outline-3))))
 '(moinmoin-h4                         ((t (:inherit outline-4))))
 '(moinmoin-h5                         ((t (:inherit outline-5))))
 '(moinmoin-url                        ((t (:inherit font-lock-link-face))))
 '(moinmoin-url-title                  ((t (:inherit moinmoin-url :bold t))))
 '(moinmoin-anchor-ref-id              ((t (:inherit moinmoin-url :underline t))))
 '(moinmoin-anchor-ref-title           ((t (:inherit moinmoin-url :bold t))))
 '(moinmoin-wiki-link                  ((t (:inherit moinmoin-url :underline t ))))
 '(moinmoin-inter-wiki-link            ((t (:inherit moinmoin-url :underline t ))))
 '(moinmoin-item                       ((t (:inherit font-lock-doc-face ))))
 '(moinmoin-item-2                     ((t (:inherit font-lock-doc-face ))))
 ;; company-mode
 '(company-tooltip                     ((t (:foreground "#242424" :background "#acacac"))))
 '(company-tooltip-common              ((t (:foreground "#242424" :background "#acacac"))))
 '(company-tooltip-common-selection    ((t (:foreground "#f6f3e8" :background "#4c4cff"))))
 '(company-tooltip-selection           ((t (:foreground "#242424" :background "#4c4cff"))))
 '(company-preview-common              ((t (:background nil :foreground "#acacac" :underline t))))
 '(company-scrollbar-fg                ((t (:background "#FFBF7F"))))
 '(company-scrollbar-bg                ((t (:background "#4c4c4c"))))
 )
;; review
;; '(review-mode-header1-face  ((t (:inherit outline-1))))
;; '(review-mode-header2-face  ((t (:inherit outline-2))))
;; '(review-mode-header3-face  ((t (:inherit outline-3))))
;; '(review-mode-header4-face  ((t (:inherit outline-4))))
;; '(review-mode-header5-face  ((t (:inherit outline-5))))
   #+end_src
** major/minor ãƒ¢ãƒ¼ãƒ‰ã®è¡¨ç¤ºè¨­å®š
   diminish ã‚„ delight ãŒã‚ã‚‹ã‚ã‘ã§ã™ãŒ,
   å¾®å¦™ã«ã“ã‚Œã§æŒ‡å®šã§ããªã„å¥´ã‚‚ã‚ã£ã¦ã‚¢ãƒ¬ã§ã™ã­.
   #+BEGIN_SRC emacs-lisp
(defvar my:mode-line-cleaner-alist
  '( ;; For minor-mode, first char is 'space'
    ;; (yas-minor-mode         . " Ya")
    ;; (eldoc-mode             . "")
    ;; (abbrev-mode            . "")
    ;; (undo-tree-mode         . "")
    ;; (flymake-mode           . "")
    ;; (isearch-mode           . "")
    (global-whitespace-mode  . " â—»ï¸ ")
    ;; (editorconfig-mode      . "")
    ;; (company-mode           . " Co")
    ;; (rainbow-mode           . "")
    ;; (orgmine-mode           . "")
    ;; (orgtbl-mode            . "")
    (org-src-mode           . "")
    ;; (git-gutter+-mode       . "")
    ;; ;; Major modes
    (python-mode            . "ğŸ")
    (ruby-mode              . "ğŸ’")
    ;; (lisp-interaction-mode  . "LiI")
    ;; (emacs-lisp-mode        . "Eli")
    ;; (markdown-mode          . "Mkd")
    (org-mode               . "ğŸ¦„")
    (package-menu-mode      . "ğŸ“¦")
    ))
(defun my:clean-mode-line ()
  "Cleanup major/minor mode."
  (interactive)
  (cl-loop for (mode . mode-str) in my:mode-line-cleaner-alist
           do
           (let ((old-mode-str (cdr (assq mode minor-mode-alist))))
             (when old-mode-str
               (setcar old-mode-str mode-str))
             ;; major mode
             (when (eq mode major-mode)
               (setq mode-name mode-str)))))
(add-hook 'after-change-major-mode-hook 'my:clean-mode-line)
   #+END_SRC
** powerline æœ¬ä½“ã®è¨­å®šï¼
   default-theme ã‚’ãƒ™ãƒ¼ã‚¹ã«è¦‹ãŸã„ç‰©ã ã‘è¡¨ç¤ºã™ã‚‹ã‚ˆã†ã«ã—ã¦ã¿ãŸï¼
   å¤‰æ›´ç‚¹ã¨ã—ã¦,
   - separater ã¯ç’°å¢ƒã«ã‚ˆã£ã¦ã‚ºãƒ¬ã‚‹ã®ã§ï¼ŒåŠè§’ã‚¹ãƒšãƒ¼ã‚¹ã«å¤‰æ›´
   - vc-mode, line number ç­‰ã®ã‚¢ã‚¤ã‚³ãƒ³è¡¨ç¤ºã‚’æ­¢ã‚ã‚‹
   ã¨ã„ã£ãŸäº‹ã‚’ã—ã¦ã„ã‚‹. East Asian ambiguous Width char ã®æ‰±ã„ã¯é¢å€’ã§ã™ã­.
   #+BEGIN_SRC emacs-lisp
;; SKK ã®çŠ¶æ…‹ãŒãƒ’ãƒ§ã‚³ãƒ’ãƒ§ã‚³å‹•ãã®ãŒå«Œãªã®ã§ï¼Œskk-modeline-input-mode= ã«
;; å¸¸ã«ç¾åœ¨ã®çŠ¶æ³ã‚’è¡¨ç¤ºã™ã‚‹æ§˜ã«ã—ã¦ãŠãï¼
(defun my:skk-modeline-input-mode ()
  "skk ãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ãªã„å ´åˆã§ã‚‚ skk-modeline-input-mode ã«æ–‡å­—ã‚’å…¥ã‚Œã¦è¿”ã™"
  (unless (boundp 'skk-modeline-inpt-mode)
    (setq skk-modeline-input-mode "--[--]:")))
(my:skk-modeline-input-mode)
(add-hook 'after-change-major-mode-hook
          #'(lambda() (skk-mode)(skk-mode)))
;; ä¸€å›å‘¼ã‚“ã§ãŠã?
;; (my:skk-modeline-input-mode)
;; æœ¬ä½“ã®è¨­å®š
(use-package powerline
  :ensure t
  :disabled t
  :init
  ;; ddskk ãã®ã‚‚ã®ã« modeline ã‚’æ›´æ–°ã™ã‚‹é–¢æ•°ãŒã‚ã‚‹ã®ã§ç„¡åŠ¹åŒ–ã™ã‚‹
  (defadvice skk-setup-modeline (around my:disable-skk-setup-modeline activate)
    "skk-setup-modeline ã«ã‚ˆã‚‹ modeline ã®æ›´æ–°ã‚’ç„¡åŠ¹åŒ–"
    (setq skk-indicator-alist (skk-make-indicator-alist))
    (force-mode-line-update t))
  ;; ;; Git è¡¨ç¤º ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º
  ;; (eval-when-compile (require 'subr-x))
  ;; (defun my:in-git-p ()
  ;;   "Check: ä»Šã®ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒ Git ã®ãƒªãƒã‚¸ãƒˆãƒªã‹ã©ã†ã‹ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹. "
  ;;   (not (string-match "^fatal" (shell-command-to-string "git rev-parse --git-dir"))))
  ;; ;;
  ;; (defun my:git-parse-status ()
  ;;   "Parse: git status ã‚’æ•´å½¢ "
  ;;   (interactive)
  ;;   (let ((U 0)   ; untracked files
  ;;         (M 0)   ; modified files
  ;;         (O 0)   ; other files
  ;;         (U-files "")
  ;;         (M-files "")
  ;;         (O-files ""))
  ;;     (dolist (line (split-string
  ;;                    (shell-command-to-string "git status --porcelain")
  ;;                    "\n"))
  ;;       (cond
  ;;        ;; ignore empty line at end
  ;;        ((string= "" line) nil)
  ;;        ((string-match "^\\?\\?" line)
  ;;         (setq U (+ 1 U))
  ;;         (setq U-files (concat U-files "\n" line)))
  ;;        ((string-match "^ M" line)
  ;;         (setq M (+ 1 M))
  ;;         (setq M-files (concat M-files "\n" line)))
  ;;        (t
  ;;         (message "detected other in %s" line)
  ;;         (setq O (+ 1 O))
  ;;         (setq O-files (concat O-files "\n" line)))))
  ;;     ;; construct propertized string
  ;;     (concat
  ;;      ;;     "["
  ;;      (propertize
  ;;       (format "M:%d" M)
  ;;       'face (list ':foreground (if (> M 0)
  ;;                                    "#FF4C4C"
  ;;                                  "#4CFF4C"))
  ;;       'help-echo M-files)
  ;;      "|"
  ;;      (propertize
  ;;       (format "U:%d" U)
  ;;       'face (list ':foreground (if (> U 0) "#FF4C4C" "#4CFF4C"))
  ;;       'help-echo U-files)
  ;;      "|"
  ;;      (propertize
  ;;       (format "O:%d" O)
  ;;       'face (list ':foreground (if (> O 0) "$FF4C4C" "#4CFF4C"))
  ;;       'help-echo O-files)
  ;;      "> ")))
  ;;
  ;; (defun my:git-remote-status ()
  ;;   "Parse: remote status ã‚‚å«ã‚ã¦ status ã‚’æ•´å½¢. "
  ;;   (interactive)
  ;;   (let* (;; get the branch we are on.
  ;;          (branch (string-trim
  ;;                   (shell-command-to-string "git rev-parse --abbrev-ref HEAD")))
  ;;          (branch-show (if (string-match "fatal:" branch) "Init" branch))
  ;;          ;; get the remote the branch points to.
  ;;          (remote (string-trim
  ;;                   (shell-command-to-string
  ;;                    (format "git config branch.%s.remote" branch))))
  ;;          (remote-branch (string-trim
  ;;                          (shell-command-to-string
  ;;                           "git for-each-ref --format='%(upstream:short)' $(git symbolic-ref -q HEAD)")))
  ;;          (commits (split-string
  ;;                    (string-trim
  ;;                     (shell-command-to-string
  ;;                      (format
  ;;                       "git rev-list --count --left-right HEAD...%s"
  ;;                       remote-branch)))))
  ;;          (local (nth 0 commits))
  ;;          (local-show (if (string-equal local "fatal:") "-" local))
  ;;          (remotes (nth 1 commits))
  ;;          (remotes-show (if (string-equal remotes "ambiguous") "-" remotes))
  ;;          )
  ;;     (concat
  ;;      " <"
  ;;      (propertize
  ;;       (format "%s" branch-show)
  ;;       'face (list :foreground "#FFBF7F"))
  ;;      "|"
  ;;      (format "â†‘%s|â†“%s" local-show remotes-show)
  ;;      "|")))
  ;; delight ã¨ã®é€£æº
  ;; @see https://www.emacswiki.org/emacs/DelightedPowerLine
  (defadvice powerline-major-mode (around delight-powerline-major-mode activate)
    "Ensure that powerline's major mode names are delighted."
    (let ((inhibit-mode-name-delight nil))
      ad-do-it))
  ;; Git ã®è¡¨ç¤ºã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º
  (defpowerline my:powerline-vc
    (when (and (buffer-file-name (current-buffer)) vc-mode)
      (format "%s"
              (format-mode-line '(vc-mode vc-mode)) "")))
  ;; theme ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º
  (defun my:powerline-theme ()
    "Custom theme for personal use."
    (interactive)
    (setq-default mode-line-format
                  '("%e"
                    (:eval
                     (let* ((active (powerline-selected-window-active))
                            ;; (mode-line-buffer-id (if active 'mode-line-buffer-id 'mode-line-buffer-id-inactive))
                            (mode-line (if active 'mode-line 'mode-line-inactive))
                            (face1 (if active 'powerline-active1 'powerline-inactive1))
                            (face2 (if active 'powerline-active2 'powerline-inactive2))
                            (separator-left (intern (format "powerline-%s-%s"
                                                            (powerline-current-separator)
                                                            (car powerline-default-separator-dir))))
                            (separator-right (intern (format "powerline-%s-%s"
                                                             (powerline-current-separator)
                                                             (cdr powerline-default-separator-dir))))
                            (lhs (list (powerline-raw (substring skk-modeline-input-mode 2 -1) mode-line 'l)
                                       (powerline-raw "%*" mode-line 'l)
                                       (powerline-raw mode-line-mule-info mode-line 'l)
                                       (powerline-raw " ")
                                       (powerline-major-mode)
                                       (powerline-raw " ")
                                       (funcall separator-left mode-line face1)
                                       ;; (powerline-buffer-id mode-line-buffer-id 'l)
                                       (powerline-buffer-id face1 'r)
                                       (powerline-raw " " face1)
                                       (funcall separator-left face1 face2)
                                       (powerline-process face2)
                                       (powerline-minor-modes face2 'l)
                                       (powerline-narrow face2 'l)
                                       ))
                            (rhs (list (powerline-raw global-mode-string face2 'r)
                                       (funcall separator-right face2 face1)
                                       ;; (powerline-raw "%4l" face1 'l)
                                       ;; (powerline-raw ":" face1 'l)
                                       ;; (powerline-raw "%3c" face1 'r)
                                       (powerline-raw " " face1)
                                       (my:powerline-vc face1 'r)
                                       (funcall separator-right face1 mode-line)
                                       (powerline-raw " ")
                                       (powerline-raw "%6p" mode-line 'l)
                                       (powerline-raw "/")
                                       (powerline-buffer-size mode-line 'l)
                                       (powerline-raw " ")
                                       )))
                       (concat (powerline-render lhs)
                               (powerline-fill face2 (powerline-width rhs))
                               (powerline-render rhs)))))))
  :config
  ;; åŠè§’ã‚¹ãƒšãƒ¼ã‚¹
  (setq powerline-default-separator 'utf-8     ;; UTF-8
        powerline-utf-8-separator-left  #x20   ;; åŠè§’ã‚¹ãƒšãƒ¼ã‚¹
        powerline-utf-8-separator-right  #x20  ;; åŠè§’ã‚¹ãƒšãƒ¼ã‚¹
        powerline-display-buffer-size nil
        powerline-display-mule-info t
        powerline-display-hud t
        )
  (my:skk-modeline-input-mode)
  (my:powerline-theme)
  )
   #+END_SRC
** å¯¾å¿œã™ã‚‹æ‹¬å¼§ã‚’è¦‹æ˜“ã: =rainbow-delimiters=
   #+BEGIN_SRC emacs-lisp
(use-package rainbow-delimiters
  :ensure t
  :config
  (add-hook 'emacs-lisp-mode-hook #'rainbow-delimiters-mode))
   #+END_SRC
** ã‚«ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ã«è‰²ä»˜ã‘: =rainbow-mode=
   =#RRGGBB= ã®ã‚«ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ã«å‹æ‰‹ã«è‰²ãŒä»˜ãï¼CSS ã®ç·¨é›†ä¸­ãªã‚“ã‹ã§åœ°å‘³ã«ä¾¿åˆ©ï¼
   #+BEGIN_SRC emacs-lisp
(use-package rainbow-mode
  :ensure t
  )
   #+END_SRC
* èµ·å‹•æ™‚é–“ã®å‡ºåŠ›
  [[http://memo.sugyan.com/entry/20120120/1327037494][èµ·å‹•æ™‚é–“ã‚’è¨ˆæ¸¬ã™ã‚‹ æ”¹è¨‚ç‰ˆ - ã™ãã‚ƒãƒ¼ã‚“ãƒ¡ãƒ¢]]
  #+BEGIN_SRC emacs-lisp
(add-hook 'emacs-startup-hook
          (lambda ()
            (message "init time: %.3f sec"
                     (float-time (time-subtract after-init-time before-init-time)))))
  #+END_SRC
* LICENSE
  å¹¾ã¤ã‹ã®é–¢æ•°ã®å…ƒãƒã‚¿ã¨ã—ã¦ Emacs æœ¬ä½“ã®ã‚³ãƒ¼ãƒ‰ã‚’å‚ç…§ã—ãŸã®ã§ï¼ŒGPL-3 or later ã§ã™ï¼
  #+begin_example
Copyright (C) 2011--2017 Youhei SASAKI <uwabami@gfd-dennou.org>
.
This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.
.
This package is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.
.
You should have received a copy of the GNU General Public License
along with this program. If not, see <https://www.gnu.org/licenses/>.
  #+end_example
